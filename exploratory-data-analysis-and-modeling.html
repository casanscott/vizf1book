<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Exploratory Data Analysis and Modeling | Visualizing Formula 1 Data in R</title>
  <meta name="description" content="This is a book documenting data visualizations of Formula 1 data." />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Exploratory Data Analysis and Modeling | Visualizing Formula 1 Data in R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/book_cover_draft.png" />
  <meta property="og:description" content="This is a book documenting data visualizations of Formula 1 data." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Exploratory Data Analysis and Modeling | Visualizing Formula 1 Data in R" />
  
  <meta name="twitter:description" content="This is a book documenting data visualizations of Formula 1 data." />
  <meta name="twitter:image" content="/book_cover_draft.png" />

<meta name="author" content="Casan Scott, Ph.D." />


<meta name="date" content="2024-01-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="drivers.html"/>
<link rel="next" href="dnf-did-not-finish.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">An Introduction to Data Visualization using Formula 1 Data</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About the book</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#about-me"><i class="fa fa-check"></i><b>1.1</b> About me</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#why-did-i-write-this-book"><i class="fa fa-check"></i><b>1.2</b> Why did I write this book?</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#organization-of-this-book"><i class="fa fa-check"></i><b>1.3</b> Organization of this book</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#ggplot2"><i class="fa fa-check"></i><b>1.4</b> ggplot2</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#the-tidyverse"><i class="fa fa-check"></i><b>1.5</b> The <em>tidyverse</em></a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#data"><i class="fa fa-check"></i><b>1.6</b> Data</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#data-visualization"><i class="fa fa-check"></i><b>1.7</b> Data Visualization</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-formula-1.html"><a href="introduction-to-formula-1.html"><i class="fa fa-check"></i><b>2</b> Introduction to Formula 1</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-formula-1.html"><a href="introduction-to-formula-1.html#a-formula-1-weekend"><i class="fa fa-check"></i><b>2.1</b> A Formula 1 Weekend</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-formula-1.html"><a href="introduction-to-formula-1.html#practice-sessions"><i class="fa fa-check"></i><b>2.2</b> Practice Sessions</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-formula-1.html"><a href="introduction-to-formula-1.html#practice-times-by-driver"><i class="fa fa-check"></i><b>2.3</b> Practice Times by Driver</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="qualifying.html"><a href="qualifying.html"><i class="fa fa-check"></i><b>3</b> Qualifying</a>
<ul>
<li class="chapter" data-level="3.1" data-path="qualifying.html"><a href="qualifying.html#distribution-of-qualifying-times-by-grand-prix"><i class="fa fa-check"></i><b>3.1</b> Distribution of Qualifying Times by Grand Prix</a></li>
<li class="chapter" data-level="3.2" data-path="qualifying.html"><a href="qualifying.html#how-does-car-development-progress-over-time"><i class="fa fa-check"></i><b>3.2</b> How does car development progress over time?</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="modeling-practice-and-qualifying-times.html"><a href="modeling-practice-and-qualifying-times.html"><i class="fa fa-check"></i><b>4</b> Modeling Practice and Qualifying Times</a>
<ul>
<li class="chapter" data-level="4.1" data-path="modeling-practice-and-qualifying-times.html"><a href="modeling-practice-and-qualifying-times.html#models"><i class="fa fa-check"></i><b>4.1</b> Models</a></li>
<li class="chapter" data-level="4.2" data-path="modeling-practice-and-qualifying-times.html"><a href="modeling-practice-and-qualifying-times.html#simple-linear-regression-model-practice-vs-qualifying-times"><i class="fa fa-check"></i><b>4.2</b> Simple Linear Regression Model: Practice vs Qualifying Times</a></li>
<li class="chapter" data-level="4.3" data-path="modeling-practice-and-qualifying-times.html"><a href="modeling-practice-and-qualifying-times.html#simple-linear-regression-model-qualifying-time-vs-year"><i class="fa fa-check"></i><b>4.3</b> Simple Linear Regression Model: Qualifying time vs Year</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="modeling-practice-and-qualifying-times.html"><a href="modeling-practice-and-qualifying-times.html#uncertainty-in-model-estimates"><i class="fa fa-check"></i><b>4.3.1</b> Uncertainty in model estimates</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="modeling-practice-and-qualifying-times.html"><a href="modeling-practice-and-qualifying-times.html#interaction-model"><i class="fa fa-check"></i><b>4.4</b> Interaction Model</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="drivers.html"><a href="drivers.html"><i class="fa fa-check"></i><b>5</b> Drivers</a>
<ul>
<li class="chapter" data-level="5.1" data-path="drivers.html"><a href="drivers.html#race-performance"><i class="fa fa-check"></i><b>5.1</b> Race Performance</a></li>
<li class="chapter" data-level="5.2" data-path="drivers.html"><a href="drivers.html#qualifying-1"><i class="fa fa-check"></i><b>5.2</b> Qualifying</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="drivers.html"><a href="drivers.html#section"><i class="fa fa-check"></i><b>5.2.1</b> 2023</a></li>
<li class="chapter" data-level="5.2.2" data-path="drivers.html"><a href="drivers.html#section-1"><i class="fa fa-check"></i><b>5.2.2</b> 2022</a></li>
<li class="chapter" data-level="5.2.3" data-path="drivers.html"><a href="drivers.html#section-2"><i class="fa fa-check"></i><b>5.2.3</b> 2021</a></li>
<li class="chapter" data-level="5.2.4" data-path="drivers.html"><a href="drivers.html#section-3"><i class="fa fa-check"></i><b>5.2.4</b> 2020</a></li>
<li class="chapter" data-level="5.2.5" data-path="drivers.html"><a href="drivers.html#section-4"><i class="fa fa-check"></i><b>5.2.5</b> 2019</a></li>
<li class="chapter" data-level="5.2.6" data-path="drivers.html"><a href="drivers.html#section-5"><i class="fa fa-check"></i><b>5.2.6</b> 2018</a></li>
<li class="chapter" data-level="5.2.7" data-path="drivers.html"><a href="drivers.html#section-6"><i class="fa fa-check"></i><b>5.2.7</b> 2017</a></li>
<li class="chapter" data-level="5.2.8" data-path="drivers.html"><a href="drivers.html#section-7"><i class="fa fa-check"></i><b>5.2.8</b> 2016</a></li>
<li class="chapter" data-level="5.2.9" data-path="drivers.html"><a href="drivers.html#section-8"><i class="fa fa-check"></i><b>5.2.9</b> 2015</a></li>
<li class="chapter" data-level="5.2.10" data-path="drivers.html"><a href="drivers.html#section-9"><i class="fa fa-check"></i><b>5.2.10</b> 2014</a></li>
<li class="chapter" data-level="5.2.11" data-path="drivers.html"><a href="drivers.html#next-chapter"><i class="fa fa-check"></i><b>5.2.11</b> Next Chapter</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="exploratory-data-analysis-and-modeling.html"><a href="exploratory-data-analysis-and-modeling.html"><i class="fa fa-check"></i><b>6</b> Exploratory Data Analysis and Modeling</a>
<ul>
<li class="chapter" data-level="6.1" data-path="exploratory-data-analysis-and-modeling.html"><a href="exploratory-data-analysis-and-modeling.html#plot-overall-trend-starting-position-vs-finish-position"><i class="fa fa-check"></i><b>6.1</b> Plot overall trend: Starting Position vs Finish Position</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="exploratory-data-analysis-and-modeling.html"><a href="exploratory-data-analysis-and-modeling.html#overall-model"><i class="fa fa-check"></i><b>6.1.1</b> Overall model</a></li>
<li class="chapter" data-level="6.1.2" data-path="exploratory-data-analysis-and-modeling.html"><a href="exploratory-data-analysis-and-modeling.html#what-is-the-probability-of-finishing-on-the-podium"><i class="fa fa-check"></i><b>6.1.2</b> What is the probability of finishing on the podium?</a></li>
<li class="chapter" data-level="6.1.3" data-path="exploratory-data-analysis-and-modeling.html"><a href="exploratory-data-analysis-and-modeling.html#yearly-differences"><i class="fa fa-check"></i><b>6.1.3</b> Yearly Differences</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="exploratory-data-analysis-and-modeling.html"><a href="exploratory-data-analysis-and-modeling.html#explore-circuit-specific-models"><i class="fa fa-check"></i><b>6.2</b> Explore Circuit Specific Models</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="exploratory-data-analysis-and-modeling.html"><a href="exploratory-data-analysis-and-modeling.html#bahrain"><i class="fa fa-check"></i><b>6.2.1</b> Bahrain</a></li>
<li class="chapter" data-level="6.2.2" data-path="exploratory-data-analysis-and-modeling.html"><a href="exploratory-data-analysis-and-modeling.html#saudi-arabia"><i class="fa fa-check"></i><b>6.2.2</b> Saudi Arabia</a></li>
<li class="chapter" data-level="6.2.3" data-path="exploratory-data-analysis-and-modeling.html"><a href="exploratory-data-analysis-and-modeling.html#monaco"><i class="fa fa-check"></i><b>6.2.3</b> Monaco</a></li>
<li class="chapter" data-level="6.2.4" data-path="exploratory-data-analysis-and-modeling.html"><a href="exploratory-data-analysis-and-modeling.html#brazil"><i class="fa fa-check"></i><b>6.2.4</b> Brazil</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="dnf-did-not-finish.html"><a href="dnf-did-not-finish.html"><i class="fa fa-check"></i><b>7</b> DNF (Did Not Finish)</a></li>
<li class="chapter" data-level="8" data-path="the-wcc-world-constructor-championship-and-wdc-world-drivers-championship.html"><a href="the-wcc-world-constructor-championship-and-wdc-world-drivers-championship.html"><i class="fa fa-check"></i><b>8</b> The WCC (World Constructor Championship) and WDC (World Drivers Championship)</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Visualizing Formula 1 Data in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exploratory-data-analysis-and-modeling" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Exploratory Data Analysis and Modeling<a href="exploratory-data-analysis-and-modeling.html#exploratory-data-analysis-and-modeling" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>What determines success in a Grand Prix? Obviously, a multitude of factors do, but which ones specifically, and how much? That’s what I am aiming to answer with this book.</p>
<p>Let’s begin with a mostly uncontroversial statement: All other factors held constant, it is best to start the race in first place! How much does starting position influence a driver’s finishing place? We can explore the data and build a model to answer this.</p>
<div id="plot-overall-trend-starting-position-vs-finish-position" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Plot overall trend: Starting Position vs Finish Position<a href="exploratory-data-analysis-and-modeling.html#plot-overall-trend-starting-position-vs-finish-position" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Our dataset contains starting grid position and finishing place for each race from 2016 to 2022. Below, I’ll plot starting grid position vs finishing position for each driver over this seven year period. I’ll include a best-fit line to highlight the overall relationship.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="exploratory-data-analysis-and-modeling.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pull Race Data</span></span>
<span id="cb118-2"><a href="exploratory-data-analysis-and-modeling.html#cb118-2" aria-hidden="true" tabindex="-1"></a>races2023 <span class="ot">&lt;-</span> <span class="fu">race_result_scraper</span>(<span class="dv">2023</span>)</span>
<span id="cb118-3"><a href="exploratory-data-analysis-and-modeling.html#cb118-3" aria-hidden="true" tabindex="-1"></a>races2022 <span class="ot">&lt;-</span> <span class="fu">race_result_scraper</span>(<span class="dv">2022</span>)</span>
<span id="cb118-4"><a href="exploratory-data-analysis-and-modeling.html#cb118-4" aria-hidden="true" tabindex="-1"></a>races2021 <span class="ot">&lt;-</span> <span class="fu">race_result_scraper</span>(<span class="dv">2021</span>)</span>
<span id="cb118-5"><a href="exploratory-data-analysis-and-modeling.html#cb118-5" aria-hidden="true" tabindex="-1"></a>races2020 <span class="ot">&lt;-</span> <span class="fu">race_result_scraper</span>(<span class="dv">2020</span>)</span>
<span id="cb118-6"><a href="exploratory-data-analysis-and-modeling.html#cb118-6" aria-hidden="true" tabindex="-1"></a>races2019 <span class="ot">&lt;-</span> <span class="fu">race_result_scraper</span>(<span class="dv">2019</span>)</span>
<span id="cb118-7"><a href="exploratory-data-analysis-and-modeling.html#cb118-7" aria-hidden="true" tabindex="-1"></a>races2018 <span class="ot">&lt;-</span> <span class="fu">race_result_scraper</span>(<span class="dv">2018</span>)</span>
<span id="cb118-8"><a href="exploratory-data-analysis-and-modeling.html#cb118-8" aria-hidden="true" tabindex="-1"></a>races2017 <span class="ot">&lt;-</span> <span class="fu">race_result_scraper</span>(<span class="dv">2017</span>)</span>
<span id="cb118-9"><a href="exploratory-data-analysis-and-modeling.html#cb118-9" aria-hidden="true" tabindex="-1"></a>races2016 <span class="ot">&lt;-</span> <span class="fu">race_result_scraper</span>(<span class="dv">2016</span>)</span>
<span id="cb118-10"><a href="exploratory-data-analysis-and-modeling.html#cb118-10" aria-hidden="true" tabindex="-1"></a>races2015 <span class="ot">&lt;-</span> <span class="fu">race_result_scraper</span>(<span class="dv">2015</span>)</span>
<span id="cb118-11"><a href="exploratory-data-analysis-and-modeling.html#cb118-11" aria-hidden="true" tabindex="-1"></a>races2014 <span class="ot">&lt;-</span> <span class="fu">race_result_scraper</span>(<span class="dv">2014</span>)</span>
<span id="cb118-12"><a href="exploratory-data-analysis-and-modeling.html#cb118-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-13"><a href="exploratory-data-analysis-and-modeling.html#cb118-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all race data</span></span>
<span id="cb118-14"><a href="exploratory-data-analysis-and-modeling.html#cb118-14" aria-hidden="true" tabindex="-1"></a>races_allyears <span class="ot">&lt;-</span> <span class="fu">rbind</span>(races2023,</span>
<span id="cb118-15"><a href="exploratory-data-analysis-and-modeling.html#cb118-15" aria-hidden="true" tabindex="-1"></a>                             races2022,</span>
<span id="cb118-16"><a href="exploratory-data-analysis-and-modeling.html#cb118-16" aria-hidden="true" tabindex="-1"></a>                             races2021, </span>
<span id="cb118-17"><a href="exploratory-data-analysis-and-modeling.html#cb118-17" aria-hidden="true" tabindex="-1"></a>                             races2020,</span>
<span id="cb118-18"><a href="exploratory-data-analysis-and-modeling.html#cb118-18" aria-hidden="true" tabindex="-1"></a>                             races2019,</span>
<span id="cb118-19"><a href="exploratory-data-analysis-and-modeling.html#cb118-19" aria-hidden="true" tabindex="-1"></a>                             races2018,</span>
<span id="cb118-20"><a href="exploratory-data-analysis-and-modeling.html#cb118-20" aria-hidden="true" tabindex="-1"></a>                             races2017,</span>
<span id="cb118-21"><a href="exploratory-data-analysis-and-modeling.html#cb118-21" aria-hidden="true" tabindex="-1"></a>                             races2016,</span>
<span id="cb118-22"><a href="exploratory-data-analysis-and-modeling.html#cb118-22" aria-hidden="true" tabindex="-1"></a>                             races2015,</span>
<span id="cb118-23"><a href="exploratory-data-analysis-and-modeling.html#cb118-23" aria-hidden="true" tabindex="-1"></a>                             races2014)</span>
<span id="cb118-24"><a href="exploratory-data-analysis-and-modeling.html#cb118-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-25"><a href="exploratory-data-analysis-and-modeling.html#cb118-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Pull Starting Grid Data</span></span>
<span id="cb118-26"><a href="exploratory-data-analysis-and-modeling.html#cb118-26" aria-hidden="true" tabindex="-1"></a>grid2023 <span class="ot">&lt;-</span> <span class="fu">starting_grid_scraper</span>(<span class="dv">2023</span>)</span>
<span id="cb118-27"><a href="exploratory-data-analysis-and-modeling.html#cb118-27" aria-hidden="true" tabindex="-1"></a>grid2022 <span class="ot">&lt;-</span> <span class="fu">starting_grid_scraper</span>(<span class="dv">2022</span>)</span>
<span id="cb118-28"><a href="exploratory-data-analysis-and-modeling.html#cb118-28" aria-hidden="true" tabindex="-1"></a>grid2021 <span class="ot">&lt;-</span> <span class="fu">starting_grid_scraper</span>(<span class="dv">2021</span>)</span>
<span id="cb118-29"><a href="exploratory-data-analysis-and-modeling.html#cb118-29" aria-hidden="true" tabindex="-1"></a>grid2020 <span class="ot">&lt;-</span> <span class="fu">starting_grid_scraper</span>(<span class="dv">2020</span>)</span>
<span id="cb118-30"><a href="exploratory-data-analysis-and-modeling.html#cb118-30" aria-hidden="true" tabindex="-1"></a>grid2019 <span class="ot">&lt;-</span> <span class="fu">starting_grid_scraper</span>(<span class="dv">2019</span>)</span>
<span id="cb118-31"><a href="exploratory-data-analysis-and-modeling.html#cb118-31" aria-hidden="true" tabindex="-1"></a>grid2018 <span class="ot">&lt;-</span> <span class="fu">starting_grid_scraper</span>(<span class="dv">2018</span>)</span>
<span id="cb118-32"><a href="exploratory-data-analysis-and-modeling.html#cb118-32" aria-hidden="true" tabindex="-1"></a>grid2017 <span class="ot">&lt;-</span> <span class="fu">starting_grid_scraper</span>(<span class="dv">2017</span>)</span>
<span id="cb118-33"><a href="exploratory-data-analysis-and-modeling.html#cb118-33" aria-hidden="true" tabindex="-1"></a>grid2016 <span class="ot">&lt;-</span> <span class="fu">starting_grid_scraper</span>(<span class="dv">2016</span>)</span>
<span id="cb118-34"><a href="exploratory-data-analysis-and-modeling.html#cb118-34" aria-hidden="true" tabindex="-1"></a>grid2015 <span class="ot">&lt;-</span> <span class="fu">starting_grid_scraper</span>(<span class="dv">2015</span>)</span>
<span id="cb118-35"><a href="exploratory-data-analysis-and-modeling.html#cb118-35" aria-hidden="true" tabindex="-1"></a>grid2014 <span class="ot">&lt;-</span> <span class="fu">starting_grid_scraper</span>(<span class="dv">2014</span>)</span>
<span id="cb118-36"><a href="exploratory-data-analysis-and-modeling.html#cb118-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-37"><a href="exploratory-data-analysis-and-modeling.html#cb118-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all starting grid data</span></span>
<span id="cb118-38"><a href="exploratory-data-analysis-and-modeling.html#cb118-38" aria-hidden="true" tabindex="-1"></a>grid_allyears <span class="ot">&lt;-</span> <span class="fu">rbind</span>(grid2023,</span>
<span id="cb118-39"><a href="exploratory-data-analysis-and-modeling.html#cb118-39" aria-hidden="true" tabindex="-1"></a>                             grid2022,</span>
<span id="cb118-40"><a href="exploratory-data-analysis-and-modeling.html#cb118-40" aria-hidden="true" tabindex="-1"></a>                             grid2021, </span>
<span id="cb118-41"><a href="exploratory-data-analysis-and-modeling.html#cb118-41" aria-hidden="true" tabindex="-1"></a>                             grid2020,</span>
<span id="cb118-42"><a href="exploratory-data-analysis-and-modeling.html#cb118-42" aria-hidden="true" tabindex="-1"></a>                             grid2019,</span>
<span id="cb118-43"><a href="exploratory-data-analysis-and-modeling.html#cb118-43" aria-hidden="true" tabindex="-1"></a>                             grid2018,</span>
<span id="cb118-44"><a href="exploratory-data-analysis-and-modeling.html#cb118-44" aria-hidden="true" tabindex="-1"></a>                             grid2017,</span>
<span id="cb118-45"><a href="exploratory-data-analysis-and-modeling.html#cb118-45" aria-hidden="true" tabindex="-1"></a>                             grid2016,</span>
<span id="cb118-46"><a href="exploratory-data-analysis-and-modeling.html#cb118-46" aria-hidden="true" tabindex="-1"></a>                             grid2015,</span>
<span id="cb118-47"><a href="exploratory-data-analysis-and-modeling.html#cb118-47" aria-hidden="true" tabindex="-1"></a>                             grid2014)</span></code></pre></div>
<p>Here, I’ll merge the grid positions with the race results for all Grands Prix from 2014 to 2023.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="exploratory-data-analysis-and-modeling.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Merge practice and qualifying data</span></span>
<span id="cb119-2"><a href="exploratory-data-analysis-and-modeling.html#cb119-2" aria-hidden="true" tabindex="-1"></a>grids_and_races <span class="ot">&lt;-</span> races_allyears <span class="sc">%&gt;%</span></span>
<span id="cb119-3"><a href="exploratory-data-analysis-and-modeling.html#cb119-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(grid_allyears <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(Driver, Race, Circuit, Year, Position, Time_secs),</span>
<span id="cb119-4"><a href="exploratory-data-analysis-and-modeling.html#cb119-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&#39;Driver&#39;</span>, <span class="st">&#39;Race&#39;</span>, <span class="st">&#39;Circuit&#39;</span>, <span class="st">&#39;Year&#39;</span>),</span>
<span id="cb119-5"><a href="exploratory-data-analysis-and-modeling.html#cb119-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">&quot;_race&quot;</span>, <span class="st">&quot;_grid&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb119-6"><a href="exploratory-data-analysis-and-modeling.html#cb119-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Position_race <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;NC&quot;</span>, <span class="st">&quot;DQ&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb119-7"><a href="exploratory-data-analysis-and-modeling.html#cb119-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Position_race =</span> <span class="fu">as.numeric</span>(Position_race), </span>
<span id="cb119-8"><a href="exploratory-data-analysis-and-modeling.html#cb119-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">Position_grid =</span> <span class="fu">as.numeric</span>(Position_grid)) </span></code></pre></div>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="exploratory-data-analysis-and-modeling.html#cb120-1" aria-hidden="true" tabindex="-1"></a>grids_and_races <span class="sc">%&gt;%</span></span>
<span id="cb120-2"><a href="exploratory-data-analysis-and-modeling.html#cb120-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Position_grid, Position_race)) <span class="sc">+</span></span>
<span id="cb120-3"><a href="exploratory-data-analysis-and-modeling.html#cb120-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(), <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb120-4"><a href="exploratory-data-analysis-and-modeling.html#cb120-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">stat =</span> <span class="st">&#39;smooth&#39;</span>, <span class="at">se =</span> F, <span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>,</span>
<span id="cb120-5"><a href="exploratory-data-analysis-and-modeling.html#cb120-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">formula =</span> y <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> x, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb120-6"><a href="exploratory-data-analysis-and-modeling.html#cb120-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb120-7"><a href="exploratory-data-analysis-and-modeling.html#cb120-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x  =</span> <span class="st">&#39;Starting Grid Position&#39;</span>,</span>
<span id="cb120-8"><a href="exploratory-data-analysis-and-modeling.html#cb120-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Finishing Position&#39;</span>,</span>
<span id="cb120-9"><a href="exploratory-data-analysis-and-modeling.html#cb120-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Starting Position vs Finish Position&#39;</span>,</span>
<span id="cb120-10"><a href="exploratory-data-analysis-and-modeling.html#cb120-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;All Grands Prix: (2016 - 2022)&#39;</span>) <span class="sc">+</span></span>
<span id="cb120-11"><a href="exploratory-data-analysis-and-modeling.html#cb120-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb120-12"><a href="exploratory-data-analysis-and-modeling.html#cb120-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-134-1.png" width="672" /></p>
<div id="overall-model" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Overall model<a href="exploratory-data-analysis-and-modeling.html#overall-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There is certainly a pattern in the data; starting and finishing positions are positively correlated. How much does starting position influence the finishing position of a driver? We need to be as explicit as possible in this research question, because that will guide our model choice and ultimate interpretation of the results. I’ll give it my best shot to clearly state my research question below:</p>
<p><em>What effect does starting grid position have on the probability of a finishing position in a Grand Prix?</em></p>
<p>What model allows us to answer this question? Because the response variable is ordered (1st place, 2nd place, etc.), a proportional odds model, or ordinal regression model, is an obvious choice.</p>
<div class="blackbox">
<div class="center">
<p><strong>What is an Ordinal Regression model?</strong></p>
</div>
<p>An Ordinal Regression model uses a response variable that is an ordered factor. For example, “Low/Medium/High” or “Bad/Good/Great” are both ordered factors with three levels. Finishing Place, “P1, P2, P3, etc.”, is also an ordered factor. If we are interested in understanding the probability of a driver finishing in a given position, an Ordinal Regression is an ideal model choice.</p>
</div>
<p><br />
<br /></p>
<p>Below, I’ll build an ordinal regression modeol, or a <em>proportional odds model</em>, to estimate the effect of starting grid position on the odds of a particular finishing position. This model will utilize all races across the seven year period (2016 to 2022).</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="exploratory-data-analysis-and-modeling.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VGAM)</span>
<span id="cb121-2"><a href="exploratory-data-analysis-and-modeling.html#cb121-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-3"><a href="exploratory-data-analysis-and-modeling.html#cb121-3" aria-hidden="true" tabindex="-1"></a>overall_model <span class="ot">&lt;-</span> <span class="fu">vglm</span>(Position_race <span class="sc">~</span> Position_grid, </span>
<span id="cb121-4"><a href="exploratory-data-analysis-and-modeling.html#cb121-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> <span class="fu">cumulative</span>(<span class="at">parallel =</span> T, <span class="at">reverse =</span> F),</span>
<span id="cb121-5"><a href="exploratory-data-analysis-and-modeling.html#cb121-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> grids_and_races)</span>
<span id="cb121-6"><a href="exploratory-data-analysis-and-modeling.html#cb121-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-7"><a href="exploratory-data-analysis-and-modeling.html#cb121-7" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(overall_model))</span></code></pre></div>
<pre><code>##  (Intercept):1  (Intercept):2  (Intercept):3  (Intercept):4  (Intercept):5  (Intercept):6 
##   5.251639e-01   1.390002e+00   2.779530e+00   4.946141e+00   8.283053e+00   1.335696e+01 
##  (Intercept):7  (Intercept):8  (Intercept):9 (Intercept):10 (Intercept):11 (Intercept):12 
##   2.103747e+01   3.258116e+01   5.030764e+01   7.746446e+01   1.189627e+02   1.837928e+02 
## (Intercept):13 (Intercept):14 (Intercept):15 (Intercept):16 (Intercept):17 (Intercept):18 
##   2.889453e+02   4.695064e+02   8.025183e+02   1.448913e+03   3.072870e+03   7.502012e+03 
## (Intercept):19 (Intercept):20 (Intercept):21  Position_grid 
##   2.188651e+04   7.977022e+04   2.817311e+05   7.056819e-01</code></pre>
<p>There is a coefficient estimate for each predictor variable (i.e starting grid position). We would interpret these coefficients, after exponentiation, as:</p>
<p><em>If a driver starts from the front of the grid (i.e P1), there is a 22% decrease in the odds of finishing at a given position or better.</em></p>
<p>Or…</p>
<p><em>For drivers who start a race from P3, the odds of finishing P1 vs the top 2 positions are 0.21 lower.</em></p>
<p>The interpretation of the coefficients are not super intuitive. They make sense, but it takes some effort to sort out.</p>
<p>Another way to articulate this model’s results is by making predictions with the model. Below, I’ll simulate a starting grid, and make predictions for finishing place. Predicted finishing position will include a 95% confidence interval.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="exploratory-data-analysis-and-modeling.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a placeholder dataframe with all possible starting positions</span></span>
<span id="cb123-2"><a href="exploratory-data-analysis-and-modeling.html#cb123-2" aria-hidden="true" tabindex="-1"></a>starting_grid <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Position_grid =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)</span>
<span id="cb123-3"><a href="exploratory-data-analysis-and-modeling.html#cb123-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-4"><a href="exploratory-data-analysis-and-modeling.html#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a placeholder dataframe with names for predictions and standard errors. </span></span>
<span id="cb123-5"><a href="exploratory-data-analysis-and-modeling.html#cb123-5" aria-hidden="true" tabindex="-1"></a>placing_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">prob =</span> <span class="fu">rep</span>(<span class="st">&#39;prob&#39;</span>, <span class="dv">21</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb123-6"><a href="exploratory-data-analysis-and-modeling.html#cb123-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb123-7"><a href="exploratory-data-analysis-and-modeling.html#cb123-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(prob, prob, y, <span class="at">remove =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb123-8"><a href="exploratory-data-analysis-and-modeling.html#cb123-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">se =</span> <span class="fu">rep</span>(<span class="st">&#39;se&#39;</span>, <span class="dv">21</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb123-9"><a href="exploratory-data-analysis-and-modeling.html#cb123-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(se, se, y, <span class="at">remove =</span> F)</span>
<span id="cb123-10"><a href="exploratory-data-analysis-and-modeling.html#cb123-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-11"><a href="exploratory-data-analysis-and-modeling.html#cb123-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Predictions for each Finishing position (1:20), using each Starting Position (1:20)</span></span>
<span id="cb123-12"><a href="exploratory-data-analysis-and-modeling.html#cb123-12" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">predictvglm</span>(overall_model, <span class="at">newdata =</span> starting_grid, <span class="at">se.fit =</span> T)<span class="sc">$</span>fitted.values)</span>
<span id="cb123-13"><a href="exploratory-data-analysis-and-modeling.html#cb123-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-14"><a href="exploratory-data-analysis-and-modeling.html#cb123-14" aria-hidden="true" tabindex="-1"></a><span class="co"># rename the columns</span></span>
<span id="cb123-15"><a href="exploratory-data-analysis-and-modeling.html#cb123-15" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(predictions) <span class="ot">&lt;-</span> placing_df<span class="sc">$</span>prob</span>
<span id="cb123-16"><a href="exploratory-data-analysis-and-modeling.html#cb123-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-17"><a href="exploratory-data-analysis-and-modeling.html#cb123-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the standard error for each prediction</span></span>
<span id="cb123-18"><a href="exploratory-data-analysis-and-modeling.html#cb123-18" aria-hidden="true" tabindex="-1"></a>standard_errors <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">predictvglm</span>(overall_model, <span class="at">newdata =</span> starting_grid, <span class="at">se.fit =</span> T)<span class="sc">$</span>se.fit)</span>
<span id="cb123-19"><a href="exploratory-data-analysis-and-modeling.html#cb123-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-20"><a href="exploratory-data-analysis-and-modeling.html#cb123-20" aria-hidden="true" tabindex="-1"></a><span class="co"># rename the standard error </span></span>
<span id="cb123-21"><a href="exploratory-data-analysis-and-modeling.html#cb123-21" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(standard_errors) <span class="ot">&lt;-</span> placing_df<span class="sc">$</span>se</span>
<span id="cb123-22"><a href="exploratory-data-analysis-and-modeling.html#cb123-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-23"><a href="exploratory-data-analysis-and-modeling.html#cb123-23" aria-hidden="true" tabindex="-1"></a><span class="do">## As an example, I&#39;ll select the predictions and standard error for: Probability(P1 finish | P1 starting grid)</span></span>
<span id="cb123-24"><a href="exploratory-data-analysis-and-modeling.html#cb123-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Bind the predictions and standard errors together, and convert the odds to probabilities. </span></span>
<span id="cb123-25"><a href="exploratory-data-analysis-and-modeling.html#cb123-25" aria-hidden="true" tabindex="-1"></a>starting_grid_coef_finish1 <span class="ot">&lt;-</span> starting_grid <span class="sc">%&gt;%</span></span>
<span id="cb123-26"><a href="exploratory-data-analysis-and-modeling.html#cb123-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">pr_1 =</span> predictions<span class="sc">$</span>prob_1,</span>
<span id="cb123-27"><a href="exploratory-data-analysis-and-modeling.html#cb123-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">se_1 =</span> standard_errors<span class="sc">$</span>se_1) <span class="sc">%&gt;%</span></span>
<span id="cb123-28"><a href="exploratory-data-analysis-and-modeling.html#cb123-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pr =</span> <span class="fu">exp</span>(pr_1),</span>
<span id="cb123-29"><a href="exploratory-data-analysis-and-modeling.html#cb123-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower =</span> <span class="fu">exp</span>(pr_1 <span class="sc">-</span> se_1 <span class="sc">*</span> <span class="fl">1.96</span>),</span>
<span id="cb123-30"><a href="exploratory-data-analysis-and-modeling.html#cb123-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">upper =</span> <span class="fu">exp</span>(pr_1 <span class="sc">+</span> se_1 <span class="sc">*</span> <span class="fl">1.96</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb123-31"><a href="exploratory-data-analysis-and-modeling.html#cb123-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">pr =</span> pr <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> pr),</span>
<span id="cb123-32"><a href="exploratory-data-analysis-and-modeling.html#cb123-32" aria-hidden="true" tabindex="-1"></a>          <span class="at">lower =</span> lower <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> lower),</span>
<span id="cb123-33"><a href="exploratory-data-analysis-and-modeling.html#cb123-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">upper =</span> upper <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> upper))</span></code></pre></div>
<p>Now that the predictions are made, I’ll plot the Probability of winning a race given each potential starting position, P(P1 finish | a starting grid):</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="exploratory-data-analysis-and-modeling.html#cb124-1" aria-hidden="true" tabindex="-1"></a>starting_grid_coef_finish1 <span class="sc">%&gt;%</span></span>
<span id="cb124-2"><a href="exploratory-data-analysis-and-modeling.html#cb124-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Position_grid, <span class="at">y =</span> pr, <span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper)) <span class="sc">+</span></span>
<span id="cb124-3"><a href="exploratory-data-analysis-and-modeling.html#cb124-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>() <span class="sc">+</span></span>
<span id="cb124-4"><a href="exploratory-data-analysis-and-modeling.html#cb124-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb124-5"><a href="exploratory-data-analysis-and-modeling.html#cb124-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">y =</span> <span class="st">&#39;Probability of finishing P1&#39;</span>,</span>
<span id="cb124-6"><a href="exploratory-data-analysis-and-modeling.html#cb124-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">&#39;Starting Grid Position&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-137-1.png" width="672" /></p>
<p>If starting from P1, a driver has a 27% chance of winning the race, on average. If starting from P2, but still on the front row, a driver’s chance of winning drops to 21%.</p>
</div>
<div id="what-is-the-probability-of-finishing-on-the-podium" class="section level3 hasAnchor" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> What is the probability of finishing on the podium?<a href="exploratory-data-analysis-and-modeling.html#what-is-the-probability-of-finishing-on-the-podium" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can use the same approach to estimate the probability of a podium given a starting grid position.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="exploratory-data-analysis-and-modeling.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="do">## As an example, I&#39;ll select the predictions and standard error for: Probability(Podium | a starting grid)</span></span>
<span id="cb125-2"><a href="exploratory-data-analysis-and-modeling.html#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Bind the predictions and standard errors together, and convert the odds to probabilities. </span></span>
<span id="cb125-3"><a href="exploratory-data-analysis-and-modeling.html#cb125-3" aria-hidden="true" tabindex="-1"></a>starting_grid_coef_podium <span class="ot">&lt;-</span> starting_grid <span class="sc">%&gt;%</span></span>
<span id="cb125-4"><a href="exploratory-data-analysis-and-modeling.html#cb125-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">pr_1 =</span> predictions<span class="sc">$</span>prob_3,</span>
<span id="cb125-5"><a href="exploratory-data-analysis-and-modeling.html#cb125-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">se_1 =</span> standard_errors<span class="sc">$</span>se_3) <span class="sc">%&gt;%</span></span>
<span id="cb125-6"><a href="exploratory-data-analysis-and-modeling.html#cb125-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pr =</span> <span class="fu">exp</span>(pr_1),</span>
<span id="cb125-7"><a href="exploratory-data-analysis-and-modeling.html#cb125-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower =</span> <span class="fu">exp</span>(pr_1 <span class="sc">-</span> se_1 <span class="sc">*</span> <span class="fl">1.96</span>),</span>
<span id="cb125-8"><a href="exploratory-data-analysis-and-modeling.html#cb125-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">upper =</span> <span class="fu">exp</span>(pr_1 <span class="sc">+</span> se_1 <span class="sc">*</span> <span class="fl">1.96</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb125-9"><a href="exploratory-data-analysis-and-modeling.html#cb125-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">pr =</span> pr <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> pr),</span>
<span id="cb125-10"><a href="exploratory-data-analysis-and-modeling.html#cb125-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">lower =</span> lower <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> lower),</span>
<span id="cb125-11"><a href="exploratory-data-analysis-and-modeling.html#cb125-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">upper =</span> upper <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> upper))</span>
<span id="cb125-12"><a href="exploratory-data-analysis-and-modeling.html#cb125-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-13"><a href="exploratory-data-analysis-and-modeling.html#cb125-13" aria-hidden="true" tabindex="-1"></a>starting_grid_coef_podium <span class="sc">%&gt;%</span></span>
<span id="cb125-14"><a href="exploratory-data-analysis-and-modeling.html#cb125-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Position_grid, <span class="at">y =</span> pr, <span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper)) <span class="sc">+</span></span>
<span id="cb125-15"><a href="exploratory-data-analysis-and-modeling.html#cb125-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>() <span class="sc">+</span></span>
<span id="cb125-16"><a href="exploratory-data-analysis-and-modeling.html#cb125-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb125-17"><a href="exploratory-data-analysis-and-modeling.html#cb125-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">y =</span> <span class="st">&#39;Probability of a podium&#39;</span>,</span>
<span id="cb125-18"><a href="exploratory-data-analysis-and-modeling.html#cb125-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">&#39;Starting Grid Position&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-138-1.png" width="672" /></p>
<p>A driver starting from P1 has a 66% chance of finishing on the podium. I like those odds! A driver starting from P5 still has a 1 in 3 chance of finishing on the podium.</p>
<div id="prediction-grid" class="section level4 hasAnchor" number="6.1.2.1">
<h4><span class="header-section-number">6.1.2.1</span> Prediction Grid<a href="exploratory-data-analysis-and-modeling.html#prediction-grid" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>What if we wanted to know the probability of each Finish Position, given each starting position? I’ll plot in a heat map below. Each tile represents the Probability(a finishing position | a starting grid position).</p>
<p>First, I’ll need to re-shape the dataframe to a long format indexed by starting and finish position. I will also add a new column that contains the discrete probability of a given finish. Because the proportional odds model output is converted to a probabilistic statement like Probability(finish P3 or better | a starting position), the discrete probability column will give a statement like Probability(finish P3 | a starting position).</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="exploratory-data-analysis-and-modeling.html#cb126-1" aria-hidden="true" tabindex="-1"></a>preds_se_full <span class="ot">&lt;-</span> predictions <span class="sc">%&gt;%</span></span>
<span id="cb126-2"><a href="exploratory-data-analysis-and-modeling.html#cb126-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">starting =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb126-3"><a href="exploratory-data-analysis-and-modeling.html#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span> starting, <span class="at">names_to =</span> <span class="st">&#39;placing&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;prob&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb126-4"><a href="exploratory-data-analysis-and-modeling.html#cb126-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(standard_errors <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">starting =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb126-5"><a href="exploratory-data-analysis-and-modeling.html#cb126-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span> starting, <span class="at">names_to =</span> <span class="st">&#39;placing&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;se&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb126-6"><a href="exploratory-data-analysis-and-modeling.html#cb126-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(se)) <span class="sc">%&gt;%</span></span>
<span id="cb126-7"><a href="exploratory-data-analysis-and-modeling.html#cb126-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">placing =</span> <span class="fu">as.numeric</span>(<span class="fu">str_remove</span>(placing, <span class="st">&#39;prob_&#39;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb126-8"><a href="exploratory-data-analysis-and-modeling.html#cb126-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> <span class="fu">exp</span>(prob)) <span class="sc">%&gt;%</span></span>
<span id="cb126-9"><a href="exploratory-data-analysis-and-modeling.html#cb126-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> prob <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> prob)) <span class="sc">%&gt;%</span></span>
<span id="cb126-10"><a href="exploratory-data-analysis-and-modeling.html#cb126-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(starting) <span class="sc">%&gt;%</span> </span>
<span id="cb126-11"><a href="exploratory-data-analysis-and-modeling.html#cb126-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">discrete_prob =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(prob <span class="sc">-</span> <span class="fu">lag</span>(prob)), prob, (prob <span class="sc">-</span> <span class="fu">lag</span>(prob)))) <span class="sc">%&gt;%</span></span>
<span id="cb126-12"><a href="exploratory-data-analysis-and-modeling.html#cb126-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div>
<p>Now that the data is re-shaped, I’ll plot the discrete and cumulative probability heatmaps.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="exploratory-data-analysis-and-modeling.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Discrete Probability heatmap</span></span>
<span id="cb127-2"><a href="exploratory-data-analysis-and-modeling.html#cb127-2" aria-hidden="true" tabindex="-1"></a>preds_se_full <span class="sc">%&gt;%</span></span>
<span id="cb127-3"><a href="exploratory-data-analysis-and-modeling.html#cb127-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(starting, placing, <span class="at">fill =</span> discrete_prob)) <span class="sc">+</span></span>
<span id="cb127-4"><a href="exploratory-data-analysis-and-modeling.html#cb127-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">col =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb127-5"><a href="exploratory-data-analysis-and-modeling.html#cb127-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_family=</span><span class="st">&quot;Helvetica&quot;</span>) <span class="sc">+</span></span>
<span id="cb127-6"><a href="exploratory-data-analysis-and-modeling.html#cb127-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&#39;magma&#39;</span>) <span class="sc">+</span></span>
<span id="cb127-7"><a href="exploratory-data-analysis-and-modeling.html#cb127-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb127-8"><a href="exploratory-data-analysis-and-modeling.html#cb127-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks=</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb127-9"><a href="exploratory-data-analysis-and-modeling.html#cb127-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Starting Grid&#39;</span>,</span>
<span id="cb127-10"><a href="exploratory-data-analysis-and-modeling.html#cb127-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Final Placing&#39;</span>,</span>
<span id="cb127-11"><a href="exploratory-data-analysis-and-modeling.html#cb127-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">&#39;Probability&#39;</span>,</span>
<span id="cb127-12"><a href="exploratory-data-analysis-and-modeling.html#cb127-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="fu">expression</span>(Discrete<span class="sc">~</span>Probability<span class="sc">~</span>of<span class="sc">~</span>finishing<span class="sc">~</span>P[n])) <span class="sc">+</span></span>
<span id="cb127-13"><a href="exploratory-data-analysis-and-modeling.html#cb127-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb127-14"><a href="exploratory-data-analysis-and-modeling.html#cb127-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">21</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb127-15"><a href="exploratory-data-analysis-and-modeling.html#cb127-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-140-1.png" width="672" /></p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="exploratory-data-analysis-and-modeling.html#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Cumulative Probability heatmap </span></span>
<span id="cb128-2"><a href="exploratory-data-analysis-and-modeling.html#cb128-2" aria-hidden="true" tabindex="-1"></a>preds_se_full <span class="sc">%&gt;%</span></span>
<span id="cb128-3"><a href="exploratory-data-analysis-and-modeling.html#cb128-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(starting, placing, <span class="at">fill =</span> prob)) <span class="sc">+</span></span>
<span id="cb128-4"><a href="exploratory-data-analysis-and-modeling.html#cb128-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">col =</span> <span class="st">&#39;white&#39;</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb128-5"><a href="exploratory-data-analysis-and-modeling.html#cb128-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_family=</span><span class="st">&quot;Helvetica&quot;</span>) <span class="sc">+</span></span>
<span id="cb128-6"><a href="exploratory-data-analysis-and-modeling.html#cb128-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&#39;magma&#39;</span>) <span class="sc">+</span></span>
<span id="cb128-7"><a href="exploratory-data-analysis-and-modeling.html#cb128-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb128-8"><a href="exploratory-data-analysis-and-modeling.html#cb128-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks=</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb128-9"><a href="exploratory-data-analysis-and-modeling.html#cb128-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Starting Grid&#39;</span>,</span>
<span id="cb128-10"><a href="exploratory-data-analysis-and-modeling.html#cb128-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Final Placing&#39;</span>,</span>
<span id="cb128-11"><a href="exploratory-data-analysis-and-modeling.html#cb128-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">&#39;Probability&#39;</span>,</span>
<span id="cb128-12"><a href="exploratory-data-analysis-and-modeling.html#cb128-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="fu">expression</span>(Probability<span class="sc">~</span>of<span class="sc">~</span>finishing<span class="sc">~</span>P[n]<span class="sc">~</span>or<span class="sc">~</span>better)) <span class="sc">+</span></span>
<span id="cb128-13"><a href="exploratory-data-analysis-and-modeling.html#cb128-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb128-14"><a href="exploratory-data-analysis-and-modeling.html#cb128-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">21</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb128-15"><a href="exploratory-data-analysis-and-modeling.html#cb128-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-140-2.png" width="672" /></p>
<p>The cumulative probability plot is helpful, but the discrete probability plot is a bit tough to follow. Let’s try plotting this information a different way.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="exploratory-data-analysis-and-modeling.html#cb129-1" aria-hidden="true" tabindex="-1"></a>preds_se_full <span class="sc">%&gt;%</span></span>
<span id="cb129-2"><a href="exploratory-data-analysis-and-modeling.html#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">starting_pos =</span> <span class="fu">as.factor</span>(<span class="fu">paste0</span>(<span class="st">&#39;P&#39;</span>,starting)),</span>
<span id="cb129-3"><a href="exploratory-data-analysis-and-modeling.html#cb129-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">starting_pos =</span> <span class="fu">fct_reorder</span>(starting_pos, starting)) <span class="sc">%&gt;%</span></span>
<span id="cb129-4"><a href="exploratory-data-analysis-and-modeling.html#cb129-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(placing, discrete_prob)) <span class="sc">+</span></span>
<span id="cb129-5"><a href="exploratory-data-analysis-and-modeling.html#cb129-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb129-6"><a href="exploratory-data-analysis-and-modeling.html#cb129-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> placing, <span class="at">xend =</span> placing, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> discrete_prob),</span>
<span id="cb129-7"><a href="exploratory-data-analysis-and-modeling.html#cb129-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">col =</span> <span class="st">&#39;cornflowerblue&#39;</span>) <span class="sc">+</span></span>
<span id="cb129-8"><a href="exploratory-data-analysis-and-modeling.html#cb129-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb129-9"><a href="exploratory-data-analysis-and-modeling.html#cb129-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> starting, <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb129-10"><a href="exploratory-data-analysis-and-modeling.html#cb129-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Final Race Classification&#39;</span>,</span>
<span id="cb129-11"><a href="exploratory-data-analysis-and-modeling.html#cb129-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Probability&#39;</span>,</span>
<span id="cb129-12"><a href="exploratory-data-analysis-and-modeling.html#cb129-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="fu">expression</span>(Discrete<span class="sc">~</span>Probability<span class="sc">~</span>of<span class="sc">~</span>finishing<span class="sc">~</span>P[n]),</span>
<span id="cb129-13"><a href="exploratory-data-analysis-and-modeling.html#cb129-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;All races: 2016 - 2022&#39;</span>) <span class="sc">+</span></span>
<span id="cb129-14"><a href="exploratory-data-analysis-and-modeling.html#cb129-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb129-15"><a href="exploratory-data-analysis-and-modeling.html#cb129-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-141-1.png" width="672" /></p>
<p>The plot above shows the probability of finishing at any position given where the driver starts the race. It is important to keep in mind what this model is built on. These predictions are generated solely from starting position. And, we know there is much more involved in where you finish. Otherwise, why even run the race?! Let’s try expanding this model to include additional variables.</p>
</div>
</div>
<div id="yearly-differences" class="section level3 hasAnchor" number="6.1.3">
<h3><span class="header-section-number">6.1.3</span> Yearly Differences<a href="exploratory-data-analysis-and-modeling.html#yearly-differences" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Does this relationship between starting and finishing position vary over time? 2022 ushered in a completely different set of regulations that enabled cars to follow more closely and overtake more easily. Is this represented in the data? We will now look into yearly differences in starting grid position coefficient!</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="exploratory-data-analysis-and-modeling.html#cb130-1" aria-hidden="true" tabindex="-1"></a>model16 <span class="ot">&lt;-</span> <span class="fu">vglm</span>(Position_race <span class="sc">~</span> Position_grid, </span>
<span id="cb130-2"><a href="exploratory-data-analysis-and-modeling.html#cb130-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> <span class="fu">cumulative</span>(<span class="at">parallel =</span> T, <span class="at">reverse =</span> F),</span>
<span id="cb130-3"><a href="exploratory-data-analysis-and-modeling.html#cb130-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> grids_and_races <span class="sc">%&gt;%</span></span>
<span id="cb130-4"><a href="exploratory-data-analysis-and-modeling.html#cb130-4" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="dv">2016</span>))</span>
<span id="cb130-5"><a href="exploratory-data-analysis-and-modeling.html#cb130-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-6"><a href="exploratory-data-analysis-and-modeling.html#cb130-6" aria-hidden="true" tabindex="-1"></a>model17 <span class="ot">&lt;-</span> <span class="fu">vglm</span>(Position_race <span class="sc">~</span> Position_grid, </span>
<span id="cb130-7"><a href="exploratory-data-analysis-and-modeling.html#cb130-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> <span class="fu">cumulative</span>(<span class="at">parallel =</span> T, <span class="at">reverse =</span> F),</span>
<span id="cb130-8"><a href="exploratory-data-analysis-and-modeling.html#cb130-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> grids_and_races <span class="sc">%&gt;%</span></span>
<span id="cb130-9"><a href="exploratory-data-analysis-and-modeling.html#cb130-9" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="dv">2017</span>))</span>
<span id="cb130-10"><a href="exploratory-data-analysis-and-modeling.html#cb130-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-11"><a href="exploratory-data-analysis-and-modeling.html#cb130-11" aria-hidden="true" tabindex="-1"></a>model18 <span class="ot">&lt;-</span> <span class="fu">vglm</span>(Position_race <span class="sc">~</span> Position_grid, </span>
<span id="cb130-12"><a href="exploratory-data-analysis-and-modeling.html#cb130-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> <span class="fu">cumulative</span>(<span class="at">parallel =</span> T, <span class="at">reverse =</span> F),</span>
<span id="cb130-13"><a href="exploratory-data-analysis-and-modeling.html#cb130-13" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> grids_and_races <span class="sc">%&gt;%</span></span>
<span id="cb130-14"><a href="exploratory-data-analysis-and-modeling.html#cb130-14" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="dv">2018</span>))</span>
<span id="cb130-15"><a href="exploratory-data-analysis-and-modeling.html#cb130-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-16"><a href="exploratory-data-analysis-and-modeling.html#cb130-16" aria-hidden="true" tabindex="-1"></a>model19 <span class="ot">&lt;-</span> <span class="fu">vglm</span>(Position_race <span class="sc">~</span> Position_grid, </span>
<span id="cb130-17"><a href="exploratory-data-analysis-and-modeling.html#cb130-17" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> <span class="fu">cumulative</span>(<span class="at">parallel =</span> T, <span class="at">reverse =</span> F),</span>
<span id="cb130-18"><a href="exploratory-data-analysis-and-modeling.html#cb130-18" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> grids_and_races <span class="sc">%&gt;%</span></span>
<span id="cb130-19"><a href="exploratory-data-analysis-and-modeling.html#cb130-19" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="dv">2019</span>))</span>
<span id="cb130-20"><a href="exploratory-data-analysis-and-modeling.html#cb130-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-21"><a href="exploratory-data-analysis-and-modeling.html#cb130-21" aria-hidden="true" tabindex="-1"></a>model20 <span class="ot">&lt;-</span> <span class="fu">vglm</span>(Position_race <span class="sc">~</span> Position_grid, </span>
<span id="cb130-22"><a href="exploratory-data-analysis-and-modeling.html#cb130-22" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> <span class="fu">cumulative</span>(<span class="at">parallel =</span> T, <span class="at">reverse =</span> F),</span>
<span id="cb130-23"><a href="exploratory-data-analysis-and-modeling.html#cb130-23" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> grids_and_races <span class="sc">%&gt;%</span></span>
<span id="cb130-24"><a href="exploratory-data-analysis-and-modeling.html#cb130-24" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="dv">2020</span>))</span>
<span id="cb130-25"><a href="exploratory-data-analysis-and-modeling.html#cb130-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-26"><a href="exploratory-data-analysis-and-modeling.html#cb130-26" aria-hidden="true" tabindex="-1"></a>model21 <span class="ot">&lt;-</span> <span class="fu">vglm</span>(Position_race <span class="sc">~</span> Position_grid, </span>
<span id="cb130-27"><a href="exploratory-data-analysis-and-modeling.html#cb130-27" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> <span class="fu">cumulative</span>(<span class="at">parallel =</span> T, <span class="at">reverse =</span> F),</span>
<span id="cb130-28"><a href="exploratory-data-analysis-and-modeling.html#cb130-28" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> grids_and_races <span class="sc">%&gt;%</span></span>
<span id="cb130-29"><a href="exploratory-data-analysis-and-modeling.html#cb130-29" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="dv">2021</span>))</span>
<span id="cb130-30"><a href="exploratory-data-analysis-and-modeling.html#cb130-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-31"><a href="exploratory-data-analysis-and-modeling.html#cb130-31" aria-hidden="true" tabindex="-1"></a>model22 <span class="ot">&lt;-</span> <span class="fu">vglm</span>(Position_race <span class="sc">~</span> Position_grid, </span>
<span id="cb130-32"><a href="exploratory-data-analysis-and-modeling.html#cb130-32" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> <span class="fu">cumulative</span>(<span class="at">parallel =</span> T, <span class="at">reverse =</span> F),</span>
<span id="cb130-33"><a href="exploratory-data-analysis-and-modeling.html#cb130-33" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> grids_and_races <span class="sc">%&gt;%</span></span>
<span id="cb130-34"><a href="exploratory-data-analysis-and-modeling.html#cb130-34" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="dv">2022</span>))</span>
<span id="cb130-35"><a href="exploratory-data-analysis-and-modeling.html#cb130-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-36"><a href="exploratory-data-analysis-and-modeling.html#cb130-36" aria-hidden="true" tabindex="-1"></a>model23 <span class="ot">&lt;-</span> <span class="fu">vglm</span>(Position_race <span class="sc">~</span> Position_grid, </span>
<span id="cb130-37"><a href="exploratory-data-analysis-and-modeling.html#cb130-37" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> <span class="fu">cumulative</span>(<span class="at">parallel =</span> T, <span class="at">reverse =</span> F),</span>
<span id="cb130-38"><a href="exploratory-data-analysis-and-modeling.html#cb130-38" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> grids_and_races <span class="sc">%&gt;%</span></span>
<span id="cb130-39"><a href="exploratory-data-analysis-and-modeling.html#cb130-39" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="dv">2023</span>))</span></code></pre></div>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="exploratory-data-analysis-and-modeling.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 2016</span></span>
<span id="cb131-2"><a href="exploratory-data-analysis-and-modeling.html#cb131-2" aria-hidden="true" tabindex="-1"></a>preds_2016 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">predictvglm</span>(model16, <span class="at">newdata =</span> starting_grid, <span class="at">se.fit =</span> T)<span class="sc">$</span>fitted.values)</span>
<span id="cb131-3"><a href="exploratory-data-analysis-and-modeling.html#cb131-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-4"><a href="exploratory-data-analysis-and-modeling.html#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="co"># rename the columns</span></span>
<span id="cb131-5"><a href="exploratory-data-analysis-and-modeling.html#cb131-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(preds_2016) <span class="ot">&lt;-</span> placing_df<span class="sc">$</span>prob</span>
<span id="cb131-6"><a href="exploratory-data-analysis-and-modeling.html#cb131-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-7"><a href="exploratory-data-analysis-and-modeling.html#cb131-7" aria-hidden="true" tabindex="-1"></a>preds_2016 <span class="ot">&lt;-</span> preds_2016  <span class="sc">%&gt;%</span> </span>
<span id="cb131-8"><a href="exploratory-data-analysis-and-modeling.html#cb131-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="dv">2016</span>) <span class="sc">%&gt;%</span></span>
<span id="cb131-9"><a href="exploratory-data-analysis-and-modeling.html#cb131-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(starting_grid)</span>
<span id="cb131-10"><a href="exploratory-data-analysis-and-modeling.html#cb131-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-11"><a href="exploratory-data-analysis-and-modeling.html#cb131-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the standard error for each prediction</span></span>
<span id="cb131-12"><a href="exploratory-data-analysis-and-modeling.html#cb131-12" aria-hidden="true" tabindex="-1"></a>standard_errors_2016 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">predictvglm</span>(model16, <span class="at">newdata =</span> starting_grid, <span class="at">se.fit =</span> T)<span class="sc">$</span>se.fit)</span>
<span id="cb131-13"><a href="exploratory-data-analysis-and-modeling.html#cb131-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-14"><a href="exploratory-data-analysis-and-modeling.html#cb131-14" aria-hidden="true" tabindex="-1"></a><span class="co"># rename the standard error </span></span>
<span id="cb131-15"><a href="exploratory-data-analysis-and-modeling.html#cb131-15" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(standard_errors_2016) <span class="ot">&lt;-</span> placing_df<span class="sc">$</span>se</span>
<span id="cb131-16"><a href="exploratory-data-analysis-and-modeling.html#cb131-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-17"><a href="exploratory-data-analysis-and-modeling.html#cb131-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 2017</span></span>
<span id="cb131-18"><a href="exploratory-data-analysis-and-modeling.html#cb131-18" aria-hidden="true" tabindex="-1"></a>preds_2017 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">predictvglm</span>(model17, <span class="at">newdata =</span> starting_grid, <span class="at">se.fit =</span> T)<span class="sc">$</span>fitted.values)</span>
<span id="cb131-19"><a href="exploratory-data-analysis-and-modeling.html#cb131-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-20"><a href="exploratory-data-analysis-and-modeling.html#cb131-20" aria-hidden="true" tabindex="-1"></a><span class="co"># rename the columns</span></span>
<span id="cb131-21"><a href="exploratory-data-analysis-and-modeling.html#cb131-21" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(preds_2017) <span class="ot">&lt;-</span> placing_df<span class="sc">$</span>prob[<span class="dv">1</span><span class="sc">:</span><span class="dv">17</span>]</span>
<span id="cb131-22"><a href="exploratory-data-analysis-and-modeling.html#cb131-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-23"><a href="exploratory-data-analysis-and-modeling.html#cb131-23" aria-hidden="true" tabindex="-1"></a>preds_2017 <span class="ot">&lt;-</span> preds_2017  <span class="sc">%&gt;%</span> </span>
<span id="cb131-24"><a href="exploratory-data-analysis-and-modeling.html#cb131-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="dv">2017</span>) <span class="sc">%&gt;%</span></span>
<span id="cb131-25"><a href="exploratory-data-analysis-and-modeling.html#cb131-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(starting_grid)</span>
<span id="cb131-26"><a href="exploratory-data-analysis-and-modeling.html#cb131-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-27"><a href="exploratory-data-analysis-and-modeling.html#cb131-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the standard error for each prediction</span></span>
<span id="cb131-28"><a href="exploratory-data-analysis-and-modeling.html#cb131-28" aria-hidden="true" tabindex="-1"></a>standard_errors_2017 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">predictvglm</span>(model17, <span class="at">newdata =</span> starting_grid, <span class="at">se.fit =</span> T)<span class="sc">$</span>se.fit) <span class="sc">%&gt;%</span> </span>
<span id="cb131-29"><a href="exploratory-data-analysis-and-modeling.html#cb131-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="dv">2017</span>) <span class="sc">%&gt;%</span></span>
<span id="cb131-30"><a href="exploratory-data-analysis-and-modeling.html#cb131-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(starting_grid)</span>
<span id="cb131-31"><a href="exploratory-data-analysis-and-modeling.html#cb131-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-32"><a href="exploratory-data-analysis-and-modeling.html#cb131-32" aria-hidden="true" tabindex="-1"></a><span class="co"># rename the standard error </span></span>
<span id="cb131-33"><a href="exploratory-data-analysis-and-modeling.html#cb131-33" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(standard_errors_2017) <span class="ot">&lt;-</span> placing_df<span class="sc">$</span>se[<span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>]</span>
<span id="cb131-34"><a href="exploratory-data-analysis-and-modeling.html#cb131-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-35"><a href="exploratory-data-analysis-and-modeling.html#cb131-35" aria-hidden="true" tabindex="-1"></a><span class="do">## 2018</span></span>
<span id="cb131-36"><a href="exploratory-data-analysis-and-modeling.html#cb131-36" aria-hidden="true" tabindex="-1"></a>preds_2018 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">predictvglm</span>(model18, <span class="at">newdata =</span> starting_grid, <span class="at">se.fit =</span> T)<span class="sc">$</span>fitted.values)</span>
<span id="cb131-37"><a href="exploratory-data-analysis-and-modeling.html#cb131-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-38"><a href="exploratory-data-analysis-and-modeling.html#cb131-38" aria-hidden="true" tabindex="-1"></a><span class="co"># rename the columns</span></span>
<span id="cb131-39"><a href="exploratory-data-analysis-and-modeling.html#cb131-39" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(preds_2018) <span class="ot">&lt;-</span> placing_df<span class="sc">$</span>prob[<span class="dv">1</span><span class="sc">:</span><span class="dv">19</span>]</span>
<span id="cb131-40"><a href="exploratory-data-analysis-and-modeling.html#cb131-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-41"><a href="exploratory-data-analysis-and-modeling.html#cb131-41" aria-hidden="true" tabindex="-1"></a>preds_2018 <span class="ot">&lt;-</span> preds_2018  <span class="sc">%&gt;%</span> </span>
<span id="cb131-42"><a href="exploratory-data-analysis-and-modeling.html#cb131-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="dv">2018</span>) <span class="sc">%&gt;%</span></span>
<span id="cb131-43"><a href="exploratory-data-analysis-and-modeling.html#cb131-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(starting_grid)</span>
<span id="cb131-44"><a href="exploratory-data-analysis-and-modeling.html#cb131-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-45"><a href="exploratory-data-analysis-and-modeling.html#cb131-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the standard error for each prediction</span></span>
<span id="cb131-46"><a href="exploratory-data-analysis-and-modeling.html#cb131-46" aria-hidden="true" tabindex="-1"></a>standard_errors_2018 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">predictvglm</span>(model18, <span class="at">newdata =</span> starting_grid, <span class="at">se.fit =</span> T)<span class="sc">$</span>se.fit) <span class="sc">%&gt;%</span> </span>
<span id="cb131-47"><a href="exploratory-data-analysis-and-modeling.html#cb131-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="dv">2018</span>) <span class="sc">%&gt;%</span></span>
<span id="cb131-48"><a href="exploratory-data-analysis-and-modeling.html#cb131-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(starting_grid)</span>
<span id="cb131-49"><a href="exploratory-data-analysis-and-modeling.html#cb131-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-50"><a href="exploratory-data-analysis-and-modeling.html#cb131-50" aria-hidden="true" tabindex="-1"></a><span class="co"># rename the standard error </span></span>
<span id="cb131-51"><a href="exploratory-data-analysis-and-modeling.html#cb131-51" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(standard_errors_2018) <span class="ot">&lt;-</span> placing_df<span class="sc">$</span>se[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>]</span>
<span id="cb131-52"><a href="exploratory-data-analysis-and-modeling.html#cb131-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-53"><a href="exploratory-data-analysis-and-modeling.html#cb131-53" aria-hidden="true" tabindex="-1"></a><span class="do">## 2019</span></span>
<span id="cb131-54"><a href="exploratory-data-analysis-and-modeling.html#cb131-54" aria-hidden="true" tabindex="-1"></a>preds_2019 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">predictvglm</span>(model19, <span class="at">newdata =</span> starting_grid, <span class="at">se.fit =</span> T)<span class="sc">$</span>fitted.values)</span>
<span id="cb131-55"><a href="exploratory-data-analysis-and-modeling.html#cb131-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-56"><a href="exploratory-data-analysis-and-modeling.html#cb131-56" aria-hidden="true" tabindex="-1"></a><span class="co"># rename the columns</span></span>
<span id="cb131-57"><a href="exploratory-data-analysis-and-modeling.html#cb131-57" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(preds_2019) <span class="ot">&lt;-</span> placing_df<span class="sc">$</span>prob[<span class="dv">1</span><span class="sc">:</span><span class="dv">19</span>]</span>
<span id="cb131-58"><a href="exploratory-data-analysis-and-modeling.html#cb131-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-59"><a href="exploratory-data-analysis-and-modeling.html#cb131-59" aria-hidden="true" tabindex="-1"></a>preds_2019 <span class="ot">&lt;-</span> preds_2019  <span class="sc">%&gt;%</span> </span>
<span id="cb131-60"><a href="exploratory-data-analysis-and-modeling.html#cb131-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="dv">2019</span>) <span class="sc">%&gt;%</span></span>
<span id="cb131-61"><a href="exploratory-data-analysis-and-modeling.html#cb131-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(starting_grid)</span>
<span id="cb131-62"><a href="exploratory-data-analysis-and-modeling.html#cb131-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-63"><a href="exploratory-data-analysis-and-modeling.html#cb131-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the standard error for each prediction</span></span>
<span id="cb131-64"><a href="exploratory-data-analysis-and-modeling.html#cb131-64" aria-hidden="true" tabindex="-1"></a>standard_errors_2019 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">predictvglm</span>(model19, <span class="at">newdata =</span> starting_grid, <span class="at">se.fit =</span> T)<span class="sc">$</span>se.fit) <span class="sc">%&gt;%</span> </span>
<span id="cb131-65"><a href="exploratory-data-analysis-and-modeling.html#cb131-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="dv">2019</span>) <span class="sc">%&gt;%</span></span>
<span id="cb131-66"><a href="exploratory-data-analysis-and-modeling.html#cb131-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(starting_grid)</span>
<span id="cb131-67"><a href="exploratory-data-analysis-and-modeling.html#cb131-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-68"><a href="exploratory-data-analysis-and-modeling.html#cb131-68" aria-hidden="true" tabindex="-1"></a><span class="co"># rename the standard error </span></span>
<span id="cb131-69"><a href="exploratory-data-analysis-and-modeling.html#cb131-69" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(standard_errors_2019) <span class="ot">&lt;-</span> placing_df<span class="sc">$</span>se[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>]</span>
<span id="cb131-70"><a href="exploratory-data-analysis-and-modeling.html#cb131-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-71"><a href="exploratory-data-analysis-and-modeling.html#cb131-71" aria-hidden="true" tabindex="-1"></a><span class="do">## 2020</span></span>
<span id="cb131-72"><a href="exploratory-data-analysis-and-modeling.html#cb131-72" aria-hidden="true" tabindex="-1"></a>preds_2020 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">predictvglm</span>(model20, <span class="at">newdata =</span> starting_grid, <span class="at">se.fit =</span> T)<span class="sc">$</span>fitted.values)</span>
<span id="cb131-73"><a href="exploratory-data-analysis-and-modeling.html#cb131-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-74"><a href="exploratory-data-analysis-and-modeling.html#cb131-74" aria-hidden="true" tabindex="-1"></a><span class="co"># rename the columns</span></span>
<span id="cb131-75"><a href="exploratory-data-analysis-and-modeling.html#cb131-75" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(preds_2020) <span class="ot">&lt;-</span> placing_df<span class="sc">$</span>prob[<span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>]</span>
<span id="cb131-76"><a href="exploratory-data-analysis-and-modeling.html#cb131-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-77"><a href="exploratory-data-analysis-and-modeling.html#cb131-77" aria-hidden="true" tabindex="-1"></a>preds_2020 <span class="ot">&lt;-</span> preds_2020  <span class="sc">%&gt;%</span> </span>
<span id="cb131-78"><a href="exploratory-data-analysis-and-modeling.html#cb131-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="dv">2020</span>) <span class="sc">%&gt;%</span></span>
<span id="cb131-79"><a href="exploratory-data-analysis-and-modeling.html#cb131-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(starting_grid)</span>
<span id="cb131-80"><a href="exploratory-data-analysis-and-modeling.html#cb131-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-81"><a href="exploratory-data-analysis-and-modeling.html#cb131-81" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the standard error for each prediction</span></span>
<span id="cb131-82"><a href="exploratory-data-analysis-and-modeling.html#cb131-82" aria-hidden="true" tabindex="-1"></a>standard_errors_2020 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">predictvglm</span>(model20, <span class="at">newdata =</span> starting_grid, <span class="at">se.fit =</span> T)<span class="sc">$</span>se.fit) <span class="sc">%&gt;%</span> </span>
<span id="cb131-83"><a href="exploratory-data-analysis-and-modeling.html#cb131-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="dv">2020</span>) <span class="sc">%&gt;%</span></span>
<span id="cb131-84"><a href="exploratory-data-analysis-and-modeling.html#cb131-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(starting_grid)</span>
<span id="cb131-85"><a href="exploratory-data-analysis-and-modeling.html#cb131-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-86"><a href="exploratory-data-analysis-and-modeling.html#cb131-86" aria-hidden="true" tabindex="-1"></a><span class="co"># rename the standard error </span></span>
<span id="cb131-87"><a href="exploratory-data-analysis-and-modeling.html#cb131-87" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(standard_errors_2020) <span class="ot">&lt;-</span> placing_df<span class="sc">$</span>se[<span class="dv">1</span><span class="sc">:</span><span class="dv">19</span>]</span>
<span id="cb131-88"><a href="exploratory-data-analysis-and-modeling.html#cb131-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-89"><a href="exploratory-data-analysis-and-modeling.html#cb131-89" aria-hidden="true" tabindex="-1"></a><span class="do">## 2021</span></span>
<span id="cb131-90"><a href="exploratory-data-analysis-and-modeling.html#cb131-90" aria-hidden="true" tabindex="-1"></a>preds_2021 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">predictvglm</span>(model21, <span class="at">newdata =</span> starting_grid, <span class="at">se.fit =</span> T)<span class="sc">$</span>fitted.values)</span>
<span id="cb131-91"><a href="exploratory-data-analysis-and-modeling.html#cb131-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-92"><a href="exploratory-data-analysis-and-modeling.html#cb131-92" aria-hidden="true" tabindex="-1"></a><span class="co"># rename the columns</span></span>
<span id="cb131-93"><a href="exploratory-data-analysis-and-modeling.html#cb131-93" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(preds_2021) <span class="ot">&lt;-</span> placing_df<span class="sc">$</span>prob[<span class="dv">1</span><span class="sc">:</span><span class="dv">19</span>]</span>
<span id="cb131-94"><a href="exploratory-data-analysis-and-modeling.html#cb131-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-95"><a href="exploratory-data-analysis-and-modeling.html#cb131-95" aria-hidden="true" tabindex="-1"></a>preds_2021 <span class="ot">&lt;-</span> preds_2021  <span class="sc">%&gt;%</span> </span>
<span id="cb131-96"><a href="exploratory-data-analysis-and-modeling.html#cb131-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="dv">2021</span>) <span class="sc">%&gt;%</span></span>
<span id="cb131-97"><a href="exploratory-data-analysis-and-modeling.html#cb131-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(starting_grid)</span>
<span id="cb131-98"><a href="exploratory-data-analysis-and-modeling.html#cb131-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-99"><a href="exploratory-data-analysis-and-modeling.html#cb131-99" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the standard error for each prediction</span></span>
<span id="cb131-100"><a href="exploratory-data-analysis-and-modeling.html#cb131-100" aria-hidden="true" tabindex="-1"></a>standard_errors_2021 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">predictvglm</span>(model21, <span class="at">newdata =</span> starting_grid, <span class="at">se.fit =</span> T)<span class="sc">$</span>se.fit) <span class="sc">%&gt;%</span> </span>
<span id="cb131-101"><a href="exploratory-data-analysis-and-modeling.html#cb131-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="dv">2021</span>) <span class="sc">%&gt;%</span></span>
<span id="cb131-102"><a href="exploratory-data-analysis-and-modeling.html#cb131-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(starting_grid)</span>
<span id="cb131-103"><a href="exploratory-data-analysis-and-modeling.html#cb131-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-104"><a href="exploratory-data-analysis-and-modeling.html#cb131-104" aria-hidden="true" tabindex="-1"></a><span class="co"># rename the standard error </span></span>
<span id="cb131-105"><a href="exploratory-data-analysis-and-modeling.html#cb131-105" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(standard_errors_2021) <span class="ot">&lt;-</span> placing_df<span class="sc">$</span>se[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>]</span>
<span id="cb131-106"><a href="exploratory-data-analysis-and-modeling.html#cb131-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-107"><a href="exploratory-data-analysis-and-modeling.html#cb131-107" aria-hidden="true" tabindex="-1"></a><span class="do">## 2022</span></span>
<span id="cb131-108"><a href="exploratory-data-analysis-and-modeling.html#cb131-108" aria-hidden="true" tabindex="-1"></a>preds_2022 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">predictvglm</span>(model22, <span class="at">newdata =</span> starting_grid, <span class="at">se.fit =</span> T)<span class="sc">$</span>fitted.values)</span>
<span id="cb131-109"><a href="exploratory-data-analysis-and-modeling.html#cb131-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-110"><a href="exploratory-data-analysis-and-modeling.html#cb131-110" aria-hidden="true" tabindex="-1"></a><span class="co"># rename the columns</span></span>
<span id="cb131-111"><a href="exploratory-data-analysis-and-modeling.html#cb131-111" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(preds_2022) <span class="ot">&lt;-</span> placing_df<span class="sc">$</span>prob[<span class="dv">1</span><span class="sc">:</span><span class="dv">19</span>]</span>
<span id="cb131-112"><a href="exploratory-data-analysis-and-modeling.html#cb131-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-113"><a href="exploratory-data-analysis-and-modeling.html#cb131-113" aria-hidden="true" tabindex="-1"></a>preds_2022 <span class="ot">&lt;-</span> preds_2022  <span class="sc">%&gt;%</span> </span>
<span id="cb131-114"><a href="exploratory-data-analysis-and-modeling.html#cb131-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="dv">2022</span>) <span class="sc">%&gt;%</span></span>
<span id="cb131-115"><a href="exploratory-data-analysis-and-modeling.html#cb131-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(starting_grid)</span>
<span id="cb131-116"><a href="exploratory-data-analysis-and-modeling.html#cb131-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-117"><a href="exploratory-data-analysis-and-modeling.html#cb131-117" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the standard error for each prediction</span></span>
<span id="cb131-118"><a href="exploratory-data-analysis-and-modeling.html#cb131-118" aria-hidden="true" tabindex="-1"></a>standard_errors_2022 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">predictvglm</span>(model22, <span class="at">newdata =</span> starting_grid, <span class="at">se.fit =</span> T)<span class="sc">$</span>se.fit) <span class="sc">%&gt;%</span> </span>
<span id="cb131-119"><a href="exploratory-data-analysis-and-modeling.html#cb131-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="dv">2022</span>) <span class="sc">%&gt;%</span></span>
<span id="cb131-120"><a href="exploratory-data-analysis-and-modeling.html#cb131-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(starting_grid)</span>
<span id="cb131-121"><a href="exploratory-data-analysis-and-modeling.html#cb131-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-122"><a href="exploratory-data-analysis-and-modeling.html#cb131-122" aria-hidden="true" tabindex="-1"></a><span class="co"># rename the standard error </span></span>
<span id="cb131-123"><a href="exploratory-data-analysis-and-modeling.html#cb131-123" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(standard_errors_2022) <span class="ot">&lt;-</span> placing_df<span class="sc">$</span>se[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>]</span>
<span id="cb131-124"><a href="exploratory-data-analysis-and-modeling.html#cb131-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-125"><a href="exploratory-data-analysis-and-modeling.html#cb131-125" aria-hidden="true" tabindex="-1"></a><span class="do">## 2023</span></span>
<span id="cb131-126"><a href="exploratory-data-analysis-and-modeling.html#cb131-126" aria-hidden="true" tabindex="-1"></a>preds_2023 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">predictvglm</span>(model23, <span class="at">newdata =</span> starting_grid, <span class="at">se.fit =</span> T)<span class="sc">$</span>fitted.values)</span>
<span id="cb131-127"><a href="exploratory-data-analysis-and-modeling.html#cb131-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-128"><a href="exploratory-data-analysis-and-modeling.html#cb131-128" aria-hidden="true" tabindex="-1"></a><span class="co"># rename the columns</span></span>
<span id="cb131-129"><a href="exploratory-data-analysis-and-modeling.html#cb131-129" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(preds_2023) <span class="ot">&lt;-</span> placing_df<span class="sc">$</span>prob[<span class="dv">1</span><span class="sc">:</span><span class="dv">19</span>]</span>
<span id="cb131-130"><a href="exploratory-data-analysis-and-modeling.html#cb131-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-131"><a href="exploratory-data-analysis-and-modeling.html#cb131-131" aria-hidden="true" tabindex="-1"></a>preds_2023 <span class="ot">&lt;-</span> preds_2023  <span class="sc">%&gt;%</span> </span>
<span id="cb131-132"><a href="exploratory-data-analysis-and-modeling.html#cb131-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="dv">2023</span>) <span class="sc">%&gt;%</span></span>
<span id="cb131-133"><a href="exploratory-data-analysis-and-modeling.html#cb131-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(starting_grid)</span>
<span id="cb131-134"><a href="exploratory-data-analysis-and-modeling.html#cb131-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-135"><a href="exploratory-data-analysis-and-modeling.html#cb131-135" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the standard error for each prediction</span></span>
<span id="cb131-136"><a href="exploratory-data-analysis-and-modeling.html#cb131-136" aria-hidden="true" tabindex="-1"></a>standard_errors_2023 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">predictvglm</span>(model23, <span class="at">newdata =</span> starting_grid, <span class="at">se.fit =</span> T)<span class="sc">$</span>se.fit) <span class="sc">%&gt;%</span> </span>
<span id="cb131-137"><a href="exploratory-data-analysis-and-modeling.html#cb131-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="dv">2023</span>) <span class="sc">%&gt;%</span></span>
<span id="cb131-138"><a href="exploratory-data-analysis-and-modeling.html#cb131-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(starting_grid)</span>
<span id="cb131-139"><a href="exploratory-data-analysis-and-modeling.html#cb131-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-140"><a href="exploratory-data-analysis-and-modeling.html#cb131-140" aria-hidden="true" tabindex="-1"></a><span class="co"># rename the standard error </span></span>
<span id="cb131-141"><a href="exploratory-data-analysis-and-modeling.html#cb131-141" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(standard_errors_2023) <span class="ot">&lt;-</span> placing_df<span class="sc">$</span>se[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>]</span></code></pre></div>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="exploratory-data-analysis-and-modeling.html#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(preds_2016[, <span class="fu">c</span>(<span class="st">&#39;prob_1&#39;</span>, <span class="st">&#39;Year&#39;</span>, <span class="st">&#39;Position_grid&#39;</span>)], preds_2017[, <span class="fu">c</span>(<span class="st">&#39;prob_1&#39;</span>, <span class="st">&#39;Year&#39;</span>, <span class="st">&#39;Position_grid&#39;</span>)], preds_2018[, <span class="fu">c</span>(<span class="st">&#39;prob_1&#39;</span>, <span class="st">&#39;Year&#39;</span>, <span class="st">&#39;Position_grid&#39;</span>)],</span>
<span id="cb132-2"><a href="exploratory-data-analysis-and-modeling.html#cb132-2" aria-hidden="true" tabindex="-1"></a>      preds_2019[, <span class="fu">c</span>(<span class="st">&#39;prob_1&#39;</span>, <span class="st">&#39;Year&#39;</span>, <span class="st">&#39;Position_grid&#39;</span>)],</span>
<span id="cb132-3"><a href="exploratory-data-analysis-and-modeling.html#cb132-3" aria-hidden="true" tabindex="-1"></a>      preds_2020[, <span class="fu">c</span>(<span class="st">&#39;prob_1&#39;</span>, <span class="st">&#39;Year&#39;</span>, <span class="st">&#39;Position_grid&#39;</span>)], preds_2021[, <span class="fu">c</span>(<span class="st">&#39;prob_1&#39;</span>, <span class="st">&#39;Year&#39;</span>, <span class="st">&#39;Position_grid&#39;</span>)], </span>
<span id="cb132-4"><a href="exploratory-data-analysis-and-modeling.html#cb132-4" aria-hidden="true" tabindex="-1"></a>      preds_2022[, <span class="fu">c</span>(<span class="st">&#39;prob_1&#39;</span>, <span class="st">&#39;Year&#39;</span>, <span class="st">&#39;Position_grid&#39;</span>)], preds_2023[, <span class="fu">c</span>(<span class="st">&#39;prob_1&#39;</span>, <span class="st">&#39;Year&#39;</span>, <span class="st">&#39;Position_grid&#39;</span>)]) <span class="sc">%&gt;%</span> </span>
<span id="cb132-5"><a href="exploratory-data-analysis-and-modeling.html#cb132-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pr =</span> <span class="fu">exp</span>(prob_1),</span>
<span id="cb132-6"><a href="exploratory-data-analysis-and-modeling.html#cb132-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Year =</span> <span class="fu">factor</span>(Year)) <span class="sc">%&gt;%</span> </span>
<span id="cb132-7"><a href="exploratory-data-analysis-and-modeling.html#cb132-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">pr =</span> pr <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> pr)) <span class="sc">%&gt;%</span> </span>
<span id="cb132-8"><a href="exploratory-data-analysis-and-modeling.html#cb132-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;2021&#39;</span>, <span class="st">&#39;2022&#39;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb132-9"><a href="exploratory-data-analysis-and-modeling.html#cb132-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Position_grid, <span class="at">y =</span> pr, <span class="at">group  =</span> Year, <span class="at">col =</span> Year)) <span class="sc">+</span></span>
<span id="cb132-10"><a href="exploratory-data-analysis-and-modeling.html#cb132-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb132-11"><a href="exploratory-data-analysis-and-modeling.html#cb132-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>, <span class="fu">aes</span>(<span class="at">fill =</span> Year)) <span class="sc">+</span></span>
<span id="cb132-12"><a href="exploratory-data-analysis-and-modeling.html#cb132-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb132-13"><a href="exploratory-data-analysis-and-modeling.html#cb132-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">y =</span> <span class="st">&#39;Probability of finishing P1&#39;</span>,</span>
<span id="cb132-14"><a href="exploratory-data-analysis-and-modeling.html#cb132-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">&#39;Starting Grid Position&#39;</span>,</span>
<span id="cb132-15"><a href="exploratory-data-analysis-and-modeling.html#cb132-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">&#39;Model Results by Year&#39;</span>) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-144-1.png" width="672" /></p>
<p>It looks like drivers in 2022 had a better chance of winning a race from 5th or worse position on the starting grid. In 2021, drivers who started from the first two rows of the grid had a better chance of winning than they did in 2022. Are these differences due to the new regulations, or is this simply capturing the fact that Verstappen won from 7th, 10th, and 14th?</p>
<p>What about podiums?</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="exploratory-data-analysis-and-modeling.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(preds_2016[, <span class="fu">c</span>(<span class="st">&#39;prob_3&#39;</span>, <span class="st">&#39;Year&#39;</span>, <span class="st">&#39;Position_grid&#39;</span>)], preds_2017[, <span class="fu">c</span>(<span class="st">&#39;prob_3&#39;</span>, <span class="st">&#39;Year&#39;</span>, <span class="st">&#39;Position_grid&#39;</span>)], preds_2018[, <span class="fu">c</span>(<span class="st">&#39;prob_3&#39;</span>, <span class="st">&#39;Year&#39;</span>, <span class="st">&#39;Position_grid&#39;</span>)],</span>
<span id="cb133-2"><a href="exploratory-data-analysis-and-modeling.html#cb133-2" aria-hidden="true" tabindex="-1"></a>      preds_2019[, <span class="fu">c</span>(<span class="st">&#39;prob_3&#39;</span>, <span class="st">&#39;Year&#39;</span>, <span class="st">&#39;Position_grid&#39;</span>)],</span>
<span id="cb133-3"><a href="exploratory-data-analysis-and-modeling.html#cb133-3" aria-hidden="true" tabindex="-1"></a>      preds_2020[, <span class="fu">c</span>(<span class="st">&#39;prob_3&#39;</span>, <span class="st">&#39;Year&#39;</span>, <span class="st">&#39;Position_grid&#39;</span>)], preds_2021[, <span class="fu">c</span>(<span class="st">&#39;prob_3&#39;</span>, <span class="st">&#39;Year&#39;</span>, <span class="st">&#39;Position_grid&#39;</span>)], </span>
<span id="cb133-4"><a href="exploratory-data-analysis-and-modeling.html#cb133-4" aria-hidden="true" tabindex="-1"></a>      preds_2022[, <span class="fu">c</span>(<span class="st">&#39;prob_3&#39;</span>, <span class="st">&#39;Year&#39;</span>, <span class="st">&#39;Position_grid&#39;</span>)], </span>
<span id="cb133-5"><a href="exploratory-data-analysis-and-modeling.html#cb133-5" aria-hidden="true" tabindex="-1"></a>      preds_2023[, <span class="fu">c</span>(<span class="st">&#39;prob_3&#39;</span>, <span class="st">&#39;Year&#39;</span>, <span class="st">&#39;Position_grid&#39;</span>)]) <span class="sc">%&gt;%</span></span>
<span id="cb133-6"><a href="exploratory-data-analysis-and-modeling.html#cb133-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pr =</span> <span class="fu">exp</span>(prob_3),</span>
<span id="cb133-7"><a href="exploratory-data-analysis-and-modeling.html#cb133-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Year =</span> <span class="fu">factor</span>(Year)) <span class="sc">%&gt;%</span></span>
<span id="cb133-8"><a href="exploratory-data-analysis-and-modeling.html#cb133-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">pr =</span> pr <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> pr)) <span class="sc">%&gt;%</span></span>
<span id="cb133-9"><a href="exploratory-data-analysis-and-modeling.html#cb133-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2021</span>, <span class="dv">2022</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb133-10"><a href="exploratory-data-analysis-and-modeling.html#cb133-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Position_grid, <span class="at">y =</span> pr, <span class="at">group  =</span> Year, <span class="at">col =</span> Year)) <span class="sc">+</span></span>
<span id="cb133-11"><a href="exploratory-data-analysis-and-modeling.html#cb133-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb133-12"><a href="exploratory-data-analysis-and-modeling.html#cb133-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>, <span class="fu">aes</span>(<span class="at">fill =</span> Year)) <span class="sc">+</span></span>
<span id="cb133-13"><a href="exploratory-data-analysis-and-modeling.html#cb133-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb133-14"><a href="exploratory-data-analysis-and-modeling.html#cb133-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">y =</span> <span class="st">&#39;Probability of finishing on the podium&#39;</span>,</span>
<span id="cb133-15"><a href="exploratory-data-analysis-and-modeling.html#cb133-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">&#39;Starting Grid Position&#39;</span>,</span>
<span id="cb133-16"><a href="exploratory-data-analysis-and-modeling.html#cb133-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">&#39;Model Results by Year&#39;</span>) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-145-1.png" width="672" /></p>
<p>The podium probabilities are actually more compelling. Drivers starting from 5th or lower have an even greater chance of finishing on the podium in 2022.</p>
</div>
</div>
<div id="explore-circuit-specific-models" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Explore Circuit Specific Models<a href="exploratory-data-analysis-and-modeling.html#explore-circuit-specific-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>It is generally accepted among racing teams, drivers, and enthusiasts that overtaking (or passing opponents) is easier at some circuits compared to others. Let’s explore whether there are indeed differences in our model coefficients across different circuits.</p>
<div id="bahrain" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Bahrain<a href="exploratory-data-analysis-and-modeling.html#bahrain" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Bahrain Grand Prix is the first race of the 2023 season. What type of finish might we expect, if only using starting grid position as a predictor?</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="exploratory-data-analysis-and-modeling.html#cb134-1" aria-hidden="true" tabindex="-1"></a>bahrain_model <span class="ot">&lt;-</span> <span class="fu">vglm</span>(Position_race <span class="sc">~</span> Position_grid, </span>
<span id="cb134-2"><a href="exploratory-data-analysis-and-modeling.html#cb134-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> <span class="fu">cumulative</span>(<span class="at">parallel =</span> T, <span class="at">reverse =</span> F),</span>
<span id="cb134-3"><a href="exploratory-data-analysis-and-modeling.html#cb134-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> grids_and_races <span class="sc">%&gt;%</span></span>
<span id="cb134-4"><a href="exploratory-data-analysis-and-modeling.html#cb134-4" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">filter</span>(Race <span class="sc">==</span> <span class="st">&#39;bahrain&#39;</span>))</span>
<span id="cb134-5"><a href="exploratory-data-analysis-and-modeling.html#cb134-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-6"><a href="exploratory-data-analysis-and-modeling.html#cb134-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bahrain_model)</span></code></pre></div>
<pre><code>## 
## Call:
## vglm(formula = Position_race ~ Position_grid, family = cumulative(parallel = T, 
##     reverse = F), data = grids_and_races %&gt;% filter(Race == &quot;bahrain&quot;))
## 
## Coefficients: 
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept):1  -0.71682    0.38544  -1.860  0.06292 .  
## (Intercept):2   0.25694    0.31651   0.812  0.41691    
## (Intercept):3   0.97556    0.30294   3.220  0.00128 ** 
## (Intercept):4   1.56822    0.30841   5.085 3.68e-07 ***
## (Intercept):5   2.07456    0.32182   6.446 1.15e-10 ***
## (Intercept):6   2.53923    0.33940   7.481 7.35e-14 ***
## (Intercept):7   2.97706    0.35938   8.284  &lt; 2e-16 ***
## (Intercept):8   3.39893    0.38081   8.926  &lt; 2e-16 ***
## (Intercept):9   3.81682    0.40337   9.462  &lt; 2e-16 ***
## (Intercept):10  4.23980    0.42686   9.933  &lt; 2e-16 ***
## (Intercept):11  4.63579    0.44890  10.327  &lt; 2e-16 ***
## (Intercept):12  5.07800    0.47318  10.732  &lt; 2e-16 ***
## (Intercept):13  5.54374    0.49812  11.129  &lt; 2e-16 ***
## (Intercept):14  6.03512    0.52391  11.519  &lt; 2e-16 ***
## (Intercept):15  6.51782    0.54970  11.857  &lt; 2e-16 ***
## (Intercept):16  7.12033    0.58570  12.157  &lt; 2e-16 ***
## (Intercept):17  8.11628    0.67346  12.052  &lt; 2e-16 ***
## (Intercept):18  9.22555    0.87402  10.555  &lt; 2e-16 ***
## Position_grid  -0.33144    0.03226 -10.274  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Number of linear predictors:  18 
## 
## Residual deviance: 874.4459 on 3077 degrees of freedom
## 
## Log-likelihood: -437.223 on 3077 degrees of freedom
## 
## Number of Fisher scoring iterations: 7 
## 
## Warning: Hauck-Donner effect detected in the following estimate(s):
## &#39;(Intercept):17&#39;, &#39;(Intercept):18&#39;
## 
## 
## Exponentiated coefficients:
## Position_grid 
##     0.7178892</code></pre>
<p>Make Predictions for the grid</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="exploratory-data-analysis-and-modeling.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Predictions for each Finishing position (1:20), using each Starting Position (1:20)</span></span>
<span id="cb136-2"><a href="exploratory-data-analysis-and-modeling.html#cb136-2" aria-hidden="true" tabindex="-1"></a>predictions_bahrain <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">predictvglm</span>(bahrain_model, <span class="at">newdata =</span> starting_grid, <span class="at">se.fit =</span> T)<span class="sc">$</span>fitted.values)</span>
<span id="cb136-3"><a href="exploratory-data-analysis-and-modeling.html#cb136-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-4"><a href="exploratory-data-analysis-and-modeling.html#cb136-4" aria-hidden="true" tabindex="-1"></a><span class="co"># rename the columns</span></span>
<span id="cb136-5"><a href="exploratory-data-analysis-and-modeling.html#cb136-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(predictions_bahrain) <span class="ot">&lt;-</span> placing_df<span class="sc">$</span>prob[<span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>]</span>
<span id="cb136-6"><a href="exploratory-data-analysis-and-modeling.html#cb136-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-7"><a href="exploratory-data-analysis-and-modeling.html#cb136-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the standard error for each prediction</span></span>
<span id="cb136-8"><a href="exploratory-data-analysis-and-modeling.html#cb136-8" aria-hidden="true" tabindex="-1"></a>standard_errors_bahrain <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">predictvglm</span>(bahrain_model, <span class="at">newdata =</span> starting_grid, <span class="at">se.fit =</span> T)<span class="sc">$</span>se.fit)</span>
<span id="cb136-9"><a href="exploratory-data-analysis-and-modeling.html#cb136-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-10"><a href="exploratory-data-analysis-and-modeling.html#cb136-10" aria-hidden="true" tabindex="-1"></a><span class="co"># rename the standard error </span></span>
<span id="cb136-11"><a href="exploratory-data-analysis-and-modeling.html#cb136-11" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(standard_errors_bahrain) <span class="ot">&lt;-</span> placing_df<span class="sc">$</span>se[<span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>]</span></code></pre></div>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="exploratory-data-analysis-and-modeling.html#cb137-1" aria-hidden="true" tabindex="-1"></a>starting_grid <span class="sc">%&gt;%</span></span>
<span id="cb137-2"><a href="exploratory-data-analysis-and-modeling.html#cb137-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">pr_1 =</span> predictions_bahrain<span class="sc">$</span>prob_1,</span>
<span id="cb137-3"><a href="exploratory-data-analysis-and-modeling.html#cb137-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">se_1 =</span> standard_errors_bahrain<span class="sc">$</span>se_1) <span class="sc">%&gt;%</span></span>
<span id="cb137-4"><a href="exploratory-data-analysis-and-modeling.html#cb137-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pr =</span> <span class="fu">exp</span>(pr_1),</span>
<span id="cb137-5"><a href="exploratory-data-analysis-and-modeling.html#cb137-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower =</span> <span class="fu">exp</span>(pr_1 <span class="sc">-</span> se_1 <span class="sc">*</span> <span class="fl">1.96</span>),</span>
<span id="cb137-6"><a href="exploratory-data-analysis-and-modeling.html#cb137-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">upper =</span> <span class="fu">exp</span>(pr_1 <span class="sc">+</span> se_1 <span class="sc">*</span> <span class="fl">1.96</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb137-7"><a href="exploratory-data-analysis-and-modeling.html#cb137-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">pr =</span> pr <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> pr),</span>
<span id="cb137-8"><a href="exploratory-data-analysis-and-modeling.html#cb137-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">lower =</span> lower <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> lower),</span>
<span id="cb137-9"><a href="exploratory-data-analysis-and-modeling.html#cb137-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">upper =</span> upper <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> upper)) <span class="sc">%&gt;%</span></span>
<span id="cb137-10"><a href="exploratory-data-analysis-and-modeling.html#cb137-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Position_grid, <span class="at">y =</span> pr, <span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper)) <span class="sc">+</span></span>
<span id="cb137-11"><a href="exploratory-data-analysis-and-modeling.html#cb137-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>() <span class="sc">+</span></span>
<span id="cb137-12"><a href="exploratory-data-analysis-and-modeling.html#cb137-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb137-13"><a href="exploratory-data-analysis-and-modeling.html#cb137-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">y =</span> <span class="st">&#39;Probability of finishing P1&#39;</span>,</span>
<span id="cb137-14"><a href="exploratory-data-analysis-and-modeling.html#cb137-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">&#39;Starting Grid Position&#39;</span>,</span>
<span id="cb137-15"><a href="exploratory-data-analysis-and-modeling.html#cb137-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">&#39;Bahrain Grand Prix&#39;</span>,</span>
<span id="cb137-16"><a href="exploratory-data-analysis-and-modeling.html#cb137-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="st">&#39;Probability of a win&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-148-1.png" width="672" /></p>
<p>What’s the probability of a podium?</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="exploratory-data-analysis-and-modeling.html#cb138-1" aria-hidden="true" tabindex="-1"></a>starting_grid <span class="sc">%&gt;%</span></span>
<span id="cb138-2"><a href="exploratory-data-analysis-and-modeling.html#cb138-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">pr_3 =</span> predictions_bahrain<span class="sc">$</span>prob_3,</span>
<span id="cb138-3"><a href="exploratory-data-analysis-and-modeling.html#cb138-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">se_3 =</span> standard_errors_bahrain<span class="sc">$</span>se_3) <span class="sc">%&gt;%</span></span>
<span id="cb138-4"><a href="exploratory-data-analysis-and-modeling.html#cb138-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pr =</span> <span class="fu">exp</span>(pr_3),</span>
<span id="cb138-5"><a href="exploratory-data-analysis-and-modeling.html#cb138-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower =</span> <span class="fu">exp</span>(pr_3 <span class="sc">-</span> se_3 <span class="sc">*</span> <span class="fl">1.96</span>),</span>
<span id="cb138-6"><a href="exploratory-data-analysis-and-modeling.html#cb138-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">upper =</span> <span class="fu">exp</span>(pr_3 <span class="sc">+</span> se_3 <span class="sc">*</span> <span class="fl">1.96</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb138-7"><a href="exploratory-data-analysis-and-modeling.html#cb138-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">pr =</span> pr <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> pr),</span>
<span id="cb138-8"><a href="exploratory-data-analysis-and-modeling.html#cb138-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">lower =</span> lower <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> lower),</span>
<span id="cb138-9"><a href="exploratory-data-analysis-and-modeling.html#cb138-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">upper =</span> upper <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> upper)) <span class="sc">%&gt;%</span></span>
<span id="cb138-10"><a href="exploratory-data-analysis-and-modeling.html#cb138-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Position_grid, <span class="at">y =</span> pr, <span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper)) <span class="sc">+</span></span>
<span id="cb138-11"><a href="exploratory-data-analysis-and-modeling.html#cb138-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>() <span class="sc">+</span></span>
<span id="cb138-12"><a href="exploratory-data-analysis-and-modeling.html#cb138-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb138-13"><a href="exploratory-data-analysis-and-modeling.html#cb138-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">y =</span> <span class="st">&#39;Probability of a podium&#39;</span>,</span>
<span id="cb138-14"><a href="exploratory-data-analysis-and-modeling.html#cb138-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">&#39;Starting Grid Position&#39;</span>,</span>
<span id="cb138-15"><a href="exploratory-data-analysis-and-modeling.html#cb138-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">&#39;Bahrain Gand Prix&#39;</span>,</span>
<span id="cb138-16"><a href="exploratory-data-analysis-and-modeling.html#cb138-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="st">&#39;Probability of a podium&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-149-1.png" width="672" /></p>
<p>And now, I’ll construct probability distributions for each finishing position given a starting a positin at the Bahrain GP.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="exploratory-data-analysis-and-modeling.html#cb139-1" aria-hidden="true" tabindex="-1"></a>bahrain_preds_se_full <span class="ot">&lt;-</span> predictions_bahrain <span class="sc">%&gt;%</span></span>
<span id="cb139-2"><a href="exploratory-data-analysis-and-modeling.html#cb139-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">starting =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb139-3"><a href="exploratory-data-analysis-and-modeling.html#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span> starting, <span class="at">names_to =</span> <span class="st">&#39;placing&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;prob&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb139-4"><a href="exploratory-data-analysis-and-modeling.html#cb139-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(standard_errors_bahrain <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">starting =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb139-5"><a href="exploratory-data-analysis-and-modeling.html#cb139-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span> starting, <span class="at">names_to =</span> <span class="st">&#39;placing&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;se&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb139-6"><a href="exploratory-data-analysis-and-modeling.html#cb139-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(se)) <span class="sc">%&gt;%</span></span>
<span id="cb139-7"><a href="exploratory-data-analysis-and-modeling.html#cb139-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">placing =</span> <span class="fu">as.numeric</span>(<span class="fu">str_remove</span>(placing, <span class="st">&#39;prob_&#39;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb139-8"><a href="exploratory-data-analysis-and-modeling.html#cb139-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> <span class="fu">exp</span>(prob)) <span class="sc">%&gt;%</span></span>
<span id="cb139-9"><a href="exploratory-data-analysis-and-modeling.html#cb139-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> prob <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> prob)) <span class="sc">%&gt;%</span></span>
<span id="cb139-10"><a href="exploratory-data-analysis-and-modeling.html#cb139-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(starting) <span class="sc">%&gt;%</span> </span>
<span id="cb139-11"><a href="exploratory-data-analysis-and-modeling.html#cb139-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">discrete_prob =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(prob <span class="sc">-</span> <span class="fu">lag</span>(prob)), prob, (prob <span class="sc">-</span> <span class="fu">lag</span>(prob)))) <span class="sc">%&gt;%</span></span>
<span id="cb139-12"><a href="exploratory-data-analysis-and-modeling.html#cb139-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb139-13"><a href="exploratory-data-analysis-and-modeling.html#cb139-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-14"><a href="exploratory-data-analysis-and-modeling.html#cb139-14" aria-hidden="true" tabindex="-1"></a>bahrain_preds_se_full <span class="sc">%&gt;%</span></span>
<span id="cb139-15"><a href="exploratory-data-analysis-and-modeling.html#cb139-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">starting_pos =</span> <span class="fu">as.factor</span>(<span class="fu">paste0</span>(<span class="st">&#39;P&#39;</span>,starting)),</span>
<span id="cb139-16"><a href="exploratory-data-analysis-and-modeling.html#cb139-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">starting_pos =</span> <span class="fu">fct_reorder</span>(starting_pos, starting)) <span class="sc">%&gt;%</span></span>
<span id="cb139-17"><a href="exploratory-data-analysis-and-modeling.html#cb139-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(placing, discrete_prob)) <span class="sc">+</span></span>
<span id="cb139-18"><a href="exploratory-data-analysis-and-modeling.html#cb139-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb139-19"><a href="exploratory-data-analysis-and-modeling.html#cb139-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> placing, <span class="at">xend =</span> placing, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> discrete_prob),</span>
<span id="cb139-20"><a href="exploratory-data-analysis-and-modeling.html#cb139-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">col =</span> <span class="st">&#39;maroon&#39;</span>) <span class="sc">+</span></span>
<span id="cb139-21"><a href="exploratory-data-analysis-and-modeling.html#cb139-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb139-22"><a href="exploratory-data-analysis-and-modeling.html#cb139-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> starting, <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb139-23"><a href="exploratory-data-analysis-and-modeling.html#cb139-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Final Race Classification&#39;</span>,</span>
<span id="cb139-24"><a href="exploratory-data-analysis-and-modeling.html#cb139-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Probability&#39;</span>,</span>
<span id="cb139-25"><a href="exploratory-data-analysis-and-modeling.html#cb139-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="fu">expression</span>(Discrete<span class="sc">~</span>Probability<span class="sc">~</span>of<span class="sc">~</span>finishing<span class="sc">~</span>P[n]),</span>
<span id="cb139-26"><a href="exploratory-data-analysis-and-modeling.html#cb139-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;Bahrain Grand Prix: 2016 - 2022&#39;</span>) <span class="sc">+</span></span>
<span id="cb139-27"><a href="exploratory-data-analysis-and-modeling.html#cb139-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb139-28"><a href="exploratory-data-analysis-and-modeling.html#cb139-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb139-29"><a href="exploratory-data-analysis-and-modeling.html#cb139-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>, <span class="dv">15</span>, <span class="dv">18</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>, <span class="dv">15</span>, <span class="dv">18</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-150-1.png" width="672" /></p>
</div>
<div id="saudi-arabia" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Saudi Arabia<a href="exploratory-data-analysis-and-modeling.html#saudi-arabia" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The second race of the 2023 season takes place in Saudi Arabia at the Jeddah Corniche Circuit. Jeddah is the fastest street circuit in Formula 1. How does it compare to other street circuits?</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="exploratory-data-analysis-and-modeling.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb140-2"><a href="exploratory-data-analysis-and-modeling.html#cb140-2" aria-hidden="true" tabindex="-1"></a>saudiarabia_model <span class="ot">&lt;-</span> <span class="fu">vglm</span>(Position_race <span class="sc">~</span> Position_grid, </span>
<span id="cb140-3"><a href="exploratory-data-analysis-and-modeling.html#cb140-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> <span class="fu">cumulative</span>(<span class="at">parallel =</span> T, <span class="at">reverse =</span> F),</span>
<span id="cb140-4"><a href="exploratory-data-analysis-and-modeling.html#cb140-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> grids_and_races <span class="sc">%&gt;%</span></span>
<span id="cb140-5"><a href="exploratory-data-analysis-and-modeling.html#cb140-5" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">filter</span>(Race <span class="sc">==</span> <span class="st">&#39;saudi-arabia&#39;</span>))</span>
<span id="cb140-6"><a href="exploratory-data-analysis-and-modeling.html#cb140-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-7"><a href="exploratory-data-analysis-and-modeling.html#cb140-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Predictions for each Finishing position (1:20), using each Starting Position (1:20)</span></span>
<span id="cb140-8"><a href="exploratory-data-analysis-and-modeling.html#cb140-8" aria-hidden="true" tabindex="-1"></a>predictions_saudiarabia <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">predictvglm</span>(saudiarabia_model, <span class="at">newdata =</span> starting_grid, <span class="at">se.fit =</span> T)<span class="sc">$</span>fitted.values)</span>
<span id="cb140-9"><a href="exploratory-data-analysis-and-modeling.html#cb140-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-10"><a href="exploratory-data-analysis-and-modeling.html#cb140-10" aria-hidden="true" tabindex="-1"></a><span class="co"># rename the columns</span></span>
<span id="cb140-11"><a href="exploratory-data-analysis-and-modeling.html#cb140-11" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(predictions_saudiarabia) <span class="ot">&lt;-</span> placing_df<span class="sc">$</span>prob[<span class="dv">1</span><span class="sc">:</span><span class="dv">17</span>]</span>
<span id="cb140-12"><a href="exploratory-data-analysis-and-modeling.html#cb140-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-13"><a href="exploratory-data-analysis-and-modeling.html#cb140-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the standard error for each prediction</span></span>
<span id="cb140-14"><a href="exploratory-data-analysis-and-modeling.html#cb140-14" aria-hidden="true" tabindex="-1"></a>standard_errors_saudiarabia <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">predictvglm</span>(saudiarabia_model, <span class="at">newdata =</span> starting_grid, <span class="at">se.fit =</span> T)<span class="sc">$</span>se.fit)</span>
<span id="cb140-15"><a href="exploratory-data-analysis-and-modeling.html#cb140-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-16"><a href="exploratory-data-analysis-and-modeling.html#cb140-16" aria-hidden="true" tabindex="-1"></a><span class="co"># rename the standard error </span></span>
<span id="cb140-17"><a href="exploratory-data-analysis-and-modeling.html#cb140-17" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(standard_errors_saudiarabia) <span class="ot">&lt;-</span> placing_df<span class="sc">$</span>se[<span class="dv">1</span><span class="sc">:</span><span class="dv">17</span>]</span></code></pre></div>
<p>Plot Saudi Arabian Grand Prix probability of a win</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="exploratory-data-analysis-and-modeling.html#cb141-1" aria-hidden="true" tabindex="-1"></a>starting_grid <span class="sc">%&gt;%</span></span>
<span id="cb141-2"><a href="exploratory-data-analysis-and-modeling.html#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">pr_1 =</span> predictions_saudiarabia<span class="sc">$</span>prob_1,</span>
<span id="cb141-3"><a href="exploratory-data-analysis-and-modeling.html#cb141-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">se_1 =</span> standard_errors_saudiarabia<span class="sc">$</span>se_1) <span class="sc">%&gt;%</span></span>
<span id="cb141-4"><a href="exploratory-data-analysis-and-modeling.html#cb141-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pr =</span> <span class="fu">exp</span>(pr_1),</span>
<span id="cb141-5"><a href="exploratory-data-analysis-and-modeling.html#cb141-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower =</span> <span class="fu">exp</span>(pr_1 <span class="sc">-</span> se_1 <span class="sc">*</span> <span class="fl">1.96</span>),</span>
<span id="cb141-6"><a href="exploratory-data-analysis-and-modeling.html#cb141-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">upper =</span> <span class="fu">exp</span>(pr_1 <span class="sc">+</span> se_1 <span class="sc">*</span> <span class="fl">1.96</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb141-7"><a href="exploratory-data-analysis-and-modeling.html#cb141-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">pr =</span> pr <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> pr),</span>
<span id="cb141-8"><a href="exploratory-data-analysis-and-modeling.html#cb141-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">lower =</span> lower <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> lower),</span>
<span id="cb141-9"><a href="exploratory-data-analysis-and-modeling.html#cb141-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">upper =</span> upper <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> upper)) <span class="sc">%&gt;%</span></span>
<span id="cb141-10"><a href="exploratory-data-analysis-and-modeling.html#cb141-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Position_grid, <span class="at">y =</span> pr, <span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper)) <span class="sc">+</span></span>
<span id="cb141-11"><a href="exploratory-data-analysis-and-modeling.html#cb141-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>() <span class="sc">+</span></span>
<span id="cb141-12"><a href="exploratory-data-analysis-and-modeling.html#cb141-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb141-13"><a href="exploratory-data-analysis-and-modeling.html#cb141-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">y =</span> <span class="st">&#39;Probability of finishing P1&#39;</span>,</span>
<span id="cb141-14"><a href="exploratory-data-analysis-and-modeling.html#cb141-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">&#39;Starting Grid Position&#39;</span>,</span>
<span id="cb141-15"><a href="exploratory-data-analysis-and-modeling.html#cb141-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">&#39;Saudi Arabia&#39;</span>,</span>
<span id="cb141-16"><a href="exploratory-data-analysis-and-modeling.html#cb141-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="st">&#39;Probability of a win&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-152-1.png" width="672" /></p>
<p>Plot Saudi Arabian Grand Prix probability of a podium.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="exploratory-data-analysis-and-modeling.html#cb142-1" aria-hidden="true" tabindex="-1"></a>starting_grid <span class="sc">%&gt;%</span></span>
<span id="cb142-2"><a href="exploratory-data-analysis-and-modeling.html#cb142-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">pr_3 =</span> predictions_saudiarabia<span class="sc">$</span>prob_3,</span>
<span id="cb142-3"><a href="exploratory-data-analysis-and-modeling.html#cb142-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">se_3 =</span> standard_errors_saudiarabia<span class="sc">$</span>se_3) <span class="sc">%&gt;%</span></span>
<span id="cb142-4"><a href="exploratory-data-analysis-and-modeling.html#cb142-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pr =</span> <span class="fu">exp</span>(pr_3),</span>
<span id="cb142-5"><a href="exploratory-data-analysis-and-modeling.html#cb142-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower =</span> <span class="fu">exp</span>(pr_3 <span class="sc">-</span> se_3 <span class="sc">*</span> <span class="fl">1.96</span>),</span>
<span id="cb142-6"><a href="exploratory-data-analysis-and-modeling.html#cb142-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">upper =</span> <span class="fu">exp</span>(pr_3 <span class="sc">+</span> se_3 <span class="sc">*</span> <span class="fl">1.96</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb142-7"><a href="exploratory-data-analysis-and-modeling.html#cb142-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">pr =</span> pr <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> pr),</span>
<span id="cb142-8"><a href="exploratory-data-analysis-and-modeling.html#cb142-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">lower =</span> lower <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> lower),</span>
<span id="cb142-9"><a href="exploratory-data-analysis-and-modeling.html#cb142-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">upper =</span> upper <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> upper)) <span class="sc">%&gt;%</span></span>
<span id="cb142-10"><a href="exploratory-data-analysis-and-modeling.html#cb142-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Position_grid, <span class="at">y =</span> pr, <span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper)) <span class="sc">+</span></span>
<span id="cb142-11"><a href="exploratory-data-analysis-and-modeling.html#cb142-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>() <span class="sc">+</span></span>
<span id="cb142-12"><a href="exploratory-data-analysis-and-modeling.html#cb142-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb142-13"><a href="exploratory-data-analysis-and-modeling.html#cb142-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">y =</span> <span class="st">&#39;Probability of finishing on the podium&#39;</span>,</span>
<span id="cb142-14"><a href="exploratory-data-analysis-and-modeling.html#cb142-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">&#39;Starting Grid Position&#39;</span>,</span>
<span id="cb142-15"><a href="exploratory-data-analysis-and-modeling.html#cb142-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">&#39;Saudi Arabia&#39;</span>,</span>
<span id="cb142-16"><a href="exploratory-data-analysis-and-modeling.html#cb142-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="st">&#39;Probability of a podium&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-153-1.png" width="672" /></p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="exploratory-data-analysis-and-modeling.html#cb143-1" aria-hidden="true" tabindex="-1"></a>saudiarabia_preds_se_full <span class="ot">&lt;-</span> predictions_saudiarabia <span class="sc">%&gt;%</span></span>
<span id="cb143-2"><a href="exploratory-data-analysis-and-modeling.html#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">starting =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb143-3"><a href="exploratory-data-analysis-and-modeling.html#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span> starting, <span class="at">names_to =</span> <span class="st">&#39;placing&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;prob&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb143-4"><a href="exploratory-data-analysis-and-modeling.html#cb143-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(standard_errors_saudiarabia <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">starting =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb143-5"><a href="exploratory-data-analysis-and-modeling.html#cb143-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span> starting, <span class="at">names_to =</span> <span class="st">&#39;placing&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;se&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb143-6"><a href="exploratory-data-analysis-and-modeling.html#cb143-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(se)) <span class="sc">%&gt;%</span></span>
<span id="cb143-7"><a href="exploratory-data-analysis-and-modeling.html#cb143-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">placing =</span> <span class="fu">as.numeric</span>(<span class="fu">str_remove</span>(placing, <span class="st">&#39;prob_&#39;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb143-8"><a href="exploratory-data-analysis-and-modeling.html#cb143-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> <span class="fu">exp</span>(prob)) <span class="sc">%&gt;%</span></span>
<span id="cb143-9"><a href="exploratory-data-analysis-and-modeling.html#cb143-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> prob <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> prob)) <span class="sc">%&gt;%</span></span>
<span id="cb143-10"><a href="exploratory-data-analysis-and-modeling.html#cb143-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(starting) <span class="sc">%&gt;%</span> </span>
<span id="cb143-11"><a href="exploratory-data-analysis-and-modeling.html#cb143-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">discrete_prob =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(prob <span class="sc">-</span> <span class="fu">lag</span>(prob)), prob, (prob <span class="sc">-</span> <span class="fu">lag</span>(prob)))) <span class="sc">%&gt;%</span></span>
<span id="cb143-12"><a href="exploratory-data-analysis-and-modeling.html#cb143-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb143-13"><a href="exploratory-data-analysis-and-modeling.html#cb143-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-14"><a href="exploratory-data-analysis-and-modeling.html#cb143-14" aria-hidden="true" tabindex="-1"></a>saudiarabia_preds_se_full <span class="sc">%&gt;%</span></span>
<span id="cb143-15"><a href="exploratory-data-analysis-and-modeling.html#cb143-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">starting_pos =</span> <span class="fu">as.factor</span>(<span class="fu">paste0</span>(<span class="st">&#39;P&#39;</span>,starting)),</span>
<span id="cb143-16"><a href="exploratory-data-analysis-and-modeling.html#cb143-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">starting_pos =</span> <span class="fu">fct_reorder</span>(starting_pos, starting)) <span class="sc">%&gt;%</span></span>
<span id="cb143-17"><a href="exploratory-data-analysis-and-modeling.html#cb143-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(placing, discrete_prob)) <span class="sc">+</span></span>
<span id="cb143-18"><a href="exploratory-data-analysis-and-modeling.html#cb143-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> placing, <span class="at">xend =</span> placing, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> discrete_prob),</span>
<span id="cb143-19"><a href="exploratory-data-analysis-and-modeling.html#cb143-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">col =</span> <span class="st">&#39;darkgreen&#39;</span>) <span class="sc">+</span></span>
<span id="cb143-20"><a href="exploratory-data-analysis-and-modeling.html#cb143-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb143-21"><a href="exploratory-data-analysis-and-modeling.html#cb143-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb143-22"><a href="exploratory-data-analysis-and-modeling.html#cb143-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> starting, <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb143-23"><a href="exploratory-data-analysis-and-modeling.html#cb143-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Final Race Classification&#39;</span>,</span>
<span id="cb143-24"><a href="exploratory-data-analysis-and-modeling.html#cb143-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Probability&#39;</span>,</span>
<span id="cb143-25"><a href="exploratory-data-analysis-and-modeling.html#cb143-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="fu">expression</span>(Discrete<span class="sc">~</span>Probability<span class="sc">~</span>of<span class="sc">~</span>finishing<span class="sc">~</span>P[n]),</span>
<span id="cb143-26"><a href="exploratory-data-analysis-and-modeling.html#cb143-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;Saudi Arabian Grand Prix: 2021 - 2022&#39;</span>) <span class="sc">+</span></span>
<span id="cb143-27"><a href="exploratory-data-analysis-and-modeling.html#cb143-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb143-28"><a href="exploratory-data-analysis-and-modeling.html#cb143-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb143-29"><a href="exploratory-data-analysis-and-modeling.html#cb143-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>, <span class="dv">15</span>, <span class="dv">18</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>, <span class="dv">15</span>, <span class="dv">18</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-154-1.png" width="672" /></p>
<p>There are only two races to construct this model, so there’s tremendous variability in the estimated probabilities. That being said, we can still compare to a much slower street circuit like Monaco.</p>
</div>
<div id="monaco" class="section level3 hasAnchor" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> Monaco<a href="exploratory-data-analysis-and-modeling.html#monaco" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="exploratory-data-analysis-and-modeling.html#cb144-1" aria-hidden="true" tabindex="-1"></a>monaco_model <span class="ot">&lt;-</span> <span class="fu">vglm</span>(Position_race <span class="sc">~</span> Position_grid, </span>
<span id="cb144-2"><a href="exploratory-data-analysis-and-modeling.html#cb144-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> <span class="fu">cumulative</span>(<span class="at">parallel =</span> T, <span class="at">reverse =</span> F),</span>
<span id="cb144-3"><a href="exploratory-data-analysis-and-modeling.html#cb144-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> grids_and_races <span class="sc">%&gt;%</span></span>
<span id="cb144-4"><a href="exploratory-data-analysis-and-modeling.html#cb144-4" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">filter</span>(Race <span class="sc">==</span> <span class="st">&#39;monaco&#39;</span>))</span>
<span id="cb144-5"><a href="exploratory-data-analysis-and-modeling.html#cb144-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-6"><a href="exploratory-data-analysis-and-modeling.html#cb144-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(monaco_model)</span></code></pre></div>
<pre><code>## 
## Call:
## vglm(formula = Position_race ~ Position_grid, family = cumulative(parallel = T, 
##     reverse = F), data = grids_and_races %&gt;% filter(Race == &quot;monaco&quot;))
## 
## Coefficients: 
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept):1  -0.28789    0.42256  -0.681   0.4957    
## (Intercept):2   0.76160    0.35184   2.165   0.0304 *  
## (Intercept):3   1.56028    0.34291   4.550 5.36e-06 ***
## (Intercept):4   2.28028    0.35665   6.394 1.62e-10 ***
## (Intercept):5   2.93310    0.38156   7.687 1.50e-14 ***
## (Intercept):6   3.54044    0.41230   8.587  &lt; 2e-16 ***
## (Intercept):7   4.16225    0.44900   9.270  &lt; 2e-16 ***
## (Intercept):8   4.78580    0.48898   9.787  &lt; 2e-16 ***
## (Intercept):9   5.35326    0.52673  10.163  &lt; 2e-16 ***
## (Intercept):10  5.83811    0.55934  10.437  &lt; 2e-16 ***
## (Intercept):11  6.32467    0.59207  10.682  &lt; 2e-16 ***
## (Intercept):12  6.89611    0.63004  10.946  &lt; 2e-16 ***
## (Intercept):13  7.51153    0.66946  11.220  &lt; 2e-16 ***
## (Intercept):14  8.15972    0.70863  11.515  &lt; 2e-16 ***
## (Intercept):15  8.81674    0.74604  11.818  &lt; 2e-16 ***
## (Intercept):16  9.38034    0.77793  12.058  &lt; 2e-16 ***
## (Intercept):17 10.16416    0.82962  12.252  &lt; 2e-16 ***
## (Intercept):18 11.11774    0.93077  11.945  &lt; 2e-16 ***
## Position_grid  -0.47330    0.04255 -11.124  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Number of linear predictors:  18 
## 
## Residual deviance: 700.7868 on 2699 degrees of freedom
## 
## Log-likelihood: -350.3934 on 2699 degrees of freedom
## 
## Number of Fisher scoring iterations: 7 
## 
## Warning: Hauck-Donner effect detected in the following estimate(s):
## &#39;(Intercept):18&#39;
## 
## 
## Exponentiated coefficients:
## Position_grid 
##     0.6229455</code></pre>
<p>Make Predictions for the grid</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="exploratory-data-analysis-and-modeling.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Predictions for each Finishing position (1:20), using each Starting Position (1:20)</span></span>
<span id="cb146-2"><a href="exploratory-data-analysis-and-modeling.html#cb146-2" aria-hidden="true" tabindex="-1"></a>predictions_monaco <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">predictvglm</span>(monaco_model, <span class="at">newdata =</span> starting_grid, <span class="at">se.fit =</span> T)<span class="sc">$</span>fitted.values)</span>
<span id="cb146-3"><a href="exploratory-data-analysis-and-modeling.html#cb146-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-4"><a href="exploratory-data-analysis-and-modeling.html#cb146-4" aria-hidden="true" tabindex="-1"></a><span class="co"># rename the columns</span></span>
<span id="cb146-5"><a href="exploratory-data-analysis-and-modeling.html#cb146-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(predictions_monaco) <span class="ot">&lt;-</span> placing_df<span class="sc">$</span>prob[<span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>]</span>
<span id="cb146-6"><a href="exploratory-data-analysis-and-modeling.html#cb146-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-7"><a href="exploratory-data-analysis-and-modeling.html#cb146-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the standard error for each prediction</span></span>
<span id="cb146-8"><a href="exploratory-data-analysis-and-modeling.html#cb146-8" aria-hidden="true" tabindex="-1"></a>standard_errors_monaco <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">predictvglm</span>(monaco_model, <span class="at">newdata =</span> starting_grid, <span class="at">se.fit =</span> T)<span class="sc">$</span>se.fit)</span>
<span id="cb146-9"><a href="exploratory-data-analysis-and-modeling.html#cb146-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-10"><a href="exploratory-data-analysis-and-modeling.html#cb146-10" aria-hidden="true" tabindex="-1"></a><span class="co"># rename the standard error </span></span>
<span id="cb146-11"><a href="exploratory-data-analysis-and-modeling.html#cb146-11" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(standard_errors_monaco) <span class="ot">&lt;-</span> placing_df<span class="sc">$</span>se[<span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>]</span></code></pre></div>
<p>Now, I’ll the Probability(P1 finish | a starting grid) at Monaco:</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="exploratory-data-analysis-and-modeling.html#cb147-1" aria-hidden="true" tabindex="-1"></a>starting_grid <span class="sc">%&gt;%</span></span>
<span id="cb147-2"><a href="exploratory-data-analysis-and-modeling.html#cb147-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">pr_1 =</span> predictions_monaco<span class="sc">$</span>prob_1,</span>
<span id="cb147-3"><a href="exploratory-data-analysis-and-modeling.html#cb147-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">se_1 =</span> standard_errors_monaco<span class="sc">$</span>se_1) <span class="sc">%&gt;%</span></span>
<span id="cb147-4"><a href="exploratory-data-analysis-and-modeling.html#cb147-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pr =</span> <span class="fu">exp</span>(pr_1),</span>
<span id="cb147-5"><a href="exploratory-data-analysis-and-modeling.html#cb147-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower =</span> <span class="fu">exp</span>(pr_1 <span class="sc">-</span> se_1 <span class="sc">*</span> <span class="fl">1.96</span>),</span>
<span id="cb147-6"><a href="exploratory-data-analysis-and-modeling.html#cb147-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">upper =</span> <span class="fu">exp</span>(pr_1 <span class="sc">+</span> se_1 <span class="sc">*</span> <span class="fl">1.96</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb147-7"><a href="exploratory-data-analysis-and-modeling.html#cb147-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">pr =</span> pr <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> pr),</span>
<span id="cb147-8"><a href="exploratory-data-analysis-and-modeling.html#cb147-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">lower =</span> lower <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> lower),</span>
<span id="cb147-9"><a href="exploratory-data-analysis-and-modeling.html#cb147-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">upper =</span> upper <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> upper)) <span class="sc">%&gt;%</span></span>
<span id="cb147-10"><a href="exploratory-data-analysis-and-modeling.html#cb147-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Position_grid, <span class="at">y =</span> pr, <span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper)) <span class="sc">+</span></span>
<span id="cb147-11"><a href="exploratory-data-analysis-and-modeling.html#cb147-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>() <span class="sc">+</span></span>
<span id="cb147-12"><a href="exploratory-data-analysis-and-modeling.html#cb147-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb147-13"><a href="exploratory-data-analysis-and-modeling.html#cb147-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">y =</span> <span class="st">&#39;Probability of finishing P1&#39;</span>,</span>
<span id="cb147-14"><a href="exploratory-data-analysis-and-modeling.html#cb147-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">&#39;Starting Grid Position&#39;</span>,</span>
<span id="cb147-15"><a href="exploratory-data-analysis-and-modeling.html#cb147-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">&#39;Monaco&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-157-1.png" width="672" /></p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="exploratory-data-analysis-and-modeling.html#cb148-1" aria-hidden="true" tabindex="-1"></a>monaco_preds_se_full <span class="ot">&lt;-</span> predictions_monaco <span class="sc">%&gt;%</span></span>
<span id="cb148-2"><a href="exploratory-data-analysis-and-modeling.html#cb148-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">starting =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb148-3"><a href="exploratory-data-analysis-and-modeling.html#cb148-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span> starting, <span class="at">names_to =</span> <span class="st">&#39;placing&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;prob&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb148-4"><a href="exploratory-data-analysis-and-modeling.html#cb148-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(standard_errors_monaco <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">starting =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb148-5"><a href="exploratory-data-analysis-and-modeling.html#cb148-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span> starting, <span class="at">names_to =</span> <span class="st">&#39;placing&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;se&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb148-6"><a href="exploratory-data-analysis-and-modeling.html#cb148-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(se)) <span class="sc">%&gt;%</span></span>
<span id="cb148-7"><a href="exploratory-data-analysis-and-modeling.html#cb148-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">placing =</span> <span class="fu">as.numeric</span>(<span class="fu">str_remove</span>(placing, <span class="st">&#39;prob_&#39;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb148-8"><a href="exploratory-data-analysis-and-modeling.html#cb148-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> <span class="fu">exp</span>(prob)) <span class="sc">%&gt;%</span></span>
<span id="cb148-9"><a href="exploratory-data-analysis-and-modeling.html#cb148-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> prob <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> prob)) <span class="sc">%&gt;%</span></span>
<span id="cb148-10"><a href="exploratory-data-analysis-and-modeling.html#cb148-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(starting) <span class="sc">%&gt;%</span> </span>
<span id="cb148-11"><a href="exploratory-data-analysis-and-modeling.html#cb148-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">discrete_prob =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(prob <span class="sc">-</span> <span class="fu">lag</span>(prob)), prob, (prob <span class="sc">-</span> <span class="fu">lag</span>(prob)))) <span class="sc">%&gt;%</span></span>
<span id="cb148-12"><a href="exploratory-data-analysis-and-modeling.html#cb148-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div>
<p>Plot the discrete probability distributions.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="exploratory-data-analysis-and-modeling.html#cb149-1" aria-hidden="true" tabindex="-1"></a>monaco_preds_se_full <span class="sc">%&gt;%</span></span>
<span id="cb149-2"><a href="exploratory-data-analysis-and-modeling.html#cb149-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">starting_pos =</span> <span class="fu">as.factor</span>(<span class="fu">paste0</span>(<span class="st">&#39;P&#39;</span>,starting)),</span>
<span id="cb149-3"><a href="exploratory-data-analysis-and-modeling.html#cb149-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">starting_pos =</span> <span class="fu">fct_reorder</span>(starting_pos, starting)) <span class="sc">%&gt;%</span></span>
<span id="cb149-4"><a href="exploratory-data-analysis-and-modeling.html#cb149-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(placing, discrete_prob)) <span class="sc">+</span></span>
<span id="cb149-5"><a href="exploratory-data-analysis-and-modeling.html#cb149-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb149-6"><a href="exploratory-data-analysis-and-modeling.html#cb149-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> placing, <span class="at">xend =</span> placing, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> discrete_prob),</span>
<span id="cb149-7"><a href="exploratory-data-analysis-and-modeling.html#cb149-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb149-8"><a href="exploratory-data-analysis-and-modeling.html#cb149-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb149-9"><a href="exploratory-data-analysis-and-modeling.html#cb149-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> starting, <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb149-10"><a href="exploratory-data-analysis-and-modeling.html#cb149-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Final Race Classification&#39;</span>,</span>
<span id="cb149-11"><a href="exploratory-data-analysis-and-modeling.html#cb149-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Probability&#39;</span>,</span>
<span id="cb149-12"><a href="exploratory-data-analysis-and-modeling.html#cb149-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="fu">expression</span>(Discrete<span class="sc">~</span>Probability<span class="sc">~</span>of<span class="sc">~</span>finishing<span class="sc">~</span>P[n]),</span>
<span id="cb149-13"><a href="exploratory-data-analysis-and-modeling.html#cb149-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;Monaco Grand Prix: 2016 - 2022&#39;</span>) <span class="sc">+</span></span>
<span id="cb149-14"><a href="exploratory-data-analysis-and-modeling.html#cb149-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb149-15"><a href="exploratory-data-analysis-and-modeling.html#cb149-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-159-1.png" width="672" /></p>
<p>Let’s compare the fastest street circuit (Jeddah) to the slowest (Monaco).</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="exploratory-data-analysis-and-modeling.html#cb150-1" aria-hidden="true" tabindex="-1"></a>saudiarabia_preds_se_full <span class="sc">%&gt;%</span></span>
<span id="cb150-2"><a href="exploratory-data-analysis-and-modeling.html#cb150-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(starting, placing, discrete_prob) <span class="sc">%&gt;%</span></span>
<span id="cb150-3"><a href="exploratory-data-analysis-and-modeling.html#cb150-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(monaco_preds_se_full <span class="sc">%&gt;%</span></span>
<span id="cb150-4"><a href="exploratory-data-analysis-and-modeling.html#cb150-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(starting, placing, discrete_prob), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;starting&quot;</span>, <span class="st">&quot;placing&quot;</span>), <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">&quot;_saudiarabia&quot;</span>, <span class="st">&quot;_monaco&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb150-5"><a href="exploratory-data-analysis-and-modeling.html#cb150-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">starting_pos =</span> <span class="fu">as.factor</span>(<span class="fu">paste0</span>(<span class="st">&#39;P&#39;</span>,starting)),</span>
<span id="cb150-6"><a href="exploratory-data-analysis-and-modeling.html#cb150-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">starting_pos =</span> <span class="fu">fct_reorder</span>(starting_pos, starting),</span>
<span id="cb150-7"><a href="exploratory-data-analysis-and-modeling.html#cb150-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">delta =</span> <span class="fu">ifelse</span>(discrete_prob_monaco <span class="sc">&gt;</span> discrete_prob_saudiarabia, <span class="st">&#39;monaco&#39;</span>, <span class="st">&#39;saudiarabia&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb150-8"><a href="exploratory-data-analysis-and-modeling.html#cb150-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(starting_pos <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;P1&#39;</span>, <span class="st">&#39;P2&#39;</span>, <span class="st">&#39;P3&#39;</span>, <span class="st">&#39;P4&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb150-9"><a href="exploratory-data-analysis-and-modeling.html#cb150-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb150-10"><a href="exploratory-data-analysis-and-modeling.html#cb150-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> placing, <span class="at">xend =</span> placing, <span class="at">y =</span> discrete_prob_saudiarabia, <span class="at">yend =</span> discrete_prob_monaco, <span class="at">col =</span> delta),</span>
<span id="cb150-11"><a href="exploratory-data-analysis-and-modeling.html#cb150-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb150-12"><a href="exploratory-data-analysis-and-modeling.html#cb150-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>, <span class="fu">aes</span>(placing, discrete_prob_saudiarabia, <span class="at">fill =</span> <span class="st">&#39;Saudi Arabia&#39;</span>), <span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb150-13"><a href="exploratory-data-analysis-and-modeling.html#cb150-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>, <span class="fu">aes</span>(placing, discrete_prob_monaco, <span class="at">fill =</span> <span class="st">&#39;Monaco&#39;</span>), <span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb150-14"><a href="exploratory-data-analysis-and-modeling.html#cb150-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">&quot;&quot;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;Saudi Arabia&#39;</span> <span class="ot">=</span> <span class="st">&#39;green&#39;</span>, <span class="st">&#39;Monaco&#39;</span> <span class="ot">=</span> <span class="st">&#39;red&#39;</span>)) <span class="sc">+</span></span>
<span id="cb150-15"><a href="exploratory-data-analysis-and-modeling.html#cb150-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">&quot;&quot;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;Saudi Arabia&#39;</span> <span class="ot">=</span> <span class="st">&#39;green&#39;</span>, <span class="st">&#39;Monaco&#39;</span> <span class="ot">=</span> <span class="st">&#39;red&#39;</span>)) <span class="sc">+</span></span>
<span id="cb150-16"><a href="exploratory-data-analysis-and-modeling.html#cb150-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb150-17"><a href="exploratory-data-analysis-and-modeling.html#cb150-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> starting, <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb150-18"><a href="exploratory-data-analysis-and-modeling.html#cb150-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Final Race Classification&#39;</span>,</span>
<span id="cb150-19"><a href="exploratory-data-analysis-and-modeling.html#cb150-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Probability&#39;</span>,</span>
<span id="cb150-20"><a href="exploratory-data-analysis-and-modeling.html#cb150-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="fu">expression</span>(Discrete<span class="sc">~</span>Probability<span class="sc">~</span>of<span class="sc">~</span>finishing<span class="sc">~</span>P[n]),</span>
<span id="cb150-21"><a href="exploratory-data-analysis-and-modeling.html#cb150-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;Saudia Arabia (2021 - 2022) vs Monaco (2016 - 2022)&#39;</span>) <span class="sc">+</span></span>
<span id="cb150-22"><a href="exploratory-data-analysis-and-modeling.html#cb150-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb150-23"><a href="exploratory-data-analysis-and-modeling.html#cb150-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-160-1.png" width="672" /></p>
<p>So, nothing too interesting for the first 2 rows of the starting grid. Is it statistically easier to win in Jeddah from further down the grid?</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="exploratory-data-analysis-and-modeling.html#cb151-1" aria-hidden="true" tabindex="-1"></a>saudiarabia_preds_se_full <span class="sc">%&gt;%</span></span>
<span id="cb151-2"><a href="exploratory-data-analysis-and-modeling.html#cb151-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(starting, placing, discrete_prob) <span class="sc">%&gt;%</span></span>
<span id="cb151-3"><a href="exploratory-data-analysis-and-modeling.html#cb151-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(monaco_preds_se_full <span class="sc">%&gt;%</span></span>
<span id="cb151-4"><a href="exploratory-data-analysis-and-modeling.html#cb151-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(starting, placing, discrete_prob), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;starting&quot;</span>, <span class="st">&quot;placing&quot;</span>), <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">&quot;_saudiarabia&quot;</span>, <span class="st">&quot;_monaco&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb151-5"><a href="exploratory-data-analysis-and-modeling.html#cb151-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">starting_pos =</span> <span class="fu">as.factor</span>(<span class="fu">paste0</span>(<span class="st">&#39;P&#39;</span>,starting)),</span>
<span id="cb151-6"><a href="exploratory-data-analysis-and-modeling.html#cb151-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">starting_pos =</span> <span class="fu">fct_reorder</span>(starting_pos, starting),</span>
<span id="cb151-7"><a href="exploratory-data-analysis-and-modeling.html#cb151-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">delta =</span> <span class="fu">ifelse</span>(discrete_prob_monaco <span class="sc">&gt;</span> discrete_prob_saudiarabia, <span class="st">&#39;monaco&#39;</span>, <span class="st">&#39;saudiarabia&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb151-8"><a href="exploratory-data-analysis-and-modeling.html#cb151-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(placing <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb151-9"><a href="exploratory-data-analysis-and-modeling.html#cb151-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb151-10"><a href="exploratory-data-analysis-and-modeling.html#cb151-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> starting, <span class="at">xend =</span> starting, <span class="at">y =</span> discrete_prob_saudiarabia, <span class="at">yend =</span> discrete_prob_monaco, <span class="at">col =</span> delta),</span>
<span id="cb151-11"><a href="exploratory-data-analysis-and-modeling.html#cb151-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb151-12"><a href="exploratory-data-analysis-and-modeling.html#cb151-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>, <span class="fu">aes</span>(starting, discrete_prob_saudiarabia), <span class="at">fill =</span> <span class="st">&#39;green&#39;</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb151-13"><a href="exploratory-data-analysis-and-modeling.html#cb151-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>, <span class="fu">aes</span>(starting, discrete_prob_monaco), <span class="at">fill =</span> <span class="st">&#39;red&#39;</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb151-14"><a href="exploratory-data-analysis-and-modeling.html#cb151-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb151-15"><a href="exploratory-data-analysis-and-modeling.html#cb151-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">&quot;&quot;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;Saudi Arabia&#39;</span> <span class="ot">=</span> <span class="st">&#39;green&#39;</span>, <span class="st">&#39;Monaco&#39;</span> <span class="ot">=</span> <span class="st">&#39;red&#39;</span>)) <span class="sc">+</span></span>
<span id="cb151-16"><a href="exploratory-data-analysis-and-modeling.html#cb151-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Final Race Classification&#39;</span>,</span>
<span id="cb151-17"><a href="exploratory-data-analysis-and-modeling.html#cb151-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Probability&#39;</span>,</span>
<span id="cb151-18"><a href="exploratory-data-analysis-and-modeling.html#cb151-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="fu">expression</span>(Discrete<span class="sc">~</span>Probability<span class="sc">~</span>of<span class="sc">~</span>finishing<span class="sc">~</span>P[<span class="dv">1</span>]),</span>
<span id="cb151-19"><a href="exploratory-data-analysis-and-modeling.html#cb151-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;Saudi Arabia (2021 - 2022) vs Monaco (2016 - 2022)&#39;</span>) <span class="sc">+</span></span>
<span id="cb151-20"><a href="exploratory-data-analysis-and-modeling.html#cb151-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb151-21"><a href="exploratory-data-analysis-and-modeling.html#cb151-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-161-1.png" width="672" /></p>
<p>Maybe slightly. It looks like there is just a much stronger advantage to starting at the front of the grid in Monaco.</p>
</div>
<div id="brazil" class="section level3 hasAnchor" number="6.2.4">
<h3><span class="header-section-number">6.2.4</span> Brazil<a href="exploratory-data-analysis-and-modeling.html#brazil" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Sao Paulo Grand Prix is perhaps the easiest circuit to overtake on. Let’s compare the model predictions and probabilities for Brazil to those of Monaco.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="exploratory-data-analysis-and-modeling.html#cb152-1" aria-hidden="true" tabindex="-1"></a>brazil_model <span class="ot">&lt;-</span> <span class="fu">vglm</span>(Position_race <span class="sc">~</span> Position_grid, </span>
<span id="cb152-2"><a href="exploratory-data-analysis-and-modeling.html#cb152-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> <span class="fu">cumulative</span>(<span class="at">parallel =</span> T, <span class="at">reverse =</span> F),</span>
<span id="cb152-3"><a href="exploratory-data-analysis-and-modeling.html#cb152-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> grids_and_races <span class="sc">%&gt;%</span></span>
<span id="cb152-4"><a href="exploratory-data-analysis-and-modeling.html#cb152-4" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">filter</span>(Race <span class="sc">==</span> <span class="st">&#39;brazil&#39;</span>))</span>
<span id="cb152-5"><a href="exploratory-data-analysis-and-modeling.html#cb152-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-6"><a href="exploratory-data-analysis-and-modeling.html#cb152-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(brazil_model)</span></code></pre></div>
<pre><code>## 
## Call:
## vglm(formula = Position_race ~ Position_grid, family = cumulative(parallel = T, 
##     reverse = F), data = grids_and_races %&gt;% filter(Race == &quot;brazil&quot;))
## 
## Coefficients: 
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept):1  -0.73953    0.45966  -1.609 0.107645    
## (Intercept):2   0.24697    0.37789   0.654 0.513401    
## (Intercept):3   0.92998    0.36331   2.560 0.010476 *  
## (Intercept):4   1.39449    0.36752   3.794 0.000148 ***
## (Intercept):5   1.87117    0.38103   4.911 9.07e-07 ***
## (Intercept):6   2.31922    0.40025   5.794 6.85e-09 ***
## (Intercept):7   2.74110    0.42263   6.486 8.83e-11 ***
## (Intercept):8   3.16937    0.44836   7.069 1.56e-12 ***
## (Intercept):9   3.59978    0.47607   7.561 3.99e-14 ***
## (Intercept):10  4.02870    0.50443   7.987 1.39e-15 ***
## (Intercept):11  4.45699    0.53261   8.368  &lt; 2e-16 ***
## (Intercept):12  4.86320    0.55869   8.705  &lt; 2e-16 ***
## (Intercept):13  5.28447    0.58499   9.033  &lt; 2e-16 ***
## (Intercept):14  5.78672    0.61592   9.395  &lt; 2e-16 ***
## (Intercept):15  6.29784    0.64839   9.713  &lt; 2e-16 ***
## (Intercept):16  6.97457    0.69829   9.988  &lt; 2e-16 ***
## (Intercept):17  7.75148    0.78010   9.936  &lt; 2e-16 ***
## (Intercept):18  9.20953    1.11599   8.252  &lt; 2e-16 ***
## Position_grid  -0.31650    0.03799  -8.330  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Number of linear predictors:  18 
## 
## Residual deviance: 594.0966 on 2087 degrees of freedom
## 
## Log-likelihood: -297.0483 on 2087 degrees of freedom
## 
## Number of Fisher scoring iterations: 6 
## 
## Warning: Hauck-Donner effect detected in the following estimate(s):
## &#39;(Intercept):17&#39;, &#39;(Intercept):18&#39;
## 
## 
## Exponentiated coefficients:
## Position_grid 
##      0.728696</code></pre>
<p>Make Predictions for the grid</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="exploratory-data-analysis-and-modeling.html#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Predictions for each Finishing position (1:20), using each Starting Position (1:20)</span></span>
<span id="cb154-2"><a href="exploratory-data-analysis-and-modeling.html#cb154-2" aria-hidden="true" tabindex="-1"></a>predictions_brazil<span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">predictvglm</span>(brazil_model, <span class="at">newdata =</span> starting_grid, <span class="at">se.fit =</span> T)<span class="sc">$</span>fitted.values)</span>
<span id="cb154-3"><a href="exploratory-data-analysis-and-modeling.html#cb154-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-4"><a href="exploratory-data-analysis-and-modeling.html#cb154-4" aria-hidden="true" tabindex="-1"></a><span class="co"># rename the columns</span></span>
<span id="cb154-5"><a href="exploratory-data-analysis-and-modeling.html#cb154-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(predictions_brazil) <span class="ot">&lt;-</span> placing_df<span class="sc">$</span>prob[<span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>]</span>
<span id="cb154-6"><a href="exploratory-data-analysis-and-modeling.html#cb154-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-7"><a href="exploratory-data-analysis-and-modeling.html#cb154-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the standard error for each prediction</span></span>
<span id="cb154-8"><a href="exploratory-data-analysis-and-modeling.html#cb154-8" aria-hidden="true" tabindex="-1"></a>standard_errors_brazil <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">predictvglm</span>(brazil_model, <span class="at">newdata =</span> starting_grid, <span class="at">se.fit =</span> T)<span class="sc">$</span>se.fit)</span>
<span id="cb154-9"><a href="exploratory-data-analysis-and-modeling.html#cb154-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-10"><a href="exploratory-data-analysis-and-modeling.html#cb154-10" aria-hidden="true" tabindex="-1"></a><span class="co"># rename the standard error </span></span>
<span id="cb154-11"><a href="exploratory-data-analysis-and-modeling.html#cb154-11" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(standard_errors_brazil) <span class="ot">&lt;-</span> placing_df<span class="sc">$</span>se[<span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>]</span></code></pre></div>
<p>Now, I’ll the Probability(P1 finish | a starting grid) at Monaco:</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="exploratory-data-analysis-and-modeling.html#cb155-1" aria-hidden="true" tabindex="-1"></a>starting_grid <span class="sc">%&gt;%</span></span>
<span id="cb155-2"><a href="exploratory-data-analysis-and-modeling.html#cb155-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">pr_1 =</span> predictions_brazil<span class="sc">$</span>prob_1,</span>
<span id="cb155-3"><a href="exploratory-data-analysis-and-modeling.html#cb155-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">se_1 =</span> standard_errors_brazil<span class="sc">$</span>se_1) <span class="sc">%&gt;%</span></span>
<span id="cb155-4"><a href="exploratory-data-analysis-and-modeling.html#cb155-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pr =</span> <span class="fu">exp</span>(pr_1),</span>
<span id="cb155-5"><a href="exploratory-data-analysis-and-modeling.html#cb155-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower =</span> <span class="fu">exp</span>(pr_1 <span class="sc">-</span> se_1 <span class="sc">*</span> <span class="fl">1.96</span>),</span>
<span id="cb155-6"><a href="exploratory-data-analysis-and-modeling.html#cb155-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">upper =</span> <span class="fu">exp</span>(pr_1 <span class="sc">+</span> se_1 <span class="sc">*</span> <span class="fl">1.96</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb155-7"><a href="exploratory-data-analysis-and-modeling.html#cb155-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">pr =</span> pr <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> pr),</span>
<span id="cb155-8"><a href="exploratory-data-analysis-and-modeling.html#cb155-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">lower =</span> lower <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> lower),</span>
<span id="cb155-9"><a href="exploratory-data-analysis-and-modeling.html#cb155-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">upper =</span> upper <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> upper)) <span class="sc">%&gt;%</span></span>
<span id="cb155-10"><a href="exploratory-data-analysis-and-modeling.html#cb155-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Position_grid, <span class="at">y =</span> pr, <span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper)) <span class="sc">+</span></span>
<span id="cb155-11"><a href="exploratory-data-analysis-and-modeling.html#cb155-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>() <span class="sc">+</span></span>
<span id="cb155-12"><a href="exploratory-data-analysis-and-modeling.html#cb155-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb155-13"><a href="exploratory-data-analysis-and-modeling.html#cb155-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( <span class="at">y =</span> <span class="st">&#39;Probability of finishing P1&#39;</span>,</span>
<span id="cb155-14"><a href="exploratory-data-analysis-and-modeling.html#cb155-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">&#39;Starting Grid Position&#39;</span>,</span>
<span id="cb155-15"><a href="exploratory-data-analysis-and-modeling.html#cb155-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">&#39;Brazil&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-164-1.png" width="672" /></p>
<p>Plot the discrete probability distributions.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="exploratory-data-analysis-and-modeling.html#cb156-1" aria-hidden="true" tabindex="-1"></a>brazil_preds_se_full <span class="ot">&lt;-</span> predictions_brazil <span class="sc">%&gt;%</span></span>
<span id="cb156-2"><a href="exploratory-data-analysis-and-modeling.html#cb156-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">starting =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb156-3"><a href="exploratory-data-analysis-and-modeling.html#cb156-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span> starting, <span class="at">names_to =</span> <span class="st">&#39;placing&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;prob&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb156-4"><a href="exploratory-data-analysis-and-modeling.html#cb156-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(standard_errors_brazil <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">starting =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb156-5"><a href="exploratory-data-analysis-and-modeling.html#cb156-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span> starting, <span class="at">names_to =</span> <span class="st">&#39;placing&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;se&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb156-6"><a href="exploratory-data-analysis-and-modeling.html#cb156-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(se)) <span class="sc">%&gt;%</span></span>
<span id="cb156-7"><a href="exploratory-data-analysis-and-modeling.html#cb156-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">placing =</span> <span class="fu">as.numeric</span>(<span class="fu">str_remove</span>(placing, <span class="st">&#39;prob_&#39;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb156-8"><a href="exploratory-data-analysis-and-modeling.html#cb156-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> <span class="fu">exp</span>(prob)) <span class="sc">%&gt;%</span></span>
<span id="cb156-9"><a href="exploratory-data-analysis-and-modeling.html#cb156-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> prob <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> prob)) <span class="sc">%&gt;%</span></span>
<span id="cb156-10"><a href="exploratory-data-analysis-and-modeling.html#cb156-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(starting) <span class="sc">%&gt;%</span> </span>
<span id="cb156-11"><a href="exploratory-data-analysis-and-modeling.html#cb156-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">discrete_prob =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(prob <span class="sc">-</span> <span class="fu">lag</span>(prob)), prob, (prob <span class="sc">-</span> <span class="fu">lag</span>(prob)))) <span class="sc">%&gt;%</span></span>
<span id="cb156-12"><a href="exploratory-data-analysis-and-modeling.html#cb156-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb156-13"><a href="exploratory-data-analysis-and-modeling.html#cb156-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-14"><a href="exploratory-data-analysis-and-modeling.html#cb156-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-15"><a href="exploratory-data-analysis-and-modeling.html#cb156-15" aria-hidden="true" tabindex="-1"></a>brazil_preds_se_full <span class="sc">%&gt;%</span></span>
<span id="cb156-16"><a href="exploratory-data-analysis-and-modeling.html#cb156-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">starting_pos =</span> <span class="fu">as.factor</span>(<span class="fu">paste0</span>(<span class="st">&#39;P&#39;</span>,starting)),</span>
<span id="cb156-17"><a href="exploratory-data-analysis-and-modeling.html#cb156-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">starting_pos =</span> <span class="fu">fct_reorder</span>(starting_pos, starting)) <span class="sc">%&gt;%</span></span>
<span id="cb156-18"><a href="exploratory-data-analysis-and-modeling.html#cb156-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(placing, discrete_prob)) <span class="sc">+</span></span>
<span id="cb156-19"><a href="exploratory-data-analysis-and-modeling.html#cb156-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> placing, <span class="at">xend =</span> placing, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> discrete_prob),</span>
<span id="cb156-20"><a href="exploratory-data-analysis-and-modeling.html#cb156-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">col =</span> <span class="st">&#39;green&#39;</span>) <span class="sc">+</span></span>
<span id="cb156-21"><a href="exploratory-data-analysis-and-modeling.html#cb156-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb156-22"><a href="exploratory-data-analysis-and-modeling.html#cb156-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb156-23"><a href="exploratory-data-analysis-and-modeling.html#cb156-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> starting, <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb156-24"><a href="exploratory-data-analysis-and-modeling.html#cb156-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Final Race Classification&#39;</span>,</span>
<span id="cb156-25"><a href="exploratory-data-analysis-and-modeling.html#cb156-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Probability&#39;</span>,</span>
<span id="cb156-26"><a href="exploratory-data-analysis-and-modeling.html#cb156-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="fu">expression</span>(Discrete<span class="sc">~</span>Probability<span class="sc">~</span>of<span class="sc">~</span>finishing<span class="sc">~</span>P[n]),</span>
<span id="cb156-27"><a href="exploratory-data-analysis-and-modeling.html#cb156-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;Sao Paulo Grand Prix: 2016 - 2022&#39;</span>) <span class="sc">+</span></span>
<span id="cb156-28"><a href="exploratory-data-analysis-and-modeling.html#cb156-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb156-29"><a href="exploratory-data-analysis-and-modeling.html#cb156-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-165-1.png" width="672" /></p>
<p>How does Brazil and Monaco compare?</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="exploratory-data-analysis-and-modeling.html#cb157-1" aria-hidden="true" tabindex="-1"></a>brazil_preds_se_full <span class="sc">%&gt;%</span></span>
<span id="cb157-2"><a href="exploratory-data-analysis-and-modeling.html#cb157-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(starting, placing, discrete_prob) <span class="sc">%&gt;%</span></span>
<span id="cb157-3"><a href="exploratory-data-analysis-and-modeling.html#cb157-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(monaco_preds_se_full <span class="sc">%&gt;%</span></span>
<span id="cb157-4"><a href="exploratory-data-analysis-and-modeling.html#cb157-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(starting, placing, discrete_prob), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;starting&quot;</span>, <span class="st">&quot;placing&quot;</span>), <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">&quot;_brazil&quot;</span>, <span class="st">&quot;_monaco&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb157-5"><a href="exploratory-data-analysis-and-modeling.html#cb157-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">starting_pos =</span> <span class="fu">as.factor</span>(<span class="fu">paste0</span>(<span class="st">&#39;P&#39;</span>,starting)),</span>
<span id="cb157-6"><a href="exploratory-data-analysis-and-modeling.html#cb157-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">starting_pos =</span> <span class="fu">fct_reorder</span>(starting_pos, starting),</span>
<span id="cb157-7"><a href="exploratory-data-analysis-and-modeling.html#cb157-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">delta =</span> <span class="fu">ifelse</span>(discrete_prob_monaco <span class="sc">&gt;</span> discrete_prob_brazil, <span class="st">&#39;monaco&#39;</span>, <span class="st">&#39;brazil&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb157-8"><a href="exploratory-data-analysis-and-modeling.html#cb157-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(starting_pos <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;P1&#39;</span>, <span class="st">&#39;P2&#39;</span>, <span class="st">&#39;P3&#39;</span>, <span class="st">&#39;P4&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb157-9"><a href="exploratory-data-analysis-and-modeling.html#cb157-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb157-10"><a href="exploratory-data-analysis-and-modeling.html#cb157-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> placing, <span class="at">xend =</span> placing, <span class="at">y =</span> discrete_prob_brazil, <span class="at">yend =</span> discrete_prob_monaco, <span class="at">col =</span> delta),</span>
<span id="cb157-11"><a href="exploratory-data-analysis-and-modeling.html#cb157-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb157-12"><a href="exploratory-data-analysis-and-modeling.html#cb157-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>, <span class="fu">aes</span>(placing, discrete_prob_brazil, <span class="at">fill =</span> <span class="st">&#39;Brazil&#39;</span>), <span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb157-13"><a href="exploratory-data-analysis-and-modeling.html#cb157-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>, <span class="fu">aes</span>(placing, discrete_prob_monaco, <span class="at">fill =</span> <span class="st">&#39;Monaco&#39;</span>), <span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb157-14"><a href="exploratory-data-analysis-and-modeling.html#cb157-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">&quot;&quot;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;Brazil&#39;</span> <span class="ot">=</span> <span class="st">&#39;green&#39;</span>, <span class="st">&#39;Monaco&#39;</span> <span class="ot">=</span> <span class="st">&#39;red&#39;</span>)) <span class="sc">+</span></span>
<span id="cb157-15"><a href="exploratory-data-analysis-and-modeling.html#cb157-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="st">&quot;&quot;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;Brazil&#39;</span> <span class="ot">=</span> <span class="st">&#39;green&#39;</span>, <span class="st">&#39;Monaco&#39;</span> <span class="ot">=</span> <span class="st">&#39;red&#39;</span>)) <span class="sc">+</span></span>
<span id="cb157-16"><a href="exploratory-data-analysis-and-modeling.html#cb157-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb157-17"><a href="exploratory-data-analysis-and-modeling.html#cb157-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> starting, <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb157-18"><a href="exploratory-data-analysis-and-modeling.html#cb157-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Final Race Classification&#39;</span>,</span>
<span id="cb157-19"><a href="exploratory-data-analysis-and-modeling.html#cb157-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Probability&#39;</span>,</span>
<span id="cb157-20"><a href="exploratory-data-analysis-and-modeling.html#cb157-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="fu">expression</span>(Discrete<span class="sc">~</span>Probability<span class="sc">~</span>of<span class="sc">~</span>finishing<span class="sc">~</span>P[n]),</span>
<span id="cb157-21"><a href="exploratory-data-analysis-and-modeling.html#cb157-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;Sao Paulo vs Monaco: 2016 - 2022&#39;</span>) <span class="sc">+</span></span>
<span id="cb157-22"><a href="exploratory-data-analysis-and-modeling.html#cb157-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb157-23"><a href="exploratory-data-analysis-and-modeling.html#cb157-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-166-1.png" width="672" /></p>
<p>Or, let’s compare the probability of finishing P1 given any starting grid position?</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="exploratory-data-analysis-and-modeling.html#cb158-1" aria-hidden="true" tabindex="-1"></a>brazil_preds_se_full <span class="sc">%&gt;%</span></span>
<span id="cb158-2"><a href="exploratory-data-analysis-and-modeling.html#cb158-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(starting, placing, discrete_prob) <span class="sc">%&gt;%</span></span>
<span id="cb158-3"><a href="exploratory-data-analysis-and-modeling.html#cb158-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(monaco_preds_se_full <span class="sc">%&gt;%</span></span>
<span id="cb158-4"><a href="exploratory-data-analysis-and-modeling.html#cb158-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(starting, placing, discrete_prob), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;starting&quot;</span>, <span class="st">&quot;placing&quot;</span>), <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">&quot;_brazil&quot;</span>, <span class="st">&quot;_monaco&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb158-5"><a href="exploratory-data-analysis-and-modeling.html#cb158-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">starting_pos =</span> <span class="fu">as.factor</span>(<span class="fu">paste0</span>(<span class="st">&#39;P&#39;</span>,starting)),</span>
<span id="cb158-6"><a href="exploratory-data-analysis-and-modeling.html#cb158-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">starting_pos =</span> <span class="fu">fct_reorder</span>(starting_pos, starting),</span>
<span id="cb158-7"><a href="exploratory-data-analysis-and-modeling.html#cb158-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">delta =</span> <span class="fu">ifelse</span>(discrete_prob_monaco <span class="sc">&gt;</span> discrete_prob_brazil, <span class="st">&#39;monaco&#39;</span>, <span class="st">&#39;brazil&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb158-8"><a href="exploratory-data-analysis-and-modeling.html#cb158-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(placing <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb158-9"><a href="exploratory-data-analysis-and-modeling.html#cb158-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb158-10"><a href="exploratory-data-analysis-and-modeling.html#cb158-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> starting, <span class="at">xend =</span> starting, <span class="at">y =</span> discrete_prob_brazil, <span class="at">yend =</span> discrete_prob_monaco, <span class="at">col =</span> delta),</span>
<span id="cb158-11"><a href="exploratory-data-analysis-and-modeling.html#cb158-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb158-12"><a href="exploratory-data-analysis-and-modeling.html#cb158-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>, <span class="fu">aes</span>(starting, discrete_prob_brazil), <span class="at">fill =</span> <span class="st">&#39;green&#39;</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb158-13"><a href="exploratory-data-analysis-and-modeling.html#cb158-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>, <span class="fu">aes</span>(starting, discrete_prob_monaco), <span class="at">fill =</span> <span class="st">&#39;red&#39;</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb158-14"><a href="exploratory-data-analysis-and-modeling.html#cb158-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb158-15"><a href="exploratory-data-analysis-and-modeling.html#cb158-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">&quot;&quot;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;Brazil&#39;</span> <span class="ot">=</span> <span class="st">&#39;green&#39;</span>, <span class="st">&#39;Monaco&#39;</span> <span class="ot">=</span> <span class="st">&#39;red&#39;</span>)) <span class="sc">+</span></span>
<span id="cb158-16"><a href="exploratory-data-analysis-and-modeling.html#cb158-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Starting Position&#39;</span>,</span>
<span id="cb158-17"><a href="exploratory-data-analysis-and-modeling.html#cb158-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Probability&#39;</span>,</span>
<span id="cb158-18"><a href="exploratory-data-analysis-and-modeling.html#cb158-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="fu">expression</span>(Discrete<span class="sc">~</span>Probability<span class="sc">~</span>of<span class="sc">~</span>finishing<span class="sc">~</span>P[<span class="dv">1</span>]),</span>
<span id="cb158-19"><a href="exploratory-data-analysis-and-modeling.html#cb158-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;Sao Paulo vs Monaco: 2016 - 2022&#39;</span>) <span class="sc">+</span></span>
<span id="cb158-20"><a href="exploratory-data-analysis-and-modeling.html#cb158-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb158-21"><a href="exploratory-data-analysis-and-modeling.html#cb158-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-167-1.png" width="672" /></p>
<p>There’s a distinct advantage in starting the Monaco Grand Prix from the front row, in terms of a driver’s probability of winning the race. A driver has a higher likelihood of winning from any other row on the gird of the Sao Paulo Grand Prix.</p>
<p>Stated plainly… Qualifying on the front row in Monaco is very important! In Sao Paulo, a driver can make up positions.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="drivers.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="dnf-did-not-finish.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/05-races.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
