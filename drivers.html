<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Drivers | Visualizing Formula 1 Data in R</title>
  <meta name="description" content="This is a book documenting data visualizations of Formula 1 data." />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Drivers | Visualizing Formula 1 Data in R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/F1_book_cover.PNG" />
  <meta property="og:description" content="This is a book documenting data visualizations of Formula 1 data." />
  <meta name="github-repo" content="casanscott/vizf1book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Drivers | Visualizing Formula 1 Data in R" />
  
  <meta name="twitter:description" content="This is a book documenting data visualizations of Formula 1 data." />
  <meta name="twitter:image" content="/F1_book_cover.PNG" />

<meta name="author" content="Casan Scott, Ph.D." />


<meta name="date" content="2024-02-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="modeling-practice-and-qualifying-times.html"/>
<link rel="next" href="modeling-race-results.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Visualizing Formula 1 Data in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About the book</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#cover-art"><i class="fa fa-check"></i><b>1.1</b> Cover Art</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#about-me"><i class="fa fa-check"></i><b>1.2</b> About me</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#why-did-i-write-this-book"><i class="fa fa-check"></i><b>1.3</b> Why did I write this book?</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#organization-of-this-book"><i class="fa fa-check"></i><b>1.4</b> Organization of this book</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#r"><i class="fa fa-check"></i><b>1.5</b> R</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#ggplot2"><i class="fa fa-check"></i><b>1.6</b> ggplot2</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#the-tidyverse"><i class="fa fa-check"></i><b>1.7</b> The <em>tidyverse</em></a></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#data"><i class="fa fa-check"></i><b>1.8</b> Data</a></li>
<li class="chapter" data-level="1.9" data-path="index.html"><a href="index.html#data-visualization"><i class="fa fa-check"></i><b>1.9</b> Data Visualization</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-formula-1.html"><a href="introduction-to-formula-1.html"><i class="fa fa-check"></i><b>2</b> Introduction to Formula 1</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-formula-1.html"><a href="introduction-to-formula-1.html#data-1"><i class="fa fa-check"></i><b>2.1</b> Data</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-formula-1.html"><a href="introduction-to-formula-1.html#a-formula-1-weekend"><i class="fa fa-check"></i><b>2.2</b> A Formula 1 Weekend</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-formula-1.html"><a href="introduction-to-formula-1.html#practice-sessions"><i class="fa fa-check"></i><b>2.3</b> Practice Sessions</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-formula-1.html"><a href="introduction-to-formula-1.html#practice-times-by-driver"><i class="fa fa-check"></i><b>2.4</b> Practice Times by Driver</a></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-formula-1.html"><a href="introduction-to-formula-1.html#next-chapter"><i class="fa fa-check"></i><b>2.5</b> Next Chapter</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="qualifying.html"><a href="qualifying.html"><i class="fa fa-check"></i><b>3</b> Qualifying</a>
<ul>
<li class="chapter" data-level="3.1" data-path="qualifying.html"><a href="qualifying.html#distribution-of-qualifying-times-by-session"><i class="fa fa-check"></i><b>3.1</b> Distribution of Qualifying Times by Session</a></li>
<li class="chapter" data-level="3.2" data-path="qualifying.html"><a href="qualifying.html#distribution-of-qualifying-times-by-year"><i class="fa fa-check"></i><b>3.2</b> Distribution of Qualifying Times by Year</a></li>
<li class="chapter" data-level="3.3" data-path="qualifying.html"><a href="qualifying.html#qualifying-times-by-grand-prix"><i class="fa fa-check"></i><b>3.3</b> Qualifying Times by Grand Prix</a></li>
<li class="chapter" data-level="3.4" data-path="qualifying.html"><a href="qualifying.html#car-progression-over-time"><i class="fa fa-check"></i><b>3.4</b> Car Progression Over Time</a></li>
<li class="chapter" data-level="3.5" data-path="qualifying.html"><a href="qualifying.html#next-chapter-1"><i class="fa fa-check"></i><b>3.5</b> Next Chapter</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="modeling-practice-and-qualifying-times.html"><a href="modeling-practice-and-qualifying-times.html"><i class="fa fa-check"></i><b>4</b> Modeling Practice and Qualifying Times</a>
<ul>
<li class="chapter" data-level="4.1" data-path="modeling-practice-and-qualifying-times.html"><a href="modeling-practice-and-qualifying-times.html#models"><i class="fa fa-check"></i><b>4.1</b> Models</a></li>
<li class="chapter" data-level="4.2" data-path="modeling-practice-and-qualifying-times.html"><a href="modeling-practice-and-qualifying-times.html#simple-linear-regression-model-practice-vs-qualifying-times"><i class="fa fa-check"></i><b>4.2</b> Simple Linear Regression Model: Practice vs Qualifying Times</a></li>
<li class="chapter" data-level="4.3" data-path="modeling-practice-and-qualifying-times.html"><a href="modeling-practice-and-qualifying-times.html#simple-linear-regression-model-qualifying-time-vs-year"><i class="fa fa-check"></i><b>4.3</b> Simple Linear Regression Model: Qualifying time vs Year</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="modeling-practice-and-qualifying-times.html"><a href="modeling-practice-and-qualifying-times.html#uncertainty-in-model-estimates"><i class="fa fa-check"></i><b>4.3.1</b> Uncertainty in model estimates</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="modeling-practice-and-qualifying-times.html"><a href="modeling-practice-and-qualifying-times.html#interaction-model"><i class="fa fa-check"></i><b>4.4</b> Interaction Model</a></li>
<li class="chapter" data-level="4.5" data-path="modeling-practice-and-qualifying-times.html"><a href="modeling-practice-and-qualifying-times.html#next-chapter-2"><i class="fa fa-check"></i><b>4.5</b> Next Chapter</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="drivers.html"><a href="drivers.html"><i class="fa fa-check"></i><b>5</b> Drivers</a>
<ul>
<li class="chapter" data-level="5.1" data-path="drivers.html"><a href="drivers.html#race-performance"><i class="fa fa-check"></i><b>5.1</b> Race Performance</a></li>
<li class="chapter" data-level="5.2" data-path="drivers.html"><a href="drivers.html#qualifying-pace"><i class="fa fa-check"></i><b>5.2</b> Qualifying Pace</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="drivers.html"><a href="drivers.html#section"><i class="fa fa-check"></i><b>5.2.1</b> 2023</a></li>
<li class="chapter" data-level="5.2.2" data-path="drivers.html"><a href="drivers.html#section-1"><i class="fa fa-check"></i><b>5.2.2</b> 2022</a></li>
<li class="chapter" data-level="5.2.3" data-path="drivers.html"><a href="drivers.html#section-2"><i class="fa fa-check"></i><b>5.2.3</b> 2021</a></li>
<li class="chapter" data-level="5.2.4" data-path="drivers.html"><a href="drivers.html#section-3"><i class="fa fa-check"></i><b>5.2.4</b> 2020</a></li>
<li class="chapter" data-level="5.2.5" data-path="drivers.html"><a href="drivers.html#section-4"><i class="fa fa-check"></i><b>5.2.5</b> 2019</a></li>
<li class="chapter" data-level="5.2.6" data-path="drivers.html"><a href="drivers.html#section-5"><i class="fa fa-check"></i><b>5.2.6</b> 2018</a></li>
<li class="chapter" data-level="5.2.7" data-path="drivers.html"><a href="drivers.html#section-6"><i class="fa fa-check"></i><b>5.2.7</b> 2017</a></li>
<li class="chapter" data-level="5.2.8" data-path="drivers.html"><a href="drivers.html#section-7"><i class="fa fa-check"></i><b>5.2.8</b> 2016</a></li>
<li class="chapter" data-level="5.2.9" data-path="drivers.html"><a href="drivers.html#section-8"><i class="fa fa-check"></i><b>5.2.9</b> 2015</a></li>
<li class="chapter" data-level="5.2.10" data-path="drivers.html"><a href="drivers.html#section-9"><i class="fa fa-check"></i><b>5.2.10</b> 2014</a></li>
<li class="chapter" data-level="5.2.11" data-path="drivers.html"><a href="drivers.html#next-chapter-3"><i class="fa fa-check"></i><b>5.2.11</b> Next Chapter</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="modeling-race-results.html"><a href="modeling-race-results.html"><i class="fa fa-check"></i><b>6</b> Modeling Race Results</a>
<ul>
<li class="chapter" data-level="6.1" data-path="modeling-race-results.html"><a href="modeling-race-results.html#starting-position-vs-finish-position"><i class="fa fa-check"></i><b>6.1</b> Starting Position vs Finish Position</a></li>
<li class="chapter" data-level="6.2" data-path="modeling-race-results.html"><a href="modeling-race-results.html#shortcomings-of-a-simple-linear-regression-model"><i class="fa fa-check"></i><b>6.2</b> Shortcomings of a simple linear regression model</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="modeling-race-results.html"><a href="modeling-race-results.html#linearity"><i class="fa fa-check"></i><b>6.2.1</b> Linearity</a></li>
<li class="chapter" data-level="6.2.2" data-path="modeling-race-results.html"><a href="modeling-race-results.html#homoscedasticity"><i class="fa fa-check"></i><b>6.2.2</b> Homoscedasticity</a></li>
<li class="chapter" data-level="6.2.3" data-path="modeling-race-results.html"><a href="modeling-race-results.html#independence"><i class="fa fa-check"></i><b>6.2.3</b> Independence</a></li>
<li class="chapter" data-level="6.2.4" data-path="modeling-race-results.html"><a href="modeling-race-results.html#normality"><i class="fa fa-check"></i><b>6.2.4</b> Normality</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="modeling-race-results.html"><a href="modeling-race-results.html#ordinal-regression-model"><i class="fa fa-check"></i><b>6.3</b> Ordinal regression model</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="modeling-race-results.html"><a href="modeling-race-results.html#prediction-grid"><i class="fa fa-check"></i><b>6.3.1</b> Prediction Grid</a></li>
<li class="chapter" data-level="6.3.2" data-path="modeling-race-results.html"><a href="modeling-race-results.html#yearly-differences-in-ordinal-regression-results"><i class="fa fa-check"></i><b>6.3.2</b> Yearly Differences in Ordinal Regression Results</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="modeling-race-results.html"><a href="modeling-race-results.html#explore-circuit-specific-models"><i class="fa fa-check"></i><b>6.4</b> Explore Circuit Specific Models</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="modeling-race-results.html"><a href="modeling-race-results.html#bahrain"><i class="fa fa-check"></i><b>6.4.1</b> Bahrain</a></li>
<li class="chapter" data-level="6.4.2" data-path="modeling-race-results.html"><a href="modeling-race-results.html#saudi-arabia"><i class="fa fa-check"></i><b>6.4.2</b> Saudi Arabia</a></li>
<li class="chapter" data-level="6.4.3" data-path="modeling-race-results.html"><a href="modeling-race-results.html#monaco"><i class="fa fa-check"></i><b>6.4.3</b> Monaco</a></li>
<li class="chapter" data-level="6.4.4" data-path="modeling-race-results.html"><a href="modeling-race-results.html#brazil"><i class="fa fa-check"></i><b>6.4.4</b> Brazil</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="modeling-race-results.html"><a href="modeling-race-results.html#appendix-probability-distributions-for-every-grand-prix"><i class="fa fa-check"></i><b>6.5</b> Appendix: Probability distributions for every Grand Prix</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="modeling-race-results.html"><a href="modeling-race-results.html#bahrain-1"><i class="fa fa-check"></i><b>6.5.1</b> Bahrain</a></li>
<li class="chapter" data-level="6.5.2" data-path="modeling-race-results.html"><a href="modeling-race-results.html#saudi-arabia-1"><i class="fa fa-check"></i><b>6.5.2</b> Saudi Arabia</a></li>
<li class="chapter" data-level="6.5.3" data-path="modeling-race-results.html"><a href="modeling-race-results.html#australia"><i class="fa fa-check"></i><b>6.5.3</b> Australia</a></li>
<li class="chapter" data-level="6.5.4" data-path="modeling-race-results.html"><a href="modeling-race-results.html#azerbaijan"><i class="fa fa-check"></i><b>6.5.4</b> Azerbaijan</a></li>
<li class="chapter" data-level="6.5.5" data-path="modeling-race-results.html"><a href="modeling-race-results.html#miami"><i class="fa fa-check"></i><b>6.5.5</b> Miami</a></li>
<li class="chapter" data-level="6.5.6" data-path="modeling-race-results.html"><a href="modeling-race-results.html#emilia-romagna"><i class="fa fa-check"></i><b>6.5.6</b> Emilia Romagna</a></li>
<li class="chapter" data-level="6.5.7" data-path="modeling-race-results.html"><a href="modeling-race-results.html#monaco-1"><i class="fa fa-check"></i><b>6.5.7</b> Monaco</a></li>
<li class="chapter" data-level="6.5.8" data-path="modeling-race-results.html"><a href="modeling-race-results.html#spain"><i class="fa fa-check"></i><b>6.5.8</b> Spain</a></li>
<li class="chapter" data-level="6.5.9" data-path="modeling-race-results.html"><a href="modeling-race-results.html#canada"><i class="fa fa-check"></i><b>6.5.9</b> Canada</a></li>
<li class="chapter" data-level="6.5.10" data-path="modeling-race-results.html"><a href="modeling-race-results.html#austria"><i class="fa fa-check"></i><b>6.5.10</b> Austria</a></li>
<li class="chapter" data-level="6.5.11" data-path="modeling-race-results.html"><a href="modeling-race-results.html#great-britain"><i class="fa fa-check"></i><b>6.5.11</b> Great Britain</a></li>
<li class="chapter" data-level="6.5.12" data-path="modeling-race-results.html"><a href="modeling-race-results.html#hungary"><i class="fa fa-check"></i><b>6.5.12</b> Hungary</a></li>
<li class="chapter" data-level="6.5.13" data-path="modeling-race-results.html"><a href="modeling-race-results.html#belgium"><i class="fa fa-check"></i><b>6.5.13</b> Belgium</a></li>
<li class="chapter" data-level="6.5.14" data-path="modeling-race-results.html"><a href="modeling-race-results.html#netherlands"><i class="fa fa-check"></i><b>6.5.14</b> Netherlands</a></li>
<li class="chapter" data-level="6.5.15" data-path="modeling-race-results.html"><a href="modeling-race-results.html#monza"><i class="fa fa-check"></i><b>6.5.15</b> Monza</a></li>
<li class="chapter" data-level="6.5.16" data-path="modeling-race-results.html"><a href="modeling-race-results.html#singapore"><i class="fa fa-check"></i><b>6.5.16</b> Singapore</a></li>
<li class="chapter" data-level="6.5.17" data-path="modeling-race-results.html"><a href="modeling-race-results.html#japan"><i class="fa fa-check"></i><b>6.5.17</b> Japan</a></li>
<li class="chapter" data-level="6.5.18" data-path="modeling-race-results.html"><a href="modeling-race-results.html#qatar"><i class="fa fa-check"></i><b>6.5.18</b> Qatar</a></li>
<li class="chapter" data-level="6.5.19" data-path="modeling-race-results.html"><a href="modeling-race-results.html#united-states-circuit-of-the-americas-in-austin-texas"><i class="fa fa-check"></i><b>6.5.19</b> United States (Circuit of the Americas in Austin, Texas)</a></li>
<li class="chapter" data-level="6.5.20" data-path="modeling-race-results.html"><a href="modeling-race-results.html#mexico"><i class="fa fa-check"></i><b>6.5.20</b> Mexico</a></li>
<li class="chapter" data-level="6.5.21" data-path="modeling-race-results.html"><a href="modeling-race-results.html#brazil-1"><i class="fa fa-check"></i><b>6.5.21</b> Brazil</a></li>
<li class="chapter" data-level="6.5.22" data-path="modeling-race-results.html"><a href="modeling-race-results.html#abu-dhabi"><i class="fa fa-check"></i><b>6.5.22</b> Abu Dhabi</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="modeling-race-results.html"><a href="modeling-race-results.html#next-chapter-4"><i class="fa fa-check"></i><b>6.6</b> Next Chapter</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="dnf-did-not-finish.html"><a href="dnf-did-not-finish.html"><i class="fa fa-check"></i><b>7</b> DNF (Did Not Finish)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="dnf-did-not-finish.html"><a href="dnf-did-not-finish.html#logistic-regression"><i class="fa fa-check"></i><b>7.1</b> Logistic Regression</a></li>
<li class="chapter" data-level="7.2" data-path="dnf-did-not-finish.html"><a href="dnf-did-not-finish.html#yearly-differences"><i class="fa fa-check"></i><b>7.2</b> Yearly Differences</a></li>
<li class="chapter" data-level="7.3" data-path="dnf-did-not-finish.html"><a href="dnf-did-not-finish.html#differences-by-constructor"><i class="fa fa-check"></i><b>7.3</b> Differences by constructor</a></li>
<li class="chapter" data-level="7.4" data-path="dnf-did-not-finish.html"><a href="dnf-did-not-finish.html#dnfs-by-race-of-the-season"><i class="fa fa-check"></i><b>7.4</b> DNFs by race of the season</a></li>
<li class="chapter" data-level="7.5" data-path="dnf-did-not-finish.html"><a href="dnf-did-not-finish.html#next-chapter-5"><i class="fa fa-check"></i><b>7.5</b> Next Chapter</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="the-wdc-world-drivers-championship.html"><a href="the-wdc-world-drivers-championship.html"><i class="fa fa-check"></i><b>8</b> The WDC (World Drivers Championship)</a></li>
<li class="chapter" data-level="9" data-path="conclusions.html"><a href="conclusions.html"><i class="fa fa-check"></i><b>9</b> Conclusions</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Visualizing Formula 1 Data in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="drivers" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Drivers<a href="drivers.html#drivers" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>What separates the great drivers from the merely good drivers? There are only 20 Formula 1 seats available in the world, and only the best even get considered for the job. A driver needs talent, money, an FIA super license, and a lot of luck to ever start a Grand Prix. And despite the incredibly tough filtering mechanisms for talent in F1, there remain a few outliers a few drivers that stand apart.</p>
<p>In his autobiography <em>Total Competition</em>, the legendary team principal Ross Brawn described how Michael Schumacher, perhaps the greatest driver of all time, simply had more <em>capacity</em> available because of his talent. Brawn felt that Michael possessed so much talent for driving that he was free to think through more things while driving. Team principals are obviously in a great position to judge the talent of drivers, and each year, www.formula1.com publishes the results from a team principal survey of the top drivers in the sport. Here’s what the results from the past three years looks like (including only drivers that drove in 2023):</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="drivers.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataframe with yearly rankings</span></span>
<span id="cb93-2"><a href="drivers.html#cb93-2" aria-hidden="true" tabindex="-1"></a>team_principal_survey <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Driver =</span> <span class="fu">c</span>(<span class="st">&#39;VER&#39;</span>, <span class="st">&#39;ALO&#39;</span>, <span class="st">&#39;NOR&#39;</span>, <span class="st">&#39;LEC&#39;</span>, <span class="st">&#39;HAM&#39;</span>,</span>
<span id="cb93-3"><a href="drivers.html#cb93-3" aria-hidden="true" tabindex="-1"></a>                                               <span class="st">&#39;SAI&#39;</span>, <span class="st">&#39;PIA&#39;</span>, <span class="st">&#39;ALB&#39;</span>, <span class="st">&#39;RUS&#39;</span>, <span class="st">&#39;PER&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb93-4"><a href="drivers.html#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">2023</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>),</span>
<span id="cb93-5"><a href="drivers.html#cb93-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">2022</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="dv">3</span>, <span class="dv">5</span>),</span>
<span id="cb93-6"><a href="drivers.html#cb93-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">2021</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="dv">8</span>, <span class="cn">NA</span>))</span>
<span id="cb93-7"><a href="drivers.html#cb93-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-8"><a href="drivers.html#cb93-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb93-9"><a href="drivers.html#cb93-9" aria-hidden="true" tabindex="-1"></a>team_principal_survey <span class="sc">%&gt;%</span></span>
<span id="cb93-10"><a href="drivers.html#cb93-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>Driver, <span class="at">names_to =</span> <span class="st">&#39;Year&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;Rank&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb93-11"><a href="drivers.html#cb93-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Year, Rank, <span class="at">col =</span> Driver, <span class="at">group =</span> Driver)) <span class="sc">+</span></span>
<span id="cb93-12"><a href="drivers.html#cb93-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb93-13"><a href="drivers.html#cb93-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb93-14"><a href="drivers.html#cb93-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb93-15"><a href="drivers.html#cb93-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>(<span class="at">labels =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">1</span>),</span>
<span id="cb93-16"><a href="drivers.html#cb93-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">1</span>))  <span class="sc">+</span></span>
<span id="cb93-17"><a href="drivers.html#cb93-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb93-18"><a href="drivers.html#cb93-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb93-19"><a href="drivers.html#cb93-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>) <span class="sc">+</span></span>
<span id="cb93-20"><a href="drivers.html#cb93-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Top Drivers&#39;</span>,</span>
<span id="cb93-21"><a href="drivers.html#cb93-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;based on team principal rankings&#39;</span>) <span class="sc">+</span></span>
<span id="cb93-22"><a href="drivers.html#cb93-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data =</span> <span class="sc">~</span> <span class="fu">subset</span>(.x, Year <span class="sc">==</span> <span class="dv">2023</span>),</span>
<span id="cb93-23"><a href="drivers.html#cb93-23" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> Driver),</span>
<span id="cb93-24"><a href="drivers.html#cb93-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">nudge_x =</span> <span class="fl">0.1</span>, <span class="at">nudge_y =</span> <span class="dv">0</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb93-25"><a href="drivers.html#cb93-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;red&quot;</span>, </span>
<span id="cb93-26"><a href="drivers.html#cb93-26" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;cyan3&quot;</span>, <span class="st">&quot;cyan3&quot;</span>,</span>
<span id="cb93-27"><a href="drivers.html#cb93-27" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb93-28"><a href="drivers.html#cb93-28" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;darkslateblue&quot;</span>,</span>
<span id="cb93-29"><a href="drivers.html#cb93-29" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;darkred&quot;</span>,</span>
<span id="cb93-30"><a href="drivers.html#cb93-30" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;darkseagreen4&quot;</span>, <span class="st">&quot;darkseagreen4&quot;</span>,</span>
<span id="cb93-31"><a href="drivers.html#cb93-31" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;darkorange&quot;</span>,</span>
<span id="cb93-32"><a href="drivers.html#cb93-32" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;cornflowerblue&quot;</span>, </span>
<span id="cb93-33"><a href="drivers.html#cb93-33" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;navy&quot;</span>, <span class="st">&quot;navy&quot;</span>),</span>
<span id="cb93-34"><a href="drivers.html#cb93-34" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;LEC&quot;</span>, <span class="st">&quot;SAI&quot;</span>,</span>
<span id="cb93-35"><a href="drivers.html#cb93-35" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;HAM&quot;</span>, <span class="st">&quot;RUS&quot;</span>, </span>
<span id="cb93-36"><a href="drivers.html#cb93-36" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;OCO&quot;</span>, </span>
<span id="cb93-37"><a href="drivers.html#cb93-37" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;GAS&quot;</span>,  </span>
<span id="cb93-38"><a href="drivers.html#cb93-38" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;BOT&quot;</span>,</span>
<span id="cb93-39"><a href="drivers.html#cb93-39" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;ALO&quot;</span>, <span class="st">&quot;VET&quot;</span>,</span>
<span id="cb93-40"><a href="drivers.html#cb93-40" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;NOR&quot;</span>, <span class="st">&quot;PIA&quot;</span>,</span>
<span id="cb93-41"><a href="drivers.html#cb93-41" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;ALB&quot;</span>,</span>
<span id="cb93-42"><a href="drivers.html#cb93-42" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;PER&quot;</span>, <span class="st">&quot;VER&quot;</span></span>
<span id="cb93-43"><a href="drivers.html#cb93-43" aria-hidden="true" tabindex="-1"></a>                                ))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-82-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Clearly team principals think highly of the reigning world champion Max Verstappen. But, how do the team principals determine these rankings? I’m not entirely sure. Driver skill is a surprisingly difficult trait to describe and understand. What are the essential skills of a driver? And how do you measure those skills? Well, most agree that the best drivers share the following traits:</p>
<ul>
<li>consistency</li>
<li>adaptability</li>
<li>qualifying pace</li>
<li>race pace</li>
<li>tire management</li>
<li>an understanding of the car’s limits and how to extract all of the performance from a car</li>
<li>performance in wet conditions</li>
</ul>
<p>Are these traits measurable? Not really (at least for the common fan). While I wish there was some data available that described these driver traits, I am afraid we are limited to merely analyzing driver <em>performance</em>. In this chapter, I’ll use the <strong>drs</strong> package to pull data from www.formula1.com and visualize driver performance during qualifying and the race with <strong>ggplot</strong>. The most obvious and simplest place to start is to plot race results by driver and circuit. Later on in the chapter, we can also look at each driver’s qualifying pace compared to (A) the rest of the grid and (B) their teammate. The best drivers in history consistently out-qualify other team’s top drivers, and more importantly, their own teammates.</p>
<div id="race-performance" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Race Performance<a href="drivers.html#race-performance" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>I find heat maps an enjoyable way to visualize race results. So, throughout this section, I’ll create heat maps for each year from 2014 to 2023. I will start with 2023, whcih was effectively the Max Verstappen show. Max won his third world title and Red Bull collected their 2nd consecutive (6th total) constructors championship. From the very first race, Red Bull appeared to be nearly unbeatable. And ultimately, Max completed <em>arguably</em> the most dominant season of all time by winning 19 of 22 races and finishing on the podium in all but one Grand Prix. In 2023, Max had a winning percentage of 86.36%, eclipsing the previous long-standing record set by Alberto Ascari in 1952.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="drivers.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(drs)</span>
<span id="cb94-2"><a href="drivers.html#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb94-3"><a href="drivers.html#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="drivers.html#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Pull race results</span></span>
<span id="cb94-5"><a href="drivers.html#cb94-5" aria-hidden="true" tabindex="-1"></a>races2023 <span class="ot">&lt;-</span> <span class="fu">race_result_scraper</span>(<span class="dv">2023</span>)</span>
<span id="cb94-6"><a href="drivers.html#cb94-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-7"><a href="drivers.html#cb94-7" aria-hidden="true" tabindex="-1"></a>races2023 <span class="sc">%&gt;%</span></span>
<span id="cb94-8"><a href="drivers.html#cb94-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">n =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),</span>
<span id="cb94-9"><a href="drivers.html#cb94-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">Race =</span> <span class="fu">fct_reorder</span>(Race, <span class="fu">desc</span>(n))) <span class="sc">%&gt;%</span></span>
<span id="cb94-10"><a href="drivers.html#cb94-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Race) <span class="sc">%&gt;%</span> </span>
<span id="cb94-11"><a href="drivers.html#cb94-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Race_number =</span> <span class="fu">cur_group_id</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb94-12"><a href="drivers.html#cb94-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Driver) <span class="sc">%&gt;%</span> </span>
<span id="cb94-13"><a href="drivers.html#cb94-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sum_pts =</span> <span class="fu">sum</span>(Points, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb94-14"><a href="drivers.html#cb94-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb94-15"><a href="drivers.html#cb94-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">fct_reorder</span>(Driver, <span class="fu">desc</span>(sum_pts)), Race, <span class="at">fill =</span> Points)) <span class="sc">+</span></span>
<span id="cb94-16"><a href="drivers.html#cb94-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">size=</span><span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb94-17"><a href="drivers.html#cb94-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb94-18"><a href="drivers.html#cb94-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Points scored during the 2023 season&#39;</span>,</span>
<span id="cb94-19"><a href="drivers.html#cb94-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Race&#39;</span>,</span>
<span id="cb94-20"><a href="drivers.html#cb94-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;Driver&#39;</span>) <span class="sc">+</span> </span>
<span id="cb94-21"><a href="drivers.html#cb94-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_family=</span><span class="st">&quot;Helvetica&quot;</span>)  <span class="sc">+</span></span>
<span id="cb94-22"><a href="drivers.html#cb94-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb94-23"><a href="drivers.html#cb94-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb94-24"><a href="drivers.html#cb94-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb94-25"><a href="drivers.html#cb94-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb94-26"><a href="drivers.html#cb94-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&#39;magma&#39;</span>,</span>
<span id="cb94-27"><a href="drivers.html#cb94-27" aria-hidden="true" tabindex="-1"></a>                       <span class="at">guide =</span> <span class="st">&#39;legend&#39;</span>,</span>
<span id="cb94-28"><a href="drivers.html#cb94-28" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">15</span>,<span class="dv">18</span>,<span class="dv">25</span>,<span class="dv">26</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-83-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>The 2022 Formula 1 season was also dominated by Red Bull. Max Verstappen secured the Driver’s Championship by the 18th race of the season, the Japanese Grand Prix. However, Red Bull’s 2022 season opened with some uncertainty after experiencing 3 retirements in first two races. Both Max Verstappen and Sergio Pérez retired from the Bahrain Grand Prix in the closing laps with fuel issues. In the Australian Grand Prix, Verstappen again retired with fuel issues. Ultimately, Max finished 2022 with 15 wins and 454 points, the most in F1 history (at the time). Charles LeClerc took 2nd (308 points) and Sergio Perez took 3rd (305 points) in the Driver’s Championship.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="drivers.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pull race results</span></span>
<span id="cb95-2"><a href="drivers.html#cb95-2" aria-hidden="true" tabindex="-1"></a>races2022 <span class="ot">&lt;-</span> <span class="fu">race_result_scraper</span>(<span class="dv">2022</span>)</span>
<span id="cb95-3"><a href="drivers.html#cb95-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-4"><a href="drivers.html#cb95-4" aria-hidden="true" tabindex="-1"></a>races2022 <span class="sc">%&gt;%</span></span>
<span id="cb95-5"><a href="drivers.html#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">n =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),</span>
<span id="cb95-6"><a href="drivers.html#cb95-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">Race =</span> <span class="fu">fct_reorder</span>(Race, <span class="fu">desc</span>(n))) <span class="sc">%&gt;%</span></span>
<span id="cb95-7"><a href="drivers.html#cb95-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Race) <span class="sc">%&gt;%</span> </span>
<span id="cb95-8"><a href="drivers.html#cb95-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Race_number =</span> <span class="fu">cur_group_id</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb95-9"><a href="drivers.html#cb95-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Driver) <span class="sc">%&gt;%</span> </span>
<span id="cb95-10"><a href="drivers.html#cb95-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sum_pts =</span> <span class="fu">sum</span>(Points, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb95-11"><a href="drivers.html#cb95-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb95-12"><a href="drivers.html#cb95-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">fct_reorder</span>(Driver, <span class="fu">desc</span>(sum_pts)), Race, <span class="at">fill =</span> Points)) <span class="sc">+</span></span>
<span id="cb95-13"><a href="drivers.html#cb95-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">size=</span><span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb95-14"><a href="drivers.html#cb95-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb95-15"><a href="drivers.html#cb95-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Points scored during the 2022 season&#39;</span>,</span>
<span id="cb95-16"><a href="drivers.html#cb95-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Race&#39;</span>,</span>
<span id="cb95-17"><a href="drivers.html#cb95-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;Driver&#39;</span>) <span class="sc">+</span> </span>
<span id="cb95-18"><a href="drivers.html#cb95-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_family=</span><span class="st">&quot;Helvetica&quot;</span>)  <span class="sc">+</span></span>
<span id="cb95-19"><a href="drivers.html#cb95-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb95-20"><a href="drivers.html#cb95-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb95-21"><a href="drivers.html#cb95-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb95-22"><a href="drivers.html#cb95-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb95-23"><a href="drivers.html#cb95-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&#39;magma&#39;</span>,</span>
<span id="cb95-24"><a href="drivers.html#cb95-24" aria-hidden="true" tabindex="-1"></a>                       <span class="at">guide =</span> <span class="st">&#39;legend&#39;</span>,</span>
<span id="cb95-25"><a href="drivers.html#cb95-25" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">15</span>,<span class="dv">18</span>,<span class="dv">25</span>,<span class="dv">26</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-84-1.png" width="768" style="display: block; margin: auto;" /></p>
<p><br>
<br></p>
<div class="blackbox">
<div class="center">
<p><strong>How to create a heat map in ggplot</strong></p>
</div>
<p>To create a heap map in ggplot2, use the <code>geom_tile()</code> geometry. You will need to pass categorical variables to <code>x</code> and <code>y</code> arguments and the continuous color fill variable to the <code>fill</code> argument.</p>
<p>For more information on using <code>geom_tile()</code> in <strong>ggplot2</strong>, visit this link: <a href="https://plotly.com/ggplot2/geom_tile/" class="uri">https://plotly.com/ggplot2/geom_tile/</a></p>
</div>
<p><br>
<br></p>
<p>The 2021 Formula 1 season was a modern classic! There was a year-long battle between Red Bull and Mercedes (the reigning 7-time World Constructor’s Champions). Max Verstappen and Lewis Hamilton (the reigning and 7-time World Driver’s Champion) combined to win 18 out of 22 Grands Prix in 2021 (Verstappen with 10 wins, and Hamilton with 8 wins). Both drivers entered the final race of the season (the Abu Dhabi Grand Prix) tied on points. This final race, and the 2021 Driver’s Championship, was decided on the final lap of the season when Max Verstappen overtook Hamilton following a safety car restart.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="drivers.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pull race results</span></span>
<span id="cb96-2"><a href="drivers.html#cb96-2" aria-hidden="true" tabindex="-1"></a>races2021 <span class="ot">&lt;-</span> <span class="fu">race_result_scraper</span>(<span class="dv">2021</span>)</span>
<span id="cb96-3"><a href="drivers.html#cb96-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-4"><a href="drivers.html#cb96-4" aria-hidden="true" tabindex="-1"></a>races2021 <span class="sc">%&gt;%</span></span>
<span id="cb96-5"><a href="drivers.html#cb96-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">n =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),</span>
<span id="cb96-6"><a href="drivers.html#cb96-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">Race =</span> <span class="fu">fct_reorder</span>(Race, <span class="fu">desc</span>(n))) <span class="sc">%&gt;%</span></span>
<span id="cb96-7"><a href="drivers.html#cb96-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Race) <span class="sc">%&gt;%</span> </span>
<span id="cb96-8"><a href="drivers.html#cb96-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Race_number =</span> <span class="fu">cur_group_id</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb96-9"><a href="drivers.html#cb96-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Driver) <span class="sc">%&gt;%</span> </span>
<span id="cb96-10"><a href="drivers.html#cb96-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sum_pts =</span> <span class="fu">sum</span>(Points, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb96-11"><a href="drivers.html#cb96-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb96-12"><a href="drivers.html#cb96-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">fct_reorder</span>(Driver, <span class="fu">desc</span>(sum_pts)), Race, <span class="at">fill =</span> Points)) <span class="sc">+</span></span>
<span id="cb96-13"><a href="drivers.html#cb96-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">size=</span><span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb96-14"><a href="drivers.html#cb96-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb96-15"><a href="drivers.html#cb96-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Points scored during the 2021 season&#39;</span>,</span>
<span id="cb96-16"><a href="drivers.html#cb96-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Race&#39;</span>,</span>
<span id="cb96-17"><a href="drivers.html#cb96-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;Driver&#39;</span>) <span class="sc">+</span> </span>
<span id="cb96-18"><a href="drivers.html#cb96-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_family=</span><span class="st">&quot;Helvetica&quot;</span>)  <span class="sc">+</span></span>
<span id="cb96-19"><a href="drivers.html#cb96-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb96-20"><a href="drivers.html#cb96-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb96-21"><a href="drivers.html#cb96-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb96-22"><a href="drivers.html#cb96-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb96-23"><a href="drivers.html#cb96-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&#39;magma&#39;</span>,</span>
<span id="cb96-24"><a href="drivers.html#cb96-24" aria-hidden="true" tabindex="-1"></a>                       <span class="at">guide =</span> <span class="st">&#39;legend&#39;</span>,</span>
<span id="cb96-25"><a href="drivers.html#cb96-25" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">15</span>,<span class="dv">18</span>,<span class="dv">25</span>,<span class="dv">26</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-85-1.png" width="768" style="display: block; margin: auto;" /></p>
<p><br>
<br></p>
<div class="blackbox">
<div class="center">
<p><strong>Using a pretty theme for a heat map in ggplot</strong></p>
</div>
<p>The <code>theme_tufte()</code> function in ggplot2 cleans up the formatting for a figure, by using no border, no axis lines, and no grids.</p>
<p>For more information on using <code>theme_tufte()</code> in <strong>ggplot2</strong>, visit this link: <a href="https://rdrr.io/cran/ggthemes/man/theme_tufte.html" class="uri">https://rdrr.io/cran/ggthemes/man/theme_tufte.html</a></p>
<p>For more information about Edward Tufte’s principles, see this reference:</p>
<p>Tufte, Edward R. (2001) The Visual Display of Quantitative Information, Chapter 6.</p>
</div>
<p><br>
<br></p>
<p>The 2020 season was shortened and delayed due to the COVID-19 pandemic. Originally planned for 22 Grands Prix, this season only contested 17 races and several venues cancelled. Hamilton and Valtteri Bottas finished 1st and 2nd in the Driver’s standings as Mercedes dominated the 2020 season.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="drivers.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pull race results</span></span>
<span id="cb97-2"><a href="drivers.html#cb97-2" aria-hidden="true" tabindex="-1"></a>races2020 <span class="ot">&lt;-</span> <span class="fu">race_result_scraper</span>(<span class="dv">2020</span>)</span>
<span id="cb97-3"><a href="drivers.html#cb97-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-4"><a href="drivers.html#cb97-4" aria-hidden="true" tabindex="-1"></a>races2020 <span class="sc">%&gt;%</span></span>
<span id="cb97-5"><a href="drivers.html#cb97-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">n =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),</span>
<span id="cb97-6"><a href="drivers.html#cb97-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">Race =</span> <span class="fu">fct_reorder</span>(Race, <span class="fu">desc</span>(n))) <span class="sc">%&gt;%</span></span>
<span id="cb97-7"><a href="drivers.html#cb97-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Race) <span class="sc">%&gt;%</span> </span>
<span id="cb97-8"><a href="drivers.html#cb97-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Race_number =</span> <span class="fu">cur_group_id</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb97-9"><a href="drivers.html#cb97-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Driver) <span class="sc">%&gt;%</span> </span>
<span id="cb97-10"><a href="drivers.html#cb97-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sum_pts =</span> <span class="fu">sum</span>(Points, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb97-11"><a href="drivers.html#cb97-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb97-12"><a href="drivers.html#cb97-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">fct_reorder</span>(Driver, <span class="fu">desc</span>(sum_pts)), Race, <span class="at">fill =</span> Points)) <span class="sc">+</span></span>
<span id="cb97-13"><a href="drivers.html#cb97-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">size=</span><span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb97-14"><a href="drivers.html#cb97-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb97-15"><a href="drivers.html#cb97-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Points scored during the 2020 season&#39;</span>,</span>
<span id="cb97-16"><a href="drivers.html#cb97-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Race&#39;</span>,</span>
<span id="cb97-17"><a href="drivers.html#cb97-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;Driver&#39;</span>) <span class="sc">+</span> </span>
<span id="cb97-18"><a href="drivers.html#cb97-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_family=</span><span class="st">&quot;Helvetica&quot;</span>)  <span class="sc">+</span></span>
<span id="cb97-19"><a href="drivers.html#cb97-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb97-20"><a href="drivers.html#cb97-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb97-21"><a href="drivers.html#cb97-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb97-22"><a href="drivers.html#cb97-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb97-23"><a href="drivers.html#cb97-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&#39;magma&#39;</span>,</span>
<span id="cb97-24"><a href="drivers.html#cb97-24" aria-hidden="true" tabindex="-1"></a>                       <span class="at">guide =</span> <span class="st">&#39;legend&#39;</span>,</span>
<span id="cb97-25"><a href="drivers.html#cb97-25" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">15</span>,<span class="dv">18</span>,<span class="dv">25</span>,<span class="dv">26</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-86-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Lewis Hamilton won 11 races and secured his sixth Driver’s Championship in 2019, as Mercedes won a total of 15 out of 21 races. Valtteri Bottas won 4 races, while Verstappen and LeClerc won 3 and 2 races, respectively.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="drivers.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pull race results</span></span>
<span id="cb98-2"><a href="drivers.html#cb98-2" aria-hidden="true" tabindex="-1"></a>races2019 <span class="ot">&lt;-</span> <span class="fu">race_result_scraper</span>(<span class="dv">2019</span>)</span>
<span id="cb98-3"><a href="drivers.html#cb98-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-4"><a href="drivers.html#cb98-4" aria-hidden="true" tabindex="-1"></a>races2019 <span class="sc">%&gt;%</span></span>
<span id="cb98-5"><a href="drivers.html#cb98-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">n =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),</span>
<span id="cb98-6"><a href="drivers.html#cb98-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">Race =</span> <span class="fu">fct_reorder</span>(Race, <span class="fu">desc</span>(n))) <span class="sc">%&gt;%</span></span>
<span id="cb98-7"><a href="drivers.html#cb98-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Race) <span class="sc">%&gt;%</span> </span>
<span id="cb98-8"><a href="drivers.html#cb98-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Race_number =</span> <span class="fu">cur_group_id</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb98-9"><a href="drivers.html#cb98-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Driver) <span class="sc">%&gt;%</span> </span>
<span id="cb98-10"><a href="drivers.html#cb98-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sum_pts =</span> <span class="fu">sum</span>(Points, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb98-11"><a href="drivers.html#cb98-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb98-12"><a href="drivers.html#cb98-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">fct_reorder</span>(Driver, <span class="fu">desc</span>(sum_pts)), Race, <span class="at">fill =</span> Points)) <span class="sc">+</span></span>
<span id="cb98-13"><a href="drivers.html#cb98-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">size=</span><span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb98-14"><a href="drivers.html#cb98-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb98-15"><a href="drivers.html#cb98-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Points scored during the 2019 season&#39;</span>,</span>
<span id="cb98-16"><a href="drivers.html#cb98-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Race&#39;</span>,</span>
<span id="cb98-17"><a href="drivers.html#cb98-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;Driver&#39;</span>) <span class="sc">+</span> </span>
<span id="cb98-18"><a href="drivers.html#cb98-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_family=</span><span class="st">&quot;Helvetica&quot;</span>)  <span class="sc">+</span></span>
<span id="cb98-19"><a href="drivers.html#cb98-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb98-20"><a href="drivers.html#cb98-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb98-21"><a href="drivers.html#cb98-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb98-22"><a href="drivers.html#cb98-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb98-23"><a href="drivers.html#cb98-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&#39;magma&#39;</span>,</span>
<span id="cb98-24"><a href="drivers.html#cb98-24" aria-hidden="true" tabindex="-1"></a>                       <span class="at">guide =</span> <span class="st">&#39;legend&#39;</span>,</span>
<span id="cb98-25"><a href="drivers.html#cb98-25" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">15</span>,<span class="dv">18</span>,<span class="dv">25</span>,<span class="dv">26</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-87-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Four-time World Champions Lewis Hamilton and Sebastian Vettel battled closely during 2018. This was the first season in which <em>two</em> four-time world champions battled for a fifth championship. The Championship lead swapped hands between Hamilton and Vettel five times during 2018, and was ultimately secured by Hamilton at the Mexican Grand Prix.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="drivers.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pull race results</span></span>
<span id="cb99-2"><a href="drivers.html#cb99-2" aria-hidden="true" tabindex="-1"></a>races2018 <span class="ot">&lt;-</span> <span class="fu">race_result_scraper</span>(<span class="dv">2018</span>)</span>
<span id="cb99-3"><a href="drivers.html#cb99-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-4"><a href="drivers.html#cb99-4" aria-hidden="true" tabindex="-1"></a>races2018 <span class="sc">%&gt;%</span></span>
<span id="cb99-5"><a href="drivers.html#cb99-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">n =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),</span>
<span id="cb99-6"><a href="drivers.html#cb99-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">Race =</span> <span class="fu">fct_reorder</span>(Race, <span class="fu">desc</span>(n))) <span class="sc">%&gt;%</span></span>
<span id="cb99-7"><a href="drivers.html#cb99-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Race) <span class="sc">%&gt;%</span> </span>
<span id="cb99-8"><a href="drivers.html#cb99-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Race_number =</span> <span class="fu">cur_group_id</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb99-9"><a href="drivers.html#cb99-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Driver) <span class="sc">%&gt;%</span> </span>
<span id="cb99-10"><a href="drivers.html#cb99-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sum_pts =</span> <span class="fu">sum</span>(Points, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb99-11"><a href="drivers.html#cb99-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb99-12"><a href="drivers.html#cb99-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">fct_reorder</span>(Driver, <span class="fu">desc</span>(sum_pts)), Race, <span class="at">fill =</span> Points)) <span class="sc">+</span></span>
<span id="cb99-13"><a href="drivers.html#cb99-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">size=</span><span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb99-14"><a href="drivers.html#cb99-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb99-15"><a href="drivers.html#cb99-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Points scored during the 2018 season&#39;</span>,</span>
<span id="cb99-16"><a href="drivers.html#cb99-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Race&#39;</span>,</span>
<span id="cb99-17"><a href="drivers.html#cb99-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;Driver&#39;</span>) <span class="sc">+</span> </span>
<span id="cb99-18"><a href="drivers.html#cb99-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_family=</span><span class="st">&quot;Helvetica&quot;</span>)  <span class="sc">+</span></span>
<span id="cb99-19"><a href="drivers.html#cb99-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb99-20"><a href="drivers.html#cb99-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb99-21"><a href="drivers.html#cb99-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb99-22"><a href="drivers.html#cb99-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb99-23"><a href="drivers.html#cb99-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&#39;magma&#39;</span>,</span>
<span id="cb99-24"><a href="drivers.html#cb99-24" aria-hidden="true" tabindex="-1"></a>                       <span class="at">guide =</span> <span class="st">&#39;legend&#39;</span>,</span>
<span id="cb99-25"><a href="drivers.html#cb99-25" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">15</span>,<span class="dv">18</span>,<span class="dv">25</span>,<span class="dv">26</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-88-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>2017 marked the first time during Mercedes’ turbo-hybrid era reign that another team presented a legitimate challenge. Sebastian Vettel led the championship deep into this season, but Hamilton ultimately won his 4th title by 46 points.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="drivers.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pull race results</span></span>
<span id="cb100-2"><a href="drivers.html#cb100-2" aria-hidden="true" tabindex="-1"></a>races2017 <span class="ot">&lt;-</span> <span class="fu">race_result_scraper</span>(<span class="dv">2017</span>)</span>
<span id="cb100-3"><a href="drivers.html#cb100-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-4"><a href="drivers.html#cb100-4" aria-hidden="true" tabindex="-1"></a>races2017 <span class="sc">%&gt;%</span></span>
<span id="cb100-5"><a href="drivers.html#cb100-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">n =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),</span>
<span id="cb100-6"><a href="drivers.html#cb100-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">Race =</span> <span class="fu">fct_reorder</span>(Race, <span class="fu">desc</span>(n))) <span class="sc">%&gt;%</span></span>
<span id="cb100-7"><a href="drivers.html#cb100-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Race) <span class="sc">%&gt;%</span> </span>
<span id="cb100-8"><a href="drivers.html#cb100-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Race_number =</span> <span class="fu">cur_group_id</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb100-9"><a href="drivers.html#cb100-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Driver) <span class="sc">%&gt;%</span> </span>
<span id="cb100-10"><a href="drivers.html#cb100-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sum_pts =</span> <span class="fu">sum</span>(Points, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb100-11"><a href="drivers.html#cb100-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb100-12"><a href="drivers.html#cb100-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">fct_reorder</span>(Driver, <span class="fu">desc</span>(sum_pts)), Race, <span class="at">fill =</span> Points)) <span class="sc">+</span></span>
<span id="cb100-13"><a href="drivers.html#cb100-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">size=</span><span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb100-14"><a href="drivers.html#cb100-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb100-15"><a href="drivers.html#cb100-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Points scored during the 2017 season&#39;</span>,</span>
<span id="cb100-16"><a href="drivers.html#cb100-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Race&#39;</span>,</span>
<span id="cb100-17"><a href="drivers.html#cb100-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;Driver&#39;</span>) <span class="sc">+</span> </span>
<span id="cb100-18"><a href="drivers.html#cb100-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_family=</span><span class="st">&quot;Helvetica&quot;</span>)  <span class="sc">+</span></span>
<span id="cb100-19"><a href="drivers.html#cb100-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb100-20"><a href="drivers.html#cb100-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb100-21"><a href="drivers.html#cb100-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb100-22"><a href="drivers.html#cb100-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb100-23"><a href="drivers.html#cb100-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&#39;magma&#39;</span>,</span>
<span id="cb100-24"><a href="drivers.html#cb100-24" aria-hidden="true" tabindex="-1"></a>                       <span class="at">guide =</span> <span class="st">&#39;legend&#39;</span>,</span>
<span id="cb100-25"><a href="drivers.html#cb100-25" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">15</span>,<span class="dv">18</span>,<span class="dv">25</span>,<span class="dv">26</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-89-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Nico Rosberg won his only World Driver’s Championship title in 2016. During an intense intra-team battle, Rosberg won the first four races while Hamilton won the final four. Rosberg secured his title over teammate Hamilton in the final race of the season. Shortly after winning the title, Rosberg announced his retirement from Formula 1.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="drivers.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pull race results</span></span>
<span id="cb101-2"><a href="drivers.html#cb101-2" aria-hidden="true" tabindex="-1"></a>races2016 <span class="ot">&lt;-</span> <span class="fu">race_result_scraper</span>(<span class="dv">2016</span>)</span>
<span id="cb101-3"><a href="drivers.html#cb101-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-4"><a href="drivers.html#cb101-4" aria-hidden="true" tabindex="-1"></a>races2016 <span class="sc">%&gt;%</span></span>
<span id="cb101-5"><a href="drivers.html#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">n =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),</span>
<span id="cb101-6"><a href="drivers.html#cb101-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">Race =</span> <span class="fu">fct_reorder</span>(Race, <span class="fu">desc</span>(n))) <span class="sc">%&gt;%</span></span>
<span id="cb101-7"><a href="drivers.html#cb101-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Race) <span class="sc">%&gt;%</span> </span>
<span id="cb101-8"><a href="drivers.html#cb101-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Race_number =</span> <span class="fu">cur_group_id</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb101-9"><a href="drivers.html#cb101-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Driver) <span class="sc">%&gt;%</span> </span>
<span id="cb101-10"><a href="drivers.html#cb101-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sum_pts =</span> <span class="fu">sum</span>(Points, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb101-11"><a href="drivers.html#cb101-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb101-12"><a href="drivers.html#cb101-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">fct_reorder</span>(Driver, <span class="fu">desc</span>(sum_pts)), Race, <span class="at">fill =</span> Points)) <span class="sc">+</span></span>
<span id="cb101-13"><a href="drivers.html#cb101-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">size=</span><span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb101-14"><a href="drivers.html#cb101-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb101-15"><a href="drivers.html#cb101-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Points scored during the 2016 season&#39;</span>,</span>
<span id="cb101-16"><a href="drivers.html#cb101-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Race&#39;</span>,</span>
<span id="cb101-17"><a href="drivers.html#cb101-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;Driver&#39;</span>) <span class="sc">+</span> </span>
<span id="cb101-18"><a href="drivers.html#cb101-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_family=</span><span class="st">&quot;Helvetica&quot;</span>)  <span class="sc">+</span></span>
<span id="cb101-19"><a href="drivers.html#cb101-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb101-20"><a href="drivers.html#cb101-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb101-21"><a href="drivers.html#cb101-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb101-22"><a href="drivers.html#cb101-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb101-23"><a href="drivers.html#cb101-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&#39;magma&#39;</span>,</span>
<span id="cb101-24"><a href="drivers.html#cb101-24" aria-hidden="true" tabindex="-1"></a>                       <span class="at">guide =</span> <span class="st">&#39;legend&#39;</span>,</span>
<span id="cb101-25"><a href="drivers.html#cb101-25" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">15</span>,<span class="dv">18</span>,<span class="dv">25</span>,<span class="dv">26</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-90-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Lewis Hamilton defended his World Championship in 2015, securing the title with three races to go in the season. Nico Rosberg (Hamilton’s teammate) and Sebastian Vettel finished 2nd and 3rd, respectively.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="drivers.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pull race results</span></span>
<span id="cb102-2"><a href="drivers.html#cb102-2" aria-hidden="true" tabindex="-1"></a>races2015 <span class="ot">&lt;-</span> <span class="fu">race_result_scraper</span>(<span class="dv">2015</span>)</span>
<span id="cb102-3"><a href="drivers.html#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="drivers.html#cb102-4" aria-hidden="true" tabindex="-1"></a>races2015 <span class="sc">%&gt;%</span></span>
<span id="cb102-5"><a href="drivers.html#cb102-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">n =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),</span>
<span id="cb102-6"><a href="drivers.html#cb102-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">Race =</span> <span class="fu">fct_reorder</span>(Race, <span class="fu">desc</span>(n))) <span class="sc">%&gt;%</span></span>
<span id="cb102-7"><a href="drivers.html#cb102-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Race) <span class="sc">%&gt;%</span> </span>
<span id="cb102-8"><a href="drivers.html#cb102-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Race_number =</span> <span class="fu">cur_group_id</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb102-9"><a href="drivers.html#cb102-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Driver) <span class="sc">%&gt;%</span> </span>
<span id="cb102-10"><a href="drivers.html#cb102-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sum_pts =</span> <span class="fu">sum</span>(Points, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb102-11"><a href="drivers.html#cb102-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb102-12"><a href="drivers.html#cb102-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">fct_reorder</span>(Driver, <span class="fu">desc</span>(sum_pts)), Race, <span class="at">fill =</span> Points)) <span class="sc">+</span></span>
<span id="cb102-13"><a href="drivers.html#cb102-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">size=</span><span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb102-14"><a href="drivers.html#cb102-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb102-15"><a href="drivers.html#cb102-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Points scored during the 2015 season&#39;</span>,</span>
<span id="cb102-16"><a href="drivers.html#cb102-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Race&#39;</span>,</span>
<span id="cb102-17"><a href="drivers.html#cb102-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;Driver&#39;</span>) <span class="sc">+</span> </span>
<span id="cb102-18"><a href="drivers.html#cb102-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_family=</span><span class="st">&quot;Helvetica&quot;</span>)  <span class="sc">+</span></span>
<span id="cb102-19"><a href="drivers.html#cb102-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb102-20"><a href="drivers.html#cb102-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb102-21"><a href="drivers.html#cb102-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb102-22"><a href="drivers.html#cb102-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb102-23"><a href="drivers.html#cb102-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&#39;magma&#39;</span>,</span>
<span id="cb102-24"><a href="drivers.html#cb102-24" aria-hidden="true" tabindex="-1"></a>                       <span class="at">guide =</span> <span class="st">&#39;legend&#39;</span>,</span>
<span id="cb102-25"><a href="drivers.html#cb102-25" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">15</span>,<span class="dv">18</span>,<span class="dv">25</span>,<span class="dv">26</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-91-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>The 2014 season marked the introduction of a new engine formula. The previous era’s 2.4 liter V8 engine was replaced by a 1.6 liter turbocharged V6 engine with an energy recovery system. As a result, Mercedes experienced a great engine advantage in 2014, an edge that carried through the entirety of this turbo-hybrid era. Mercedes won their first Constructor’s Championship by nearly 300 points, and Hamilton won his second Driver’s Championship.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="drivers.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pull race results</span></span>
<span id="cb103-2"><a href="drivers.html#cb103-2" aria-hidden="true" tabindex="-1"></a>races2014 <span class="ot">&lt;-</span> <span class="fu">race_result_scraper</span>(<span class="dv">2014</span>)</span>
<span id="cb103-3"><a href="drivers.html#cb103-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-4"><a href="drivers.html#cb103-4" aria-hidden="true" tabindex="-1"></a>races2014 <span class="sc">%&gt;%</span></span>
<span id="cb103-5"><a href="drivers.html#cb103-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">n =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),</span>
<span id="cb103-6"><a href="drivers.html#cb103-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">Race =</span> <span class="fu">fct_reorder</span>(Race, <span class="fu">desc</span>(n))) <span class="sc">%&gt;%</span></span>
<span id="cb103-7"><a href="drivers.html#cb103-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Race) <span class="sc">%&gt;%</span> </span>
<span id="cb103-8"><a href="drivers.html#cb103-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Race_number =</span> <span class="fu">cur_group_id</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb103-9"><a href="drivers.html#cb103-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Driver) <span class="sc">%&gt;%</span> </span>
<span id="cb103-10"><a href="drivers.html#cb103-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sum_pts =</span> <span class="fu">sum</span>(Points, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb103-11"><a href="drivers.html#cb103-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb103-12"><a href="drivers.html#cb103-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Points =</span> <span class="fu">ifelse</span>(Race <span class="sc">==</span> <span class="st">&#39;abu-dhabi&#39;</span>, Points <span class="sc">/</span> <span class="dv">2</span>, Points)) <span class="sc">%&gt;%</span> <span class="co"># convert the Abu Dhabi points</span></span>
<span id="cb103-13"><a href="drivers.html#cb103-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">fct_reorder</span>(Driver, <span class="fu">desc</span>(sum_pts)), Race, <span class="at">fill =</span> Points)) <span class="sc">+</span></span>
<span id="cb103-14"><a href="drivers.html#cb103-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">size=</span><span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb103-15"><a href="drivers.html#cb103-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb103-16"><a href="drivers.html#cb103-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Points scored during the 2014 season&#39;</span>,</span>
<span id="cb103-17"><a href="drivers.html#cb103-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Race&#39;</span>,</span>
<span id="cb103-18"><a href="drivers.html#cb103-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;Driver&#39;</span>) <span class="sc">+</span> </span>
<span id="cb103-19"><a href="drivers.html#cb103-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_tufte</span>(<span class="at">base_family=</span><span class="st">&quot;Helvetica&quot;</span>)  <span class="sc">+</span></span>
<span id="cb103-20"><a href="drivers.html#cb103-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb103-21"><a href="drivers.html#cb103-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb103-22"><a href="drivers.html#cb103-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb103-23"><a href="drivers.html#cb103-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb103-24"><a href="drivers.html#cb103-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&#39;magma&#39;</span>,</span>
<span id="cb103-25"><a href="drivers.html#cb103-25" aria-hidden="true" tabindex="-1"></a>                       <span class="at">guide =</span> <span class="st">&#39;legend&#39;</span>,</span>
<span id="cb103-26"><a href="drivers.html#cb103-26" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">15</span>,<span class="dv">18</span>,<span class="dv">25</span>,<span class="dv">26</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-92-1.png" width="768" style="display: block; margin: auto;" /></p>
<p><em>Note: Double points were awarded at the 2014 Abu Dhabi Grand Prix. I manually converted these back to a 25 point scale to aid in the visualization.</em></p>
</div>
<div id="qualifying-pace" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Qualifying Pace<a href="drivers.html#qualifying-pace" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Qualifying pace, or a driver’s flat-out speed over 1 lap, is another attribute that sets drivers apart. The driver-effect can sometimes be difficult to separate from the car-effect, however. For this reason, comparing teammates is one of best ways to evaluate a driver’s qualifying pace. As I mentioned earlier in the chapter, the best drivers of all time consistently out-qualify their teammates. Another way to evaluate qualifying pace is by looking at the season-long performance of drivers in qualifying. Despite the differences in car quality, some drivers are simply more capable of <em>very</em> fast qualifying times. Throughout this section, I will create figures that (A) display intra-team qualifying battles, and (B) plot a driver’s overall distribution of qualifying times for an entire season. I will start with the 2023 season, and work backward.</p>
<div id="section" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> 2023<a href="drivers.html#section" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here’s a look at the intra-team qualifying battles for 2023. The Mercedes battle between Lewis Hamilton and George Hamilton was quite close, while the battle at Red Bull, Aston Martin, and Williams was not.</p>
<p><em>Note: This figure actually required quite a bit of data wrangling. It was somewhat annoying!</em></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="drivers.html#cb104-1" aria-hidden="true" tabindex="-1"></a>quali2023 <span class="ot">&lt;-</span> <span class="fu">qualifying_scraper</span>(<span class="dv">2023</span>)</span>
<span id="cb104-2"><a href="drivers.html#cb104-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-3"><a href="drivers.html#cb104-3" aria-hidden="true" tabindex="-1"></a>quali2023 <span class="sc">%&gt;%</span></span>
<span id="cb104-4"><a href="drivers.html#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb104-5"><a href="drivers.html#cb104-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Race, Position, Car, Driver) <span class="sc">%&gt;%</span></span>
<span id="cb104-6"><a href="drivers.html#cb104-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Position =</span> <span class="fu">as.integer</span>(Position),</span>
<span id="cb104-7"><a href="drivers.html#cb104-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Position =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Position), <span class="dv">21</span>, Position)) <span class="sc">%&gt;%</span> </span>
<span id="cb104-8"><a href="drivers.html#cb104-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Car, Race) <span class="sc">%&gt;%</span> </span>
<span id="cb104-9"><a href="drivers.html#cb104-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Driver) <span class="sc">%&gt;%</span> </span>
<span id="cb104-10"><a href="drivers.html#cb104-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">driver_num =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb104-11"><a href="drivers.html#cb104-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&#39;driver_num&#39;</span>, <span class="at">values_from =</span> <span class="fu">c</span>(<span class="st">&#39;Driver&#39;</span>, <span class="st">&#39;Position&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb104-12"><a href="drivers.html#cb104-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">best_qualifier =</span> <span class="fu">ifelse</span>(Position_1 <span class="sc">&lt;</span> Position_2, Driver_1, Driver_2)) <span class="sc">%&gt;%</span></span>
<span id="cb104-13"><a href="drivers.html#cb104-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb104-14"><a href="drivers.html#cb104-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Car) <span class="sc">%&gt;%</span></span>
<span id="cb104-15"><a href="drivers.html#cb104-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(best_qualifier) <span class="sc">%&gt;%</span></span>
<span id="cb104-16"><a href="drivers.html#cb104-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb104-17"><a href="drivers.html#cb104-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(best_qualifier)) <span class="sc">%&gt;%</span>  </span>
<span id="cb104-18"><a href="drivers.html#cb104-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fct_reorder</span>(best_qualifier, Car), <span class="at">x =</span> percentage, <span class="at">fill =</span> Car)) <span class="sc">+</span></span>
<span id="cb104-19"><a href="drivers.html#cb104-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span></span>
<span id="cb104-20"><a href="drivers.html#cb104-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb104-21"><a href="drivers.html#cb104-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>()) <span class="sc">+</span></span>
<span id="cb104-22"><a href="drivers.html#cb104-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">factor</span>(Car,</span>
<span id="cb104-23"><a href="drivers.html#cb104-23" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Ferrari&quot;</span>,</span>
<span id="cb104-24"><a href="drivers.html#cb104-24" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Mercedes&quot;</span>,</span>
<span id="cb104-25"><a href="drivers.html#cb104-25" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Haas Ferrari&quot;</span>,</span>
<span id="cb104-26"><a href="drivers.html#cb104-26" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Alpine Renault&quot;</span>,</span>
<span id="cb104-27"><a href="drivers.html#cb104-27" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;AlphaTauri Honda RBPT&quot;</span>,</span>
<span id="cb104-28"><a href="drivers.html#cb104-28" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Alfa Romeo Ferrari&quot;</span>, </span>
<span id="cb104-29"><a href="drivers.html#cb104-29" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Aston Martin Aramco Mercedes&quot;</span>,</span>
<span id="cb104-30"><a href="drivers.html#cb104-30" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;McLaren Mercedes&quot;</span>,</span>
<span id="cb104-31"><a href="drivers.html#cb104-31" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Williams Mercedes&quot;</span>,</span>
<span id="cb104-32"><a href="drivers.html#cb104-32" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Red Bull Racing Honda RBPT&quot;</span>)),</span>
<span id="cb104-33"><a href="drivers.html#cb104-33" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">strip.position=</span><span class="st">&quot;top&quot;</span>, <span class="at">scales =</span> <span class="st">&#39;free_y&#39;</span>) <span class="sc">+</span></span>
<span id="cb104-34"><a href="drivers.html#cb104-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&#39;Driver&#39;</span>,</span>
<span id="cb104-35"><a href="drivers.html#cb104-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;Season-long Qualifying Win Proportion&#39;</span>,</span>
<span id="cb104-36"><a href="drivers.html#cb104-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Intra-team Qualifying Battles&#39;</span>,</span>
<span id="cb104-37"><a href="drivers.html#cb104-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;2023&#39;</span>) <span class="sc">+</span></span>
<span id="cb104-38"><a href="drivers.html#cb104-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb104-39"><a href="drivers.html#cb104-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb104-40"><a href="drivers.html#cb104-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb104-41"><a href="drivers.html#cb104-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, </span>
<span id="cb104-42"><a href="drivers.html#cb104-42" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;cyan3&quot;</span>,  </span>
<span id="cb104-43"><a href="drivers.html#cb104-43" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;black&quot;</span>, </span>
<span id="cb104-44"><a href="drivers.html#cb104-44" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb104-45"><a href="drivers.html#cb104-45" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;darkslateblue&quot;</span>, </span>
<span id="cb104-46"><a href="drivers.html#cb104-46" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;darkred&quot;</span>,  </span>
<span id="cb104-47"><a href="drivers.html#cb104-47" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;darkseagreen4&quot;</span>, </span>
<span id="cb104-48"><a href="drivers.html#cb104-48" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;darkorange&quot;</span>, </span>
<span id="cb104-49"><a href="drivers.html#cb104-49" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;cornflowerblue&quot;</span>,</span>
<span id="cb104-50"><a href="drivers.html#cb104-50" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;navy&quot;</span>),</span>
<span id="cb104-51"><a href="drivers.html#cb104-51" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>( <span class="st">&quot;Ferrari&quot;</span>,</span>
<span id="cb104-52"><a href="drivers.html#cb104-52" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Mercedes&quot;</span>,</span>
<span id="cb104-53"><a href="drivers.html#cb104-53" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Haas Ferrari&quot;</span>,</span>
<span id="cb104-54"><a href="drivers.html#cb104-54" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Alpine Renault&quot;</span>,</span>
<span id="cb104-55"><a href="drivers.html#cb104-55" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;AlphaTauri Honda RBPT&quot;</span>,</span>
<span id="cb104-56"><a href="drivers.html#cb104-56" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Alfa Romeo Ferrari&quot;</span>, </span>
<span id="cb104-57"><a href="drivers.html#cb104-57" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Aston Martin Aramco Mercedes&quot;</span>,</span>
<span id="cb104-58"><a href="drivers.html#cb104-58" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;McLaren Mercedes&quot;</span>,</span>
<span id="cb104-59"><a href="drivers.html#cb104-59" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Williams Mercedes&quot;</span>,</span>
<span id="cb104-60"><a href="drivers.html#cb104-60" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Red Bull Racing Honda RBPT&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-93-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>In the figure below, I plot each driver’s standardized qualifying time for 2023 (standardized to a given circuit). In 2023, Ferrari had a rapid qualifying pace, with both drivers consistently putting up very fast times. Charles LeClerc and Carlos Sainz took pole position 5 and 2 times, respectively. Despite this strong qualifying pace by Ferrari, Max Verstappen still managed to secure 12 pole positions for Red Bull and Sergio Perez collected another 2.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="drivers.html#cb105-1" aria-hidden="true" tabindex="-1"></a>qualifying_allyears <span class="sc">%&gt;%</span></span>
<span id="cb105-2"><a href="drivers.html#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Q_secs),</span>
<span id="cb105-3"><a href="drivers.html#cb105-3" aria-hidden="true" tabindex="-1"></a>         Year <span class="sc">==</span> <span class="dv">2023</span>) <span class="sc">%&gt;%</span></span>
<span id="cb105-4"><a href="drivers.html#cb105-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Race) <span class="sc">%&gt;%</span></span>
<span id="cb105-5"><a href="drivers.html#cb105-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">track_mean =</span> <span class="fu">mean</span>(Q_secs, <span class="at">na.rm =</span> T),</span>
<span id="cb105-6"><a href="drivers.html#cb105-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Time_std_track =</span> Q_secs <span class="sc">-</span> track_mean) <span class="sc">%&gt;%</span> </span>
<span id="cb105-7"><a href="drivers.html#cb105-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb105-8"><a href="drivers.html#cb105-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Driver) <span class="sc">%&gt;%</span> </span>
<span id="cb105-9"><a href="drivers.html#cb105-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">driver_n =</span> <span class="fu">n</span>(),</span>
<span id="cb105-10"><a href="drivers.html#cb105-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean =</span> <span class="fu">mean</span>(Time_std_track, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb105-11"><a href="drivers.html#cb105-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb105-12"><a href="drivers.html#cb105-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(driver_n <span class="sc">&gt;</span> <span class="dv">15</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb105-13"><a href="drivers.html#cb105-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Time_std_track, <span class="at">y =</span> <span class="fu">fct_reorder</span>(Driver, <span class="fu">desc</span>(mean)))) <span class="sc">+</span></span>
<span id="cb105-14"><a href="drivers.html#cb105-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">w =</span> <span class="dv">0</span>, <span class="at">h =</span> <span class="fl">0.1</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb105-15"><a href="drivers.html#cb105-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">seq</span>(<span class="dv">23</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>), <span class="at">col =</span> <span class="st">&#39;grey&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb105-16"><a href="drivers.html#cb105-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb105-17"><a href="drivers.html#cb105-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Standardized Qualifying Time (secs)&#39;</span>,</span>
<span id="cb105-18"><a href="drivers.html#cb105-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Driver&#39;</span>,</span>
<span id="cb105-19"><a href="drivers.html#cb105-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Standardized Qualifying Time&#39;</span>,</span>
<span id="cb105-20"><a href="drivers.html#cb105-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;2023&#39;</span>,</span>
<span id="cb105-21"><a href="drivers.html#cb105-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;*Times are subtracted from the average time for each Grand Prix&#39;</span>) <span class="sc">+</span></span>
<span id="cb105-22"><a href="drivers.html#cb105-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb105-23"><a href="drivers.html#cb105-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb105-24"><a href="drivers.html#cb105-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb105-25"><a href="drivers.html#cb105-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb105-26"><a href="drivers.html#cb105-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-94-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="section-1" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> 2022<a href="drivers.html#section-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Charles Leclerc had the most most poles in 2022 (9), followed my Max Verstappen with 7. Some could argue that the Ferrari car was more suited for qualifying pace, but it’s difficult to definitely say the Ferrari was consistently the faster car over 1 lap. Leclerc and Verstappen both out-qualified their teammates by a wide margin (9-3 in favor of LeClerc and 7-1 in favor of Varstappen). Leclerc’s worst performance was 15th in Canada, while Verstappen’s worst qualifying was 10th in Hungary. Additionally, Verstappen made it to Q3 in every weekend of the season.</p>
<p>While the vast majority of the drivers on the grid were not in serious contention for poles, some drivers clearly outperformed their teammates in 2022. For instance, Alex Albon out-qualified teammate Nicholas Latifi by a margin of 19-2.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="drivers.html#cb106-1" aria-hidden="true" tabindex="-1"></a>quali2022 <span class="ot">&lt;-</span> <span class="fu">qualifying_scraper</span>(<span class="dv">2022</span>)</span>
<span id="cb106-2"><a href="drivers.html#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="drivers.html#cb106-3" aria-hidden="true" tabindex="-1"></a>quali2022 <span class="sc">%&gt;%</span></span>
<span id="cb106-4"><a href="drivers.html#cb106-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb106-5"><a href="drivers.html#cb106-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Race, Position, Car, Driver) <span class="sc">%&gt;%</span></span>
<span id="cb106-6"><a href="drivers.html#cb106-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Position =</span> <span class="fu">as.integer</span>(Position),</span>
<span id="cb106-7"><a href="drivers.html#cb106-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Position =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Position), <span class="dv">21</span>, Position)) <span class="sc">%&gt;%</span> </span>
<span id="cb106-8"><a href="drivers.html#cb106-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Car, Race) <span class="sc">%&gt;%</span> </span>
<span id="cb106-9"><a href="drivers.html#cb106-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Driver) <span class="sc">%&gt;%</span> </span>
<span id="cb106-10"><a href="drivers.html#cb106-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">driver_num =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb106-11"><a href="drivers.html#cb106-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&#39;driver_num&#39;</span>, <span class="at">values_from =</span> <span class="fu">c</span>(<span class="st">&#39;Driver&#39;</span>, <span class="st">&#39;Position&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb106-12"><a href="drivers.html#cb106-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">best_qualifier =</span> <span class="fu">ifelse</span>(Position_1 <span class="sc">&lt;</span> Position_2, Driver_1, Driver_2)) <span class="sc">%&gt;%</span></span>
<span id="cb106-13"><a href="drivers.html#cb106-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb106-14"><a href="drivers.html#cb106-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Car) <span class="sc">%&gt;%</span></span>
<span id="cb106-15"><a href="drivers.html#cb106-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(best_qualifier) <span class="sc">%&gt;%</span></span>
<span id="cb106-16"><a href="drivers.html#cb106-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb106-17"><a href="drivers.html#cb106-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(best_qualifier)) <span class="sc">%&gt;%</span>  </span>
<span id="cb106-18"><a href="drivers.html#cb106-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fct_reorder</span>(best_qualifier, Car), <span class="at">x =</span> percentage, <span class="at">fill =</span> Car)) <span class="sc">+</span></span>
<span id="cb106-19"><a href="drivers.html#cb106-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span></span>
<span id="cb106-20"><a href="drivers.html#cb106-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb106-21"><a href="drivers.html#cb106-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>()) <span class="sc">+</span></span>
<span id="cb106-22"><a href="drivers.html#cb106-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">factor</span>(Car,</span>
<span id="cb106-23"><a href="drivers.html#cb106-23" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Ferrari&quot;</span>,</span>
<span id="cb106-24"><a href="drivers.html#cb106-24" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Mercedes&quot;</span>,</span>
<span id="cb106-25"><a href="drivers.html#cb106-25" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Haas Ferrari&quot;</span>,</span>
<span id="cb106-26"><a href="drivers.html#cb106-26" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Alpine Renault&quot;</span>,</span>
<span id="cb106-27"><a href="drivers.html#cb106-27" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;AlphaTauri RBPT&quot;</span>,</span>
<span id="cb106-28"><a href="drivers.html#cb106-28" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Alfa Romeo Ferrari&quot;</span>, </span>
<span id="cb106-29"><a href="drivers.html#cb106-29" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Aston Martin Aramco Mercedes&quot;</span>,</span>
<span id="cb106-30"><a href="drivers.html#cb106-30" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;McLaren Mercedes&quot;</span>,</span>
<span id="cb106-31"><a href="drivers.html#cb106-31" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Williams Mercedes&quot;</span>,</span>
<span id="cb106-32"><a href="drivers.html#cb106-32" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Red Bull Racing RBPT&quot;</span>)),</span>
<span id="cb106-33"><a href="drivers.html#cb106-33" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">strip.position=</span><span class="st">&quot;top&quot;</span>, <span class="at">scales =</span> <span class="st">&#39;free_y&#39;</span>) <span class="sc">+</span></span>
<span id="cb106-34"><a href="drivers.html#cb106-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&#39;Driver&#39;</span>,</span>
<span id="cb106-35"><a href="drivers.html#cb106-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;Season-long Qualifying Win Proportion&#39;</span>,</span>
<span id="cb106-36"><a href="drivers.html#cb106-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Intra-team Qualifying Battles&#39;</span>,</span>
<span id="cb106-37"><a href="drivers.html#cb106-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;2022&#39;</span>) <span class="sc">+</span></span>
<span id="cb106-38"><a href="drivers.html#cb106-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb106-39"><a href="drivers.html#cb106-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb106-40"><a href="drivers.html#cb106-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb106-41"><a href="drivers.html#cb106-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, </span>
<span id="cb106-42"><a href="drivers.html#cb106-42" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;cyan3&quot;</span>,  </span>
<span id="cb106-43"><a href="drivers.html#cb106-43" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;black&quot;</span>, </span>
<span id="cb106-44"><a href="drivers.html#cb106-44" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb106-45"><a href="drivers.html#cb106-45" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;darkslateblue&quot;</span>, </span>
<span id="cb106-46"><a href="drivers.html#cb106-46" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;darkred&quot;</span>,  </span>
<span id="cb106-47"><a href="drivers.html#cb106-47" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;darkseagreen4&quot;</span>, </span>
<span id="cb106-48"><a href="drivers.html#cb106-48" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;darkorange&quot;</span>, </span>
<span id="cb106-49"><a href="drivers.html#cb106-49" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;cornflowerblue&quot;</span>,</span>
<span id="cb106-50"><a href="drivers.html#cb106-50" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;navy&quot;</span>),</span>
<span id="cb106-51"><a href="drivers.html#cb106-51" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>( <span class="st">&quot;Ferrari&quot;</span>,</span>
<span id="cb106-52"><a href="drivers.html#cb106-52" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Mercedes&quot;</span>,</span>
<span id="cb106-53"><a href="drivers.html#cb106-53" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Haas Ferrari&quot;</span>,</span>
<span id="cb106-54"><a href="drivers.html#cb106-54" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Alpine Renault&quot;</span>,</span>
<span id="cb106-55"><a href="drivers.html#cb106-55" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;AlphaTauri RBPT&quot;</span>,</span>
<span id="cb106-56"><a href="drivers.html#cb106-56" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Alfa Romeo Ferrari&quot;</span>, </span>
<span id="cb106-57"><a href="drivers.html#cb106-57" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Aston Martin Aramco Mercedes&quot;</span>,</span>
<span id="cb106-58"><a href="drivers.html#cb106-58" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;McLaren Mercedes&quot;</span>,</span>
<span id="cb106-59"><a href="drivers.html#cb106-59" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Williams Mercedes&quot;</span>,</span>
<span id="cb106-60"><a href="drivers.html#cb106-60" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Red Bull Racing RBPT&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-95-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>It’s pretty clear that both LeClerc and Verstappen stood apart from any other driver in 2022.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="drivers.html#cb107-1" aria-hidden="true" tabindex="-1"></a>qualifying_allyears <span class="sc">%&gt;%</span></span>
<span id="cb107-2"><a href="drivers.html#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Q_secs),</span>
<span id="cb107-3"><a href="drivers.html#cb107-3" aria-hidden="true" tabindex="-1"></a>         Year <span class="sc">==</span> <span class="dv">2022</span>) <span class="sc">%&gt;%</span></span>
<span id="cb107-4"><a href="drivers.html#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Race) <span class="sc">%&gt;%</span></span>
<span id="cb107-5"><a href="drivers.html#cb107-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">track_mean =</span> <span class="fu">mean</span>(Q_secs, <span class="at">na.rm =</span> T),</span>
<span id="cb107-6"><a href="drivers.html#cb107-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Time_std_track =</span> Q_secs <span class="sc">-</span> track_mean) <span class="sc">%&gt;%</span> </span>
<span id="cb107-7"><a href="drivers.html#cb107-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb107-8"><a href="drivers.html#cb107-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Driver) <span class="sc">%&gt;%</span> </span>
<span id="cb107-9"><a href="drivers.html#cb107-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">driver_n =</span> <span class="fu">n</span>(),</span>
<span id="cb107-10"><a href="drivers.html#cb107-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean =</span> <span class="fu">mean</span>(Time_std_track, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb107-11"><a href="drivers.html#cb107-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb107-12"><a href="drivers.html#cb107-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(driver_n <span class="sc">&gt;</span> <span class="dv">15</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb107-13"><a href="drivers.html#cb107-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Time_std_track, <span class="at">y =</span> <span class="fu">fct_reorder</span>(Driver, <span class="fu">desc</span>(mean)))) <span class="sc">+</span></span>
<span id="cb107-14"><a href="drivers.html#cb107-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">w =</span> <span class="dv">0</span>, <span class="at">h =</span> <span class="fl">0.1</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb107-15"><a href="drivers.html#cb107-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">seq</span>(<span class="dv">37</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>), <span class="at">col =</span> <span class="st">&#39;grey&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb107-16"><a href="drivers.html#cb107-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb107-17"><a href="drivers.html#cb107-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Standardized Qualifying Time (secs)&#39;</span>,</span>
<span id="cb107-18"><a href="drivers.html#cb107-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Driver&#39;</span>,</span>
<span id="cb107-19"><a href="drivers.html#cb107-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Standardized Qualifying Time&#39;</span>,</span>
<span id="cb107-20"><a href="drivers.html#cb107-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;2022&#39;</span>,</span>
<span id="cb107-21"><a href="drivers.html#cb107-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;*Times are subtracted from the average time for each Grand Prix&#39;</span>) <span class="sc">+</span></span>
<span id="cb107-22"><a href="drivers.html#cb107-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb107-23"><a href="drivers.html#cb107-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb107-24"><a href="drivers.html#cb107-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb107-25"><a href="drivers.html#cb107-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb107-26"><a href="drivers.html#cb107-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-96-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="section-2" class="section level3 hasAnchor" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> 2021<a href="drivers.html#section-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>During 2021, some head-to-head battles were particularly lop-sided. Pierre Gasly out-qualified Yuki Tsunoda in 21 out of 22 races, while Verstappen out-qualified Perez in 20 out of 22.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="drivers.html#cb108-1" aria-hidden="true" tabindex="-1"></a>quali2021 <span class="ot">&lt;-</span> <span class="fu">qualifying_scraper</span>(<span class="dv">2021</span>)</span>
<span id="cb108-2"><a href="drivers.html#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="drivers.html#cb108-3" aria-hidden="true" tabindex="-1"></a>quali2021 <span class="sc">%&gt;%</span></span>
<span id="cb108-4"><a href="drivers.html#cb108-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb108-5"><a href="drivers.html#cb108-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Race, Position, Car, Driver) <span class="sc">%&gt;%</span></span>
<span id="cb108-6"><a href="drivers.html#cb108-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Position =</span> <span class="fu">as.integer</span>(Position),</span>
<span id="cb108-7"><a href="drivers.html#cb108-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Position =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Position), <span class="dv">21</span>, Position)) <span class="sc">%&gt;%</span> </span>
<span id="cb108-8"><a href="drivers.html#cb108-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Car, Race) <span class="sc">%&gt;%</span> </span>
<span id="cb108-9"><a href="drivers.html#cb108-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Driver) <span class="sc">%&gt;%</span> </span>
<span id="cb108-10"><a href="drivers.html#cb108-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">driver_num =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb108-11"><a href="drivers.html#cb108-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&#39;driver_num&#39;</span>, <span class="at">values_from =</span> <span class="fu">c</span>(<span class="st">&#39;Driver&#39;</span>, <span class="st">&#39;Position&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb108-12"><a href="drivers.html#cb108-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">best_qualifier =</span> <span class="fu">ifelse</span>(Position_1 <span class="sc">&lt;</span> Position_2, Driver_1, Driver_2)) <span class="sc">%&gt;%</span></span>
<span id="cb108-13"><a href="drivers.html#cb108-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb108-14"><a href="drivers.html#cb108-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Car) <span class="sc">%&gt;%</span></span>
<span id="cb108-15"><a href="drivers.html#cb108-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(best_qualifier) <span class="sc">%&gt;%</span></span>
<span id="cb108-16"><a href="drivers.html#cb108-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb108-17"><a href="drivers.html#cb108-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(best_qualifier)) <span class="sc">%&gt;%</span></span>
<span id="cb108-18"><a href="drivers.html#cb108-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fct_reorder</span>(best_qualifier, Car), <span class="at">x =</span> percentage, <span class="at">fill =</span> Car)) <span class="sc">+</span></span>
<span id="cb108-19"><a href="drivers.html#cb108-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span></span>
<span id="cb108-20"><a href="drivers.html#cb108-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb108-21"><a href="drivers.html#cb108-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>()) <span class="sc">+</span></span>
<span id="cb108-22"><a href="drivers.html#cb108-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">factor</span>(Car,</span>
<span id="cb108-23"><a href="drivers.html#cb108-23" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Ferrari&quot;</span>,</span>
<span id="cb108-24"><a href="drivers.html#cb108-24" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Mercedes&quot;</span>,</span>
<span id="cb108-25"><a href="drivers.html#cb108-25" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Haas Ferrari&quot;</span>,</span>
<span id="cb108-26"><a href="drivers.html#cb108-26" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Alpine Renault&quot;</span>,</span>
<span id="cb108-27"><a href="drivers.html#cb108-27" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;AlphaTauri Honda&quot;</span>,</span>
<span id="cb108-28"><a href="drivers.html#cb108-28" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Alfa Romeo Racing Ferrari&quot;</span>, </span>
<span id="cb108-29"><a href="drivers.html#cb108-29" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Aston Martin Mercedes&quot;</span>,</span>
<span id="cb108-30"><a href="drivers.html#cb108-30" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;McLaren Mercedes&quot;</span>,</span>
<span id="cb108-31"><a href="drivers.html#cb108-31" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Williams Mercedes&quot;</span>,</span>
<span id="cb108-32"><a href="drivers.html#cb108-32" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Red Bull Racing Honda&quot;</span>)), <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">strip.position=</span><span class="st">&quot;top&quot;</span>, <span class="at">scales =</span> <span class="st">&#39;free_y&#39;</span>) <span class="sc">+</span></span>
<span id="cb108-33"><a href="drivers.html#cb108-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&#39;Driver&#39;</span>,</span>
<span id="cb108-34"><a href="drivers.html#cb108-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;Season-long Qualifying Win Proportion&#39;</span>,</span>
<span id="cb108-35"><a href="drivers.html#cb108-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Intra-team Qualifying Battles&#39;</span>,</span>
<span id="cb108-36"><a href="drivers.html#cb108-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;2021&#39;</span>) <span class="sc">+</span></span>
<span id="cb108-37"><a href="drivers.html#cb108-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb108-38"><a href="drivers.html#cb108-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb108-39"><a href="drivers.html#cb108-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb108-40"><a href="drivers.html#cb108-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, </span>
<span id="cb108-41"><a href="drivers.html#cb108-41" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;cyan3&quot;</span>,  </span>
<span id="cb108-42"><a href="drivers.html#cb108-42" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;black&quot;</span>, </span>
<span id="cb108-43"><a href="drivers.html#cb108-43" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb108-44"><a href="drivers.html#cb108-44" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;darkslateblue&quot;</span>, </span>
<span id="cb108-45"><a href="drivers.html#cb108-45" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;darkred&quot;</span>,  </span>
<span id="cb108-46"><a href="drivers.html#cb108-46" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;darkseagreen4&quot;</span>, </span>
<span id="cb108-47"><a href="drivers.html#cb108-47" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;darkorange&quot;</span>, </span>
<span id="cb108-48"><a href="drivers.html#cb108-48" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;cornflowerblue&quot;</span>,</span>
<span id="cb108-49"><a href="drivers.html#cb108-49" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;navy&quot;</span>),</span>
<span id="cb108-50"><a href="drivers.html#cb108-50" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;Ferrari&quot;</span>,</span>
<span id="cb108-51"><a href="drivers.html#cb108-51" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Mercedes&quot;</span>,</span>
<span id="cb108-52"><a href="drivers.html#cb108-52" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Haas Ferrari&quot;</span>,</span>
<span id="cb108-53"><a href="drivers.html#cb108-53" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Alpine Renault&quot;</span>,</span>
<span id="cb108-54"><a href="drivers.html#cb108-54" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;AlphaTauri Honda&quot;</span>,</span>
<span id="cb108-55"><a href="drivers.html#cb108-55" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Alfa Romeo Racing Ferrari&quot;</span>, </span>
<span id="cb108-56"><a href="drivers.html#cb108-56" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Aston Martin Mercedes&quot;</span>,</span>
<span id="cb108-57"><a href="drivers.html#cb108-57" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;McLaren Mercedes&quot;</span>,</span>
<span id="cb108-58"><a href="drivers.html#cb108-58" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Williams Mercedes&quot;</span>,</span>
<span id="cb108-59"><a href="drivers.html#cb108-59" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Red Bull Racing Honda&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-97-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Max Verstappen (10) and Lewis Hamilton (5) took 15 of the 22 possible poles in 2021. In fact, Red Bull and Mercedes combined to take all but 3 of the 2021 pole positions.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="drivers.html#cb109-1" aria-hidden="true" tabindex="-1"></a>qualifying_allyears <span class="sc">%&gt;%</span></span>
<span id="cb109-2"><a href="drivers.html#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Q_secs),</span>
<span id="cb109-3"><a href="drivers.html#cb109-3" aria-hidden="true" tabindex="-1"></a>         Year <span class="sc">==</span> <span class="dv">2021</span>) <span class="sc">%&gt;%</span></span>
<span id="cb109-4"><a href="drivers.html#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Race) <span class="sc">%&gt;%</span></span>
<span id="cb109-5"><a href="drivers.html#cb109-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">track_mean =</span> <span class="fu">mean</span>(Q_secs, <span class="at">na.rm =</span> T),</span>
<span id="cb109-6"><a href="drivers.html#cb109-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Time_std_track =</span> Q_secs <span class="sc">-</span> track_mean) <span class="sc">%&gt;%</span> </span>
<span id="cb109-7"><a href="drivers.html#cb109-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb109-8"><a href="drivers.html#cb109-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Driver) <span class="sc">%&gt;%</span> </span>
<span id="cb109-9"><a href="drivers.html#cb109-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">driver_n =</span> <span class="fu">n</span>(),</span>
<span id="cb109-10"><a href="drivers.html#cb109-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean =</span> <span class="fu">mean</span>(Time_std_track, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb109-11"><a href="drivers.html#cb109-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb109-12"><a href="drivers.html#cb109-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(driver_n <span class="sc">&gt;</span> <span class="dv">15</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb109-13"><a href="drivers.html#cb109-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Time_std_track, <span class="at">y =</span> <span class="fu">fct_reorder</span>(Driver, <span class="fu">desc</span>(mean)))) <span class="sc">+</span></span>
<span id="cb109-14"><a href="drivers.html#cb109-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">w =</span> <span class="dv">0</span>, <span class="at">h =</span> <span class="fl">0.1</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb109-15"><a href="drivers.html#cb109-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">seq</span>(<span class="dv">37</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>), <span class="at">col =</span> <span class="st">&#39;grey&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb109-16"><a href="drivers.html#cb109-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb109-17"><a href="drivers.html#cb109-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Standardized Qualifying Time (secs)&#39;</span>,</span>
<span id="cb109-18"><a href="drivers.html#cb109-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Driver&#39;</span>,</span>
<span id="cb109-19"><a href="drivers.html#cb109-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Standardized Qualifying Time&#39;</span>,</span>
<span id="cb109-20"><a href="drivers.html#cb109-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;2021&#39;</span>,</span>
<span id="cb109-21"><a href="drivers.html#cb109-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;*Times are subtracted from the average time for each Grand Prix&#39;</span>) <span class="sc">+</span></span>
<span id="cb109-22"><a href="drivers.html#cb109-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb109-23"><a href="drivers.html#cb109-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb109-24"><a href="drivers.html#cb109-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb109-25"><a href="drivers.html#cb109-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb109-26"><a href="drivers.html#cb109-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-98-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="section-3" class="section level3 hasAnchor" number="5.2.4">
<h3><span class="header-section-number">5.2.4</span> 2020<a href="drivers.html#section-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Mercedes dominated the COVID-shortened 2020 season, winning all but two poles. Lance Stroll took his first career pole during a rainy qualifying session at the Turkish Grand Prix. In the final Grand Prix of the year, Verstappen qualified on pole with the only car <em>not</em> powered by a Mercedes engine in 2020.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="drivers.html#cb110-1" aria-hidden="true" tabindex="-1"></a>quali2020 <span class="ot">&lt;-</span> <span class="fu">qualifying_scraper</span>(<span class="dv">2020</span>)</span>
<span id="cb110-2"><a href="drivers.html#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="drivers.html#cb110-3" aria-hidden="true" tabindex="-1"></a>quali2020 <span class="sc">%&gt;%</span></span>
<span id="cb110-4"><a href="drivers.html#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb110-5"><a href="drivers.html#cb110-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Race, Position, Car, Driver) <span class="sc">%&gt;%</span></span>
<span id="cb110-6"><a href="drivers.html#cb110-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Position =</span> <span class="fu">as.integer</span>(Position),</span>
<span id="cb110-7"><a href="drivers.html#cb110-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Position =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Position), <span class="dv">21</span>, Position)) <span class="sc">%&gt;%</span> </span>
<span id="cb110-8"><a href="drivers.html#cb110-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Car, Race) <span class="sc">%&gt;%</span> </span>
<span id="cb110-9"><a href="drivers.html#cb110-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Driver) <span class="sc">%&gt;%</span> </span>
<span id="cb110-10"><a href="drivers.html#cb110-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">driver_num =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb110-11"><a href="drivers.html#cb110-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&#39;driver_num&#39;</span>, <span class="at">values_from =</span> <span class="fu">c</span>(<span class="st">&#39;Driver&#39;</span>, <span class="st">&#39;Position&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb110-12"><a href="drivers.html#cb110-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">best_qualifier =</span> <span class="fu">ifelse</span>(Position_1 <span class="sc">&lt;</span> Position_2, Driver_1, Driver_2)) <span class="sc">%&gt;%</span></span>
<span id="cb110-13"><a href="drivers.html#cb110-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb110-14"><a href="drivers.html#cb110-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Car) <span class="sc">%&gt;%</span></span>
<span id="cb110-15"><a href="drivers.html#cb110-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(best_qualifier) <span class="sc">%&gt;%</span></span>
<span id="cb110-16"><a href="drivers.html#cb110-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb110-17"><a href="drivers.html#cb110-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(best_qualifier)) <span class="sc">%&gt;%</span></span>
<span id="cb110-18"><a href="drivers.html#cb110-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fct_reorder</span>(best_qualifier, Car), <span class="at">x =</span> percentage, <span class="at">fill =</span> Car)) <span class="sc">+</span></span>
<span id="cb110-19"><a href="drivers.html#cb110-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span></span>
<span id="cb110-20"><a href="drivers.html#cb110-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb110-21"><a href="drivers.html#cb110-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>()) <span class="sc">+</span></span>
<span id="cb110-22"><a href="drivers.html#cb110-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">factor</span>(Car,</span>
<span id="cb110-23"><a href="drivers.html#cb110-23" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Ferrari&quot;</span>,</span>
<span id="cb110-24"><a href="drivers.html#cb110-24" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Mercedes&quot;</span>,</span>
<span id="cb110-25"><a href="drivers.html#cb110-25" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Haas Ferrari&quot;</span>,</span>
<span id="cb110-26"><a href="drivers.html#cb110-26" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Renault&quot;</span>,</span>
<span id="cb110-27"><a href="drivers.html#cb110-27" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;AlphaTauri Honda&quot;</span>,</span>
<span id="cb110-28"><a href="drivers.html#cb110-28" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Alfa Romeo Racing Ferrari&quot;</span>, </span>
<span id="cb110-29"><a href="drivers.html#cb110-29" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Racing Point BWT Mercedes&quot;</span>,</span>
<span id="cb110-30"><a href="drivers.html#cb110-30" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;McLaren Renault&quot;</span>,</span>
<span id="cb110-31"><a href="drivers.html#cb110-31" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Williams Mercedes&quot;</span>,</span>
<span id="cb110-32"><a href="drivers.html#cb110-32" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Red Bull Racing Honda&quot;</span>)), <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">strip.position=</span><span class="st">&quot;top&quot;</span>, <span class="at">scales =</span> <span class="st">&#39;free_y&#39;</span>) <span class="sc">+</span></span>
<span id="cb110-33"><a href="drivers.html#cb110-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&#39;Driver&#39;</span>,</span>
<span id="cb110-34"><a href="drivers.html#cb110-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;Season-long Qualifying Win Proportion&#39;</span>,</span>
<span id="cb110-35"><a href="drivers.html#cb110-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Intra-team Qualifying Battles&#39;</span>,</span>
<span id="cb110-36"><a href="drivers.html#cb110-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;2020&#39;</span>) <span class="sc">+</span></span>
<span id="cb110-37"><a href="drivers.html#cb110-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb110-38"><a href="drivers.html#cb110-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb110-39"><a href="drivers.html#cb110-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb110-40"><a href="drivers.html#cb110-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, </span>
<span id="cb110-41"><a href="drivers.html#cb110-41" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;cyan3&quot;</span>,  </span>
<span id="cb110-42"><a href="drivers.html#cb110-42" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;black&quot;</span>, </span>
<span id="cb110-43"><a href="drivers.html#cb110-43" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;yellow&quot;</span>,</span>
<span id="cb110-44"><a href="drivers.html#cb110-44" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;darkslateblue&quot;</span>, </span>
<span id="cb110-45"><a href="drivers.html#cb110-45" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;darkred&quot;</span>,  </span>
<span id="cb110-46"><a href="drivers.html#cb110-46" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;pink&quot;</span>, </span>
<span id="cb110-47"><a href="drivers.html#cb110-47" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;darkorange&quot;</span>, </span>
<span id="cb110-48"><a href="drivers.html#cb110-48" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;cornflowerblue&quot;</span>,</span>
<span id="cb110-49"><a href="drivers.html#cb110-49" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;navy&quot;</span>),</span>
<span id="cb110-50"><a href="drivers.html#cb110-50" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;Ferrari&quot;</span>,</span>
<span id="cb110-51"><a href="drivers.html#cb110-51" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Mercedes&quot;</span>,</span>
<span id="cb110-52"><a href="drivers.html#cb110-52" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Haas Ferrari&quot;</span>,</span>
<span id="cb110-53"><a href="drivers.html#cb110-53" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Renault&quot;</span>,</span>
<span id="cb110-54"><a href="drivers.html#cb110-54" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;AlphaTauri Honda&quot;</span>,</span>
<span id="cb110-55"><a href="drivers.html#cb110-55" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Alfa Romeo Racing Ferrari&quot;</span>, </span>
<span id="cb110-56"><a href="drivers.html#cb110-56" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Racing Point BWT Mercedes&quot;</span>,</span>
<span id="cb110-57"><a href="drivers.html#cb110-57" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;McLaren Renault&quot;</span>,</span>
<span id="cb110-58"><a href="drivers.html#cb110-58" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Williams Mercedes&quot;</span>,</span>
<span id="cb110-59"><a href="drivers.html#cb110-59" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Red Bull Racing Honda&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-99-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>And, here’s a look at 2020’s standardized qualifying times.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="drivers.html#cb111-1" aria-hidden="true" tabindex="-1"></a>qualifying_allyears <span class="sc">%&gt;%</span></span>
<span id="cb111-2"><a href="drivers.html#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Q_secs),</span>
<span id="cb111-3"><a href="drivers.html#cb111-3" aria-hidden="true" tabindex="-1"></a>         Year <span class="sc">==</span> <span class="dv">2020</span>) <span class="sc">%&gt;%</span></span>
<span id="cb111-4"><a href="drivers.html#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Race) <span class="sc">%&gt;%</span></span>
<span id="cb111-5"><a href="drivers.html#cb111-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">track_mean =</span> <span class="fu">mean</span>(Q_secs, <span class="at">na.rm =</span> T),</span>
<span id="cb111-6"><a href="drivers.html#cb111-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Time_std_track =</span> Q_secs <span class="sc">-</span> track_mean) <span class="sc">%&gt;%</span> </span>
<span id="cb111-7"><a href="drivers.html#cb111-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb111-8"><a href="drivers.html#cb111-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Driver) <span class="sc">%&gt;%</span> </span>
<span id="cb111-9"><a href="drivers.html#cb111-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">driver_n =</span> <span class="fu">n</span>(),</span>
<span id="cb111-10"><a href="drivers.html#cb111-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean =</span> <span class="fu">mean</span>(Time_std_track, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb111-11"><a href="drivers.html#cb111-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb111-12"><a href="drivers.html#cb111-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(driver_n <span class="sc">&gt;</span> <span class="dv">15</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb111-13"><a href="drivers.html#cb111-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Time_std_track, <span class="at">y =</span> <span class="fu">fct_reorder</span>(Driver, <span class="fu">desc</span>(mean)))) <span class="sc">+</span></span>
<span id="cb111-14"><a href="drivers.html#cb111-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">w =</span> <span class="dv">0</span>, <span class="at">h =</span> <span class="fl">0.1</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb111-15"><a href="drivers.html#cb111-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">seq</span>(<span class="dv">37</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>), <span class="at">col =</span> <span class="st">&#39;grey&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb111-16"><a href="drivers.html#cb111-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb111-17"><a href="drivers.html#cb111-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Standardized Qualifying Time (secs)&#39;</span>,</span>
<span id="cb111-18"><a href="drivers.html#cb111-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Driver&#39;</span>,</span>
<span id="cb111-19"><a href="drivers.html#cb111-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Standardized Qualifying Time&#39;</span>,</span>
<span id="cb111-20"><a href="drivers.html#cb111-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;2020&#39;</span>,</span>
<span id="cb111-21"><a href="drivers.html#cb111-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;*Times are subtracted from the average time for each Grand Prix&#39;</span>) <span class="sc">+</span></span>
<span id="cb111-22"><a href="drivers.html#cb111-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb111-23"><a href="drivers.html#cb111-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb111-24"><a href="drivers.html#cb111-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb111-25"><a href="drivers.html#cb111-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb111-26"><a href="drivers.html#cb111-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-100-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="section-4" class="section level3 hasAnchor" number="5.2.5">
<h3><span class="header-section-number">5.2.5</span> 2019<a href="drivers.html#section-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Qualifying during 2019 was quite close between Mercedes (10 poles) and Ferrari (9 poles). Charles LeClerc qualified on pole 7 times, while Valterri Bottas and Lewis Hamilton both finished with 5 pole positions each.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="drivers.html#cb112-1" aria-hidden="true" tabindex="-1"></a>quali2019 <span class="ot">&lt;-</span> <span class="fu">qualifying_scraper</span>(<span class="dv">2019</span>)</span>
<span id="cb112-2"><a href="drivers.html#cb112-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-3"><a href="drivers.html#cb112-3" aria-hidden="true" tabindex="-1"></a>quali2019 <span class="sc">%&gt;%</span></span>
<span id="cb112-4"><a href="drivers.html#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb112-5"><a href="drivers.html#cb112-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Race, Position, Car, Driver) <span class="sc">%&gt;%</span></span>
<span id="cb112-6"><a href="drivers.html#cb112-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Position =</span> <span class="fu">as.integer</span>(Position),</span>
<span id="cb112-7"><a href="drivers.html#cb112-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Position =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Position), <span class="dv">21</span>, Position)) <span class="sc">%&gt;%</span> </span>
<span id="cb112-8"><a href="drivers.html#cb112-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Car, Race) <span class="sc">%&gt;%</span> </span>
<span id="cb112-9"><a href="drivers.html#cb112-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Driver) <span class="sc">%&gt;%</span> </span>
<span id="cb112-10"><a href="drivers.html#cb112-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">driver_num =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb112-11"><a href="drivers.html#cb112-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&#39;driver_num&#39;</span>, <span class="at">values_from =</span> <span class="fu">c</span>(<span class="st">&#39;Driver&#39;</span>, <span class="st">&#39;Position&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb112-12"><a href="drivers.html#cb112-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">best_qualifier =</span> <span class="fu">ifelse</span>(Position_1 <span class="sc">&lt;</span> Position_2, Driver_1, Driver_2)) <span class="sc">%&gt;%</span></span>
<span id="cb112-13"><a href="drivers.html#cb112-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb112-14"><a href="drivers.html#cb112-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Car) <span class="sc">%&gt;%</span></span>
<span id="cb112-15"><a href="drivers.html#cb112-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(best_qualifier) <span class="sc">%&gt;%</span></span>
<span id="cb112-16"><a href="drivers.html#cb112-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb112-17"><a href="drivers.html#cb112-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(best_qualifier)) <span class="sc">%&gt;%</span></span>
<span id="cb112-18"><a href="drivers.html#cb112-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fct_reorder</span>(best_qualifier, Car), <span class="at">x =</span> percentage, <span class="at">fill =</span> Car)) <span class="sc">+</span></span>
<span id="cb112-19"><a href="drivers.html#cb112-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span></span>
<span id="cb112-20"><a href="drivers.html#cb112-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb112-21"><a href="drivers.html#cb112-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>()) <span class="sc">+</span></span>
<span id="cb112-22"><a href="drivers.html#cb112-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">factor</span>(Car,</span>
<span id="cb112-23"><a href="drivers.html#cb112-23" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Ferrari&quot;</span>,</span>
<span id="cb112-24"><a href="drivers.html#cb112-24" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Mercedes&quot;</span>,</span>
<span id="cb112-25"><a href="drivers.html#cb112-25" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Haas Ferrari&quot;</span>,</span>
<span id="cb112-26"><a href="drivers.html#cb112-26" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Renault&quot;</span>,</span>
<span id="cb112-27"><a href="drivers.html#cb112-27" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Scuderia Toro Rosso Honda&quot;</span>,</span>
<span id="cb112-28"><a href="drivers.html#cb112-28" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Alfa Romeo Racing Ferrari&quot;</span>, </span>
<span id="cb112-29"><a href="drivers.html#cb112-29" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Racing Point BWT Mercedes&quot;</span>,</span>
<span id="cb112-30"><a href="drivers.html#cb112-30" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;McLaren Renault&quot;</span>,</span>
<span id="cb112-31"><a href="drivers.html#cb112-31" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Williams Mercedes&quot;</span>,</span>
<span id="cb112-32"><a href="drivers.html#cb112-32" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Red Bull Racing Honda&quot;</span>)), <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">strip.position=</span><span class="st">&quot;top&quot;</span>, <span class="at">scales =</span> <span class="st">&#39;free_y&#39;</span>) <span class="sc">+</span></span>
<span id="cb112-33"><a href="drivers.html#cb112-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&#39;Driver&#39;</span>,</span>
<span id="cb112-34"><a href="drivers.html#cb112-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;Season-long Qualifying Win Proportion&#39;</span>,</span>
<span id="cb112-35"><a href="drivers.html#cb112-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Intra-team Qualifying Battles&#39;</span>,</span>
<span id="cb112-36"><a href="drivers.html#cb112-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;2019&#39;</span>) <span class="sc">+</span></span>
<span id="cb112-37"><a href="drivers.html#cb112-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb112-38"><a href="drivers.html#cb112-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb112-39"><a href="drivers.html#cb112-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb112-40"><a href="drivers.html#cb112-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, </span>
<span id="cb112-41"><a href="drivers.html#cb112-41" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;cyan3&quot;</span>,  </span>
<span id="cb112-42"><a href="drivers.html#cb112-42" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;black&quot;</span>, </span>
<span id="cb112-43"><a href="drivers.html#cb112-43" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;yellow&quot;</span>,</span>
<span id="cb112-44"><a href="drivers.html#cb112-44" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;darkslateblue&quot;</span>, </span>
<span id="cb112-45"><a href="drivers.html#cb112-45" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;darkred&quot;</span>,  </span>
<span id="cb112-46"><a href="drivers.html#cb112-46" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;pink&quot;</span>, </span>
<span id="cb112-47"><a href="drivers.html#cb112-47" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;darkorange&quot;</span>, </span>
<span id="cb112-48"><a href="drivers.html#cb112-48" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;cornflowerblue&quot;</span>,</span>
<span id="cb112-49"><a href="drivers.html#cb112-49" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;navy&quot;</span>),</span>
<span id="cb112-50"><a href="drivers.html#cb112-50" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;Ferrari&quot;</span>,</span>
<span id="cb112-51"><a href="drivers.html#cb112-51" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Mercedes&quot;</span>,</span>
<span id="cb112-52"><a href="drivers.html#cb112-52" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Haas Ferrari&quot;</span>,</span>
<span id="cb112-53"><a href="drivers.html#cb112-53" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Renault&quot;</span>,</span>
<span id="cb112-54"><a href="drivers.html#cb112-54" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;AlphaTauri Honda&quot;</span>,</span>
<span id="cb112-55"><a href="drivers.html#cb112-55" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Alfa Romeo Racing Ferrari&quot;</span>, </span>
<span id="cb112-56"><a href="drivers.html#cb112-56" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Racing Point BWT Mercedes&quot;</span>,</span>
<span id="cb112-57"><a href="drivers.html#cb112-57" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;McLaren Renault&quot;</span>,</span>
<span id="cb112-58"><a href="drivers.html#cb112-58" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Williams Mercedes&quot;</span>,</span>
<span id="cb112-59"><a href="drivers.html#cb112-59" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Red Bull Racing Honda&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-101-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>When we look at the standardized qualifying times in 2019, five drivers are clearly faster than the rest of the grid: both Mercedes drivers, both Ferrari drivers, and Max Verstappen.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="drivers.html#cb113-1" aria-hidden="true" tabindex="-1"></a>qualifying_allyears <span class="sc">%&gt;%</span></span>
<span id="cb113-2"><a href="drivers.html#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Q_secs),</span>
<span id="cb113-3"><a href="drivers.html#cb113-3" aria-hidden="true" tabindex="-1"></a>         Year <span class="sc">==</span> <span class="dv">2019</span>) <span class="sc">%&gt;%</span></span>
<span id="cb113-4"><a href="drivers.html#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Race) <span class="sc">%&gt;%</span></span>
<span id="cb113-5"><a href="drivers.html#cb113-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">track_mean =</span> <span class="fu">mean</span>(Q_secs, <span class="at">na.rm =</span> T),</span>
<span id="cb113-6"><a href="drivers.html#cb113-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Time_std_track =</span> Q_secs <span class="sc">-</span> track_mean) <span class="sc">%&gt;%</span> </span>
<span id="cb113-7"><a href="drivers.html#cb113-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb113-8"><a href="drivers.html#cb113-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Driver) <span class="sc">%&gt;%</span> </span>
<span id="cb113-9"><a href="drivers.html#cb113-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">driver_n =</span> <span class="fu">n</span>(),</span>
<span id="cb113-10"><a href="drivers.html#cb113-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean =</span> <span class="fu">mean</span>(Time_std_track, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb113-11"><a href="drivers.html#cb113-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb113-12"><a href="drivers.html#cb113-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(driver_n <span class="sc">&gt;</span> <span class="dv">15</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb113-13"><a href="drivers.html#cb113-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Time_std_track, <span class="at">y =</span> <span class="fu">fct_reorder</span>(Driver, <span class="fu">desc</span>(mean)))) <span class="sc">+</span></span>
<span id="cb113-14"><a href="drivers.html#cb113-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">w =</span> <span class="dv">0</span>, <span class="at">h =</span> <span class="fl">0.1</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb113-15"><a href="drivers.html#cb113-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">seq</span>(<span class="dv">37</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>), <span class="at">col =</span> <span class="st">&#39;grey&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb113-16"><a href="drivers.html#cb113-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb113-17"><a href="drivers.html#cb113-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Standardized Qualifying Time (secs)&#39;</span>,</span>
<span id="cb113-18"><a href="drivers.html#cb113-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Driver&#39;</span>,</span>
<span id="cb113-19"><a href="drivers.html#cb113-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Standardized Qualifying Time&#39;</span>,</span>
<span id="cb113-20"><a href="drivers.html#cb113-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;2019&#39;</span>,</span>
<span id="cb113-21"><a href="drivers.html#cb113-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;*Times are subtracted from the average time for each Grand Prix&#39;</span>) <span class="sc">+</span></span>
<span id="cb113-22"><a href="drivers.html#cb113-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb113-23"><a href="drivers.html#cb113-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb113-24"><a href="drivers.html#cb113-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb113-25"><a href="drivers.html#cb113-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb113-26"><a href="drivers.html#cb113-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-102-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="section-5" class="section level3 hasAnchor" number="5.2.6">
<h3><span class="header-section-number">5.2.6</span> 2018<a href="drivers.html#section-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>During the 2018 season, Lewis Hamilton and Sebastian Vettel battled closely for pole positions. Here’s a look at the intra-team battles.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="drivers.html#cb114-1" aria-hidden="true" tabindex="-1"></a>quali2018 <span class="ot">&lt;-</span> <span class="fu">qualifying_scraper</span>(<span class="dv">2018</span>)</span>
<span id="cb114-2"><a href="drivers.html#cb114-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3"><a href="drivers.html#cb114-3" aria-hidden="true" tabindex="-1"></a>quali2018 <span class="sc">%&gt;%</span></span>
<span id="cb114-4"><a href="drivers.html#cb114-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb114-5"><a href="drivers.html#cb114-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Race, Position, Car, Driver) <span class="sc">%&gt;%</span></span>
<span id="cb114-6"><a href="drivers.html#cb114-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Position =</span> <span class="fu">as.integer</span>(Position),</span>
<span id="cb114-7"><a href="drivers.html#cb114-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Position =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Position), <span class="dv">21</span>, Position)) <span class="sc">%&gt;%</span> </span>
<span id="cb114-8"><a href="drivers.html#cb114-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Car, Race) <span class="sc">%&gt;%</span> </span>
<span id="cb114-9"><a href="drivers.html#cb114-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Driver) <span class="sc">%&gt;%</span> </span>
<span id="cb114-10"><a href="drivers.html#cb114-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">driver_num =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb114-11"><a href="drivers.html#cb114-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&#39;driver_num&#39;</span>, <span class="at">values_from =</span> <span class="fu">c</span>(<span class="st">&#39;Driver&#39;</span>, <span class="st">&#39;Position&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb114-12"><a href="drivers.html#cb114-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">best_qualifier =</span> <span class="fu">ifelse</span>(Position_1 <span class="sc">&lt;</span> Position_2, Driver_1, Driver_2)) <span class="sc">%&gt;%</span></span>
<span id="cb114-13"><a href="drivers.html#cb114-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb114-14"><a href="drivers.html#cb114-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Car) <span class="sc">%&gt;%</span></span>
<span id="cb114-15"><a href="drivers.html#cb114-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(best_qualifier) <span class="sc">%&gt;%</span></span>
<span id="cb114-16"><a href="drivers.html#cb114-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb114-17"><a href="drivers.html#cb114-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(best_qualifier)) <span class="sc">%&gt;%</span></span>
<span id="cb114-18"><a href="drivers.html#cb114-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fct_reorder</span>(best_qualifier, Car), <span class="at">x =</span> percentage, <span class="at">fill =</span> Car)) <span class="sc">+</span></span>
<span id="cb114-19"><a href="drivers.html#cb114-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span></span>
<span id="cb114-20"><a href="drivers.html#cb114-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb114-21"><a href="drivers.html#cb114-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>()) <span class="sc">+</span></span>
<span id="cb114-22"><a href="drivers.html#cb114-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">factor</span>(Car,</span>
<span id="cb114-23"><a href="drivers.html#cb114-23" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Ferrari&quot;</span>,</span>
<span id="cb114-24"><a href="drivers.html#cb114-24" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Mercedes&quot;</span>,</span>
<span id="cb114-25"><a href="drivers.html#cb114-25" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Haas Ferrari&quot;</span>,</span>
<span id="cb114-26"><a href="drivers.html#cb114-26" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Renault&quot;</span>,</span>
<span id="cb114-27"><a href="drivers.html#cb114-27" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Scuderia Toro Rosso Honda&quot;</span>,</span>
<span id="cb114-28"><a href="drivers.html#cb114-28" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Sauber Ferrari&quot;</span>, </span>
<span id="cb114-29"><a href="drivers.html#cb114-29" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Force India Mercedes&quot;</span>,</span>
<span id="cb114-30"><a href="drivers.html#cb114-30" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;McLaren Renault&quot;</span>,</span>
<span id="cb114-31"><a href="drivers.html#cb114-31" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Williams Mercedes&quot;</span>,</span>
<span id="cb114-32"><a href="drivers.html#cb114-32" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Red Bull Racing TAG Heuer&quot;</span>)), <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">strip.position=</span><span class="st">&quot;top&quot;</span>, <span class="at">scales =</span> <span class="st">&#39;free_y&#39;</span>) <span class="sc">+</span></span>
<span id="cb114-33"><a href="drivers.html#cb114-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&#39;Driver&#39;</span>,</span>
<span id="cb114-34"><a href="drivers.html#cb114-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;Season-long Qualifying Win Proportion&#39;</span>,</span>
<span id="cb114-35"><a href="drivers.html#cb114-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Intra-team Qualifying Battles&#39;</span>,</span>
<span id="cb114-36"><a href="drivers.html#cb114-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;2018&#39;</span>) <span class="sc">+</span></span>
<span id="cb114-37"><a href="drivers.html#cb114-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb114-38"><a href="drivers.html#cb114-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb114-39"><a href="drivers.html#cb114-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb114-40"><a href="drivers.html#cb114-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, </span>
<span id="cb114-41"><a href="drivers.html#cb114-41" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;cyan3&quot;</span>,  </span>
<span id="cb114-42"><a href="drivers.html#cb114-42" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;black&quot;</span>, </span>
<span id="cb114-43"><a href="drivers.html#cb114-43" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;yellow&quot;</span>,</span>
<span id="cb114-44"><a href="drivers.html#cb114-44" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;darkslateblue&quot;</span>, </span>
<span id="cb114-45"><a href="drivers.html#cb114-45" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;darkred&quot;</span>,  </span>
<span id="cb114-46"><a href="drivers.html#cb114-46" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;pink&quot;</span>, </span>
<span id="cb114-47"><a href="drivers.html#cb114-47" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;darkorange&quot;</span>, </span>
<span id="cb114-48"><a href="drivers.html#cb114-48" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;cornflowerblue&quot;</span>,</span>
<span id="cb114-49"><a href="drivers.html#cb114-49" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;navy&quot;</span>),</span>
<span id="cb114-50"><a href="drivers.html#cb114-50" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;Ferrari&quot;</span>,</span>
<span id="cb114-51"><a href="drivers.html#cb114-51" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Mercedes&quot;</span>,</span>
<span id="cb114-52"><a href="drivers.html#cb114-52" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Haas Ferrari&quot;</span>,</span>
<span id="cb114-53"><a href="drivers.html#cb114-53" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Renault&quot;</span>,</span>
<span id="cb114-54"><a href="drivers.html#cb114-54" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Scuderia Toro Rosso Honda&quot;</span>,</span>
<span id="cb114-55"><a href="drivers.html#cb114-55" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Sauber Ferrari&quot;</span>, </span>
<span id="cb114-56"><a href="drivers.html#cb114-56" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Force India Mercedes&quot;</span>,</span>
<span id="cb114-57"><a href="drivers.html#cb114-57" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;McLaren Renault&quot;</span>,</span>
<span id="cb114-58"><a href="drivers.html#cb114-58" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Williams Mercedes&quot;</span>,</span>
<span id="cb114-59"><a href="drivers.html#cb114-59" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Red Bull Racing TAG Heuer&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-103-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Every race during the 2018 season featured either Hamilton or Vettel on the front row of the grid. In fact, Hamilton and Vettel had average starting positions of 2.48 and 2.62, respectively.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="drivers.html#cb115-1" aria-hidden="true" tabindex="-1"></a>qualifying_allyears <span class="sc">%&gt;%</span></span>
<span id="cb115-2"><a href="drivers.html#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Q_secs),</span>
<span id="cb115-3"><a href="drivers.html#cb115-3" aria-hidden="true" tabindex="-1"></a>         Year <span class="sc">==</span> <span class="dv">2018</span>) <span class="sc">%&gt;%</span></span>
<span id="cb115-4"><a href="drivers.html#cb115-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Race) <span class="sc">%&gt;%</span></span>
<span id="cb115-5"><a href="drivers.html#cb115-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">track_mean =</span> <span class="fu">mean</span>(Q_secs, <span class="at">na.rm =</span> T),</span>
<span id="cb115-6"><a href="drivers.html#cb115-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Time_std_track =</span> Q_secs <span class="sc">-</span> track_mean) <span class="sc">%&gt;%</span> </span>
<span id="cb115-7"><a href="drivers.html#cb115-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb115-8"><a href="drivers.html#cb115-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Driver) <span class="sc">%&gt;%</span> </span>
<span id="cb115-9"><a href="drivers.html#cb115-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">driver_n =</span> <span class="fu">n</span>(),</span>
<span id="cb115-10"><a href="drivers.html#cb115-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean =</span> <span class="fu">mean</span>(Time_std_track, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb115-11"><a href="drivers.html#cb115-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb115-12"><a href="drivers.html#cb115-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(driver_n <span class="sc">&gt;</span> <span class="dv">15</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb115-13"><a href="drivers.html#cb115-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Time_std_track, <span class="at">y =</span> <span class="fu">fct_reorder</span>(Driver, <span class="fu">desc</span>(mean)))) <span class="sc">+</span></span>
<span id="cb115-14"><a href="drivers.html#cb115-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">w =</span> <span class="dv">0</span>, <span class="at">h =</span> <span class="fl">0.1</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb115-15"><a href="drivers.html#cb115-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">seq</span>(<span class="dv">37</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>), <span class="at">col =</span> <span class="st">&#39;grey&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb115-16"><a href="drivers.html#cb115-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb115-17"><a href="drivers.html#cb115-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Standardized Qualifying Time (secs)&#39;</span>,</span>
<span id="cb115-18"><a href="drivers.html#cb115-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Driver&#39;</span>,</span>
<span id="cb115-19"><a href="drivers.html#cb115-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Standardized Qualifying Time&#39;</span>,</span>
<span id="cb115-20"><a href="drivers.html#cb115-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;2018&#39;</span>,</span>
<span id="cb115-21"><a href="drivers.html#cb115-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;*Times are subtracted from the average time for each Grand Prix&#39;</span>) <span class="sc">+</span></span>
<span id="cb115-22"><a href="drivers.html#cb115-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb115-23"><a href="drivers.html#cb115-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb115-24"><a href="drivers.html#cb115-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb115-25"><a href="drivers.html#cb115-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb115-26"><a href="drivers.html#cb115-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-104-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="section-6" class="section level3 hasAnchor" number="5.2.7">
<h3><span class="header-section-number">5.2.7</span> 2017<a href="drivers.html#section-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>During 2017, only two teams (Mercedes and Ferrari) qualified on pole. Impressively, Hamilton achieved pole position in over half the races (11/ 20).</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="drivers.html#cb116-1" aria-hidden="true" tabindex="-1"></a>quali2017 <span class="ot">&lt;-</span> <span class="fu">qualifying_scraper</span>(<span class="dv">2017</span>)</span>
<span id="cb116-2"><a href="drivers.html#cb116-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3"><a href="drivers.html#cb116-3" aria-hidden="true" tabindex="-1"></a>quali2017 <span class="sc">%&gt;%</span></span>
<span id="cb116-4"><a href="drivers.html#cb116-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb116-5"><a href="drivers.html#cb116-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Race, Position, Car, Driver) <span class="sc">%&gt;%</span></span>
<span id="cb116-6"><a href="drivers.html#cb116-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Position =</span> <span class="fu">as.integer</span>(Position),</span>
<span id="cb116-7"><a href="drivers.html#cb116-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Position =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Position), <span class="dv">21</span>, Position)) <span class="sc">%&gt;%</span> </span>
<span id="cb116-8"><a href="drivers.html#cb116-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Car, Race) <span class="sc">%&gt;%</span> </span>
<span id="cb116-9"><a href="drivers.html#cb116-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Driver) <span class="sc">%&gt;%</span> </span>
<span id="cb116-10"><a href="drivers.html#cb116-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">driver_num =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb116-11"><a href="drivers.html#cb116-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&#39;driver_num&#39;</span>, <span class="at">values_from =</span> <span class="fu">c</span>(<span class="st">&#39;Driver&#39;</span>, <span class="st">&#39;Position&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb116-12"><a href="drivers.html#cb116-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">best_qualifier =</span> <span class="fu">ifelse</span>(Position_1 <span class="sc">&lt;</span> Position_2, Driver_1, Driver_2)) <span class="sc">%&gt;%</span></span>
<span id="cb116-13"><a href="drivers.html#cb116-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb116-14"><a href="drivers.html#cb116-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Car) <span class="sc">%&gt;%</span></span>
<span id="cb116-15"><a href="drivers.html#cb116-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(best_qualifier) <span class="sc">%&gt;%</span></span>
<span id="cb116-16"><a href="drivers.html#cb116-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb116-17"><a href="drivers.html#cb116-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(best_qualifier)) <span class="sc">%&gt;%</span></span>
<span id="cb116-18"><a href="drivers.html#cb116-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fct_reorder</span>(best_qualifier, Car), <span class="at">x =</span> percentage, <span class="at">fill =</span> Car)) <span class="sc">+</span></span>
<span id="cb116-19"><a href="drivers.html#cb116-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span></span>
<span id="cb116-20"><a href="drivers.html#cb116-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb116-21"><a href="drivers.html#cb116-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>()) <span class="sc">+</span></span>
<span id="cb116-22"><a href="drivers.html#cb116-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">factor</span>(Car,</span>
<span id="cb116-23"><a href="drivers.html#cb116-23" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Ferrari&quot;</span>,</span>
<span id="cb116-24"><a href="drivers.html#cb116-24" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Mercedes&quot;</span>,</span>
<span id="cb116-25"><a href="drivers.html#cb116-25" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Haas Ferrari&quot;</span>,</span>
<span id="cb116-26"><a href="drivers.html#cb116-26" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Renault&quot;</span>,</span>
<span id="cb116-27"><a href="drivers.html#cb116-27" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Toro Rosso&quot;</span>,</span>
<span id="cb116-28"><a href="drivers.html#cb116-28" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Sauber Ferrari&quot;</span>, </span>
<span id="cb116-29"><a href="drivers.html#cb116-29" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Force India Mercedes&quot;</span>,</span>
<span id="cb116-30"><a href="drivers.html#cb116-30" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;McLaren Honda&quot;</span>,</span>
<span id="cb116-31"><a href="drivers.html#cb116-31" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Williams Mercedes&quot;</span>,</span>
<span id="cb116-32"><a href="drivers.html#cb116-32" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Red Bull Racing TAG Heuer&quot;</span>)), <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">strip.position=</span><span class="st">&quot;top&quot;</span>, <span class="at">scales =</span> <span class="st">&#39;free_y&#39;</span>) <span class="sc">+</span></span>
<span id="cb116-33"><a href="drivers.html#cb116-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&#39;Driver&#39;</span>,</span>
<span id="cb116-34"><a href="drivers.html#cb116-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;Season-long Qualifying Win Proportion&#39;</span>,</span>
<span id="cb116-35"><a href="drivers.html#cb116-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Intra-team Qualifying Battles&#39;</span>,</span>
<span id="cb116-36"><a href="drivers.html#cb116-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;2017&#39;</span>) <span class="sc">+</span></span>
<span id="cb116-37"><a href="drivers.html#cb116-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb116-38"><a href="drivers.html#cb116-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb116-39"><a href="drivers.html#cb116-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb116-40"><a href="drivers.html#cb116-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, </span>
<span id="cb116-41"><a href="drivers.html#cb116-41" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;cyan3&quot;</span>,  </span>
<span id="cb116-42"><a href="drivers.html#cb116-42" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;black&quot;</span>, </span>
<span id="cb116-43"><a href="drivers.html#cb116-43" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;yellow&quot;</span>,</span>
<span id="cb116-44"><a href="drivers.html#cb116-44" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;darkslateblue&quot;</span>, </span>
<span id="cb116-45"><a href="drivers.html#cb116-45" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;darkred&quot;</span>,  </span>
<span id="cb116-46"><a href="drivers.html#cb116-46" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;pink&quot;</span>, </span>
<span id="cb116-47"><a href="drivers.html#cb116-47" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;darkorange&quot;</span>, </span>
<span id="cb116-48"><a href="drivers.html#cb116-48" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;cornflowerblue&quot;</span>,</span>
<span id="cb116-49"><a href="drivers.html#cb116-49" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;navy&quot;</span>),</span>
<span id="cb116-50"><a href="drivers.html#cb116-50" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;Ferrari&quot;</span>,</span>
<span id="cb116-51"><a href="drivers.html#cb116-51" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Mercedes&quot;</span>,</span>
<span id="cb116-52"><a href="drivers.html#cb116-52" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Haas Ferrari&quot;</span>,</span>
<span id="cb116-53"><a href="drivers.html#cb116-53" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Renault&quot;</span>,</span>
<span id="cb116-54"><a href="drivers.html#cb116-54" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Scuderia Toro Rosso Honda&quot;</span>,</span>
<span id="cb116-55"><a href="drivers.html#cb116-55" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Sauber Ferrari&quot;</span>, </span>
<span id="cb116-56"><a href="drivers.html#cb116-56" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Force India Mercedes&quot;</span>,</span>
<span id="cb116-57"><a href="drivers.html#cb116-57" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;McLaren Honda&quot;</span>,</span>
<span id="cb116-58"><a href="drivers.html#cb116-58" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Williams Mercedes&quot;</span>,</span>
<span id="cb116-59"><a href="drivers.html#cb116-59" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Red Bull Racing TAG Heuer&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-105-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Interestingly, only Bottas and Kimi Raikkonen reached Q3 in every Grand Prix of the season.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="drivers.html#cb117-1" aria-hidden="true" tabindex="-1"></a>qualifying_allyears <span class="sc">%&gt;%</span></span>
<span id="cb117-2"><a href="drivers.html#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Q_secs),</span>
<span id="cb117-3"><a href="drivers.html#cb117-3" aria-hidden="true" tabindex="-1"></a>         Year <span class="sc">==</span> <span class="dv">2017</span>) <span class="sc">%&gt;%</span></span>
<span id="cb117-4"><a href="drivers.html#cb117-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Race) <span class="sc">%&gt;%</span></span>
<span id="cb117-5"><a href="drivers.html#cb117-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">track_mean =</span> <span class="fu">mean</span>(Q_secs, <span class="at">na.rm =</span> T),</span>
<span id="cb117-6"><a href="drivers.html#cb117-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Time_std_track =</span> Q_secs <span class="sc">-</span> track_mean) <span class="sc">%&gt;%</span> </span>
<span id="cb117-7"><a href="drivers.html#cb117-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb117-8"><a href="drivers.html#cb117-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Driver) <span class="sc">%&gt;%</span> </span>
<span id="cb117-9"><a href="drivers.html#cb117-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">driver_n =</span> <span class="fu">n</span>(),</span>
<span id="cb117-10"><a href="drivers.html#cb117-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean =</span> <span class="fu">mean</span>(Time_std_track, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb117-11"><a href="drivers.html#cb117-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb117-12"><a href="drivers.html#cb117-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(driver_n <span class="sc">&gt;</span> <span class="dv">15</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb117-13"><a href="drivers.html#cb117-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Time_std_track, <span class="at">y =</span> <span class="fu">fct_reorder</span>(Driver, <span class="fu">desc</span>(mean)))) <span class="sc">+</span></span>
<span id="cb117-14"><a href="drivers.html#cb117-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">w =</span> <span class="dv">0</span>, <span class="at">h =</span> <span class="fl">0.1</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb117-15"><a href="drivers.html#cb117-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">seq</span>(<span class="dv">37</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>), <span class="at">col =</span> <span class="st">&#39;grey&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb117-16"><a href="drivers.html#cb117-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb117-17"><a href="drivers.html#cb117-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Standardized Qualifying Time (secs)&#39;</span>,</span>
<span id="cb117-18"><a href="drivers.html#cb117-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Driver&#39;</span>,</span>
<span id="cb117-19"><a href="drivers.html#cb117-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Standardized Qualifying Time&#39;</span>,</span>
<span id="cb117-20"><a href="drivers.html#cb117-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;2017&#39;</span>,</span>
<span id="cb117-21"><a href="drivers.html#cb117-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;*Times are subtracted from the average time for each Grand Prix&#39;</span>) <span class="sc">+</span></span>
<span id="cb117-22"><a href="drivers.html#cb117-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb117-23"><a href="drivers.html#cb117-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb117-24"><a href="drivers.html#cb117-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb117-25"><a href="drivers.html#cb117-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb117-26"><a href="drivers.html#cb117-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-106-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="section-7" class="section level3 hasAnchor" number="5.2.8">
<h3><span class="header-section-number">5.2.8</span> 2016<a href="drivers.html#section-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>2016 was an extremely tight competition in both races and qualifying for the two Mercedes drivers. Nico Rosberg qualified on the front row in every race of the season, while maintaining an average starting position of 1.62. However, Hamilton still managed to achieve pole more often: 12 poles vs 8 for Rosberg.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="drivers.html#cb118-1" aria-hidden="true" tabindex="-1"></a>quali2016 <span class="ot">&lt;-</span> <span class="fu">qualifying_scraper</span>(<span class="dv">2016</span>)</span>
<span id="cb118-2"><a href="drivers.html#cb118-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3"><a href="drivers.html#cb118-3" aria-hidden="true" tabindex="-1"></a>quali2016 <span class="sc">%&gt;%</span></span>
<span id="cb118-4"><a href="drivers.html#cb118-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Car =</span> <span class="fu">str_replace</span>(Car, <span class="st">&quot;-&quot;</span>, <span class="st">&quot; &quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb118-5"><a href="drivers.html#cb118-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb118-6"><a href="drivers.html#cb118-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Race, Position, Car, Driver) <span class="sc">%&gt;%</span></span>
<span id="cb118-7"><a href="drivers.html#cb118-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Position =</span> <span class="fu">as.integer</span>(Position),</span>
<span id="cb118-8"><a href="drivers.html#cb118-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">Position =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Position), <span class="dv">21</span>, Position)) <span class="sc">%&gt;%</span> </span>
<span id="cb118-9"><a href="drivers.html#cb118-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Car, Race) <span class="sc">%&gt;%</span> </span>
<span id="cb118-10"><a href="drivers.html#cb118-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Driver) <span class="sc">%&gt;%</span> </span>
<span id="cb118-11"><a href="drivers.html#cb118-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">driver_num =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb118-12"><a href="drivers.html#cb118-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&#39;driver_num&#39;</span>, <span class="at">values_from =</span> <span class="fu">c</span>(<span class="st">&#39;Driver&#39;</span>, <span class="st">&#39;Position&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb118-13"><a href="drivers.html#cb118-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">best_qualifier =</span> <span class="fu">ifelse</span>(Position_1 <span class="sc">&lt;</span> Position_2, Driver_1, Driver_2)) <span class="sc">%&gt;%</span></span>
<span id="cb118-14"><a href="drivers.html#cb118-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb118-15"><a href="drivers.html#cb118-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Car) <span class="sc">%&gt;%</span></span>
<span id="cb118-16"><a href="drivers.html#cb118-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(best_qualifier) <span class="sc">%&gt;%</span></span>
<span id="cb118-17"><a href="drivers.html#cb118-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb118-18"><a href="drivers.html#cb118-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(best_qualifier)) <span class="sc">%&gt;%</span></span>
<span id="cb118-19"><a href="drivers.html#cb118-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fct_reorder</span>(best_qualifier, Car), <span class="at">x =</span> percentage, <span class="at">fill =</span> Car)) <span class="sc">+</span></span>
<span id="cb118-20"><a href="drivers.html#cb118-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span></span>
<span id="cb118-21"><a href="drivers.html#cb118-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb118-22"><a href="drivers.html#cb118-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>()) <span class="sc">+</span></span>
<span id="cb118-23"><a href="drivers.html#cb118-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">factor</span>(Car, </span>
<span id="cb118-24"><a href="drivers.html#cb118-24" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Ferrari&quot;</span>,</span>
<span id="cb118-25"><a href="drivers.html#cb118-25" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Mercedes&quot;</span>,</span>
<span id="cb118-26"><a href="drivers.html#cb118-26" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Haas Ferrari&quot;</span>,</span>
<span id="cb118-27"><a href="drivers.html#cb118-27" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Renault&quot;</span>,</span>
<span id="cb118-28"><a href="drivers.html#cb118-28" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Toro Rosso Ferrari&quot;</span>,</span>
<span id="cb118-29"><a href="drivers.html#cb118-29" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Sauber Ferrari&quot;</span>, </span>
<span id="cb118-30"><a href="drivers.html#cb118-30" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Force India Mercedes&quot;</span>,</span>
<span id="cb118-31"><a href="drivers.html#cb118-31" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;McLaren Honda&quot;</span>,</span>
<span id="cb118-32"><a href="drivers.html#cb118-32" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Williams Mercedes&quot;</span>,</span>
<span id="cb118-33"><a href="drivers.html#cb118-33" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Red Bull Racing TAG Heuer&quot;</span>,</span>
<span id="cb118-34"><a href="drivers.html#cb118-34" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;MRT Mercedes&quot;</span>)),</span>
<span id="cb118-35"><a href="drivers.html#cb118-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">strip.position=</span><span class="st">&quot;top&quot;</span>, <span class="at">scales =</span> <span class="st">&#39;free_y&#39;</span>) <span class="sc">+</span></span>
<span id="cb118-36"><a href="drivers.html#cb118-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&#39;Driver&#39;</span>,</span>
<span id="cb118-37"><a href="drivers.html#cb118-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;Season-long Qualifying Win Proportion&#39;</span>,</span>
<span id="cb118-38"><a href="drivers.html#cb118-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Intra-team Qualifying Battles&#39;</span>,</span>
<span id="cb118-39"><a href="drivers.html#cb118-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;2016&#39;</span>) <span class="sc">+</span></span>
<span id="cb118-40"><a href="drivers.html#cb118-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb118-41"><a href="drivers.html#cb118-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb118-42"><a href="drivers.html#cb118-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb118-43"><a href="drivers.html#cb118-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, </span>
<span id="cb118-44"><a href="drivers.html#cb118-44" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;cyan3&quot;</span>,  </span>
<span id="cb118-45"><a href="drivers.html#cb118-45" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;black&quot;</span>, </span>
<span id="cb118-46"><a href="drivers.html#cb118-46" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;yellow&quot;</span>,</span>
<span id="cb118-47"><a href="drivers.html#cb118-47" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;darkslateblue&quot;</span>, </span>
<span id="cb118-48"><a href="drivers.html#cb118-48" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;darkred&quot;</span>,  </span>
<span id="cb118-49"><a href="drivers.html#cb118-49" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;pink&quot;</span>, </span>
<span id="cb118-50"><a href="drivers.html#cb118-50" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;darkorange&quot;</span>, </span>
<span id="cb118-51"><a href="drivers.html#cb118-51" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;cornflowerblue&quot;</span>,</span>
<span id="cb118-52"><a href="drivers.html#cb118-52" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;navy&quot;</span>,</span>
<span id="cb118-53"><a href="drivers.html#cb118-53" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;blue&quot;</span>),</span>
<span id="cb118-54"><a href="drivers.html#cb118-54" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;Ferrari&quot;</span>,</span>
<span id="cb118-55"><a href="drivers.html#cb118-55" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Mercedes&quot;</span>,</span>
<span id="cb118-56"><a href="drivers.html#cb118-56" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Haas Ferrari&quot;</span>,</span>
<span id="cb118-57"><a href="drivers.html#cb118-57" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Renault&quot;</span>,</span>
<span id="cb118-58"><a href="drivers.html#cb118-58" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Toro Rosso Ferrari&quot;</span>,</span>
<span id="cb118-59"><a href="drivers.html#cb118-59" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Sauber Ferrari&quot;</span>, </span>
<span id="cb118-60"><a href="drivers.html#cb118-60" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Force India Mercedes&quot;</span>,</span>
<span id="cb118-61"><a href="drivers.html#cb118-61" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;McLaren Honda&quot;</span>,</span>
<span id="cb118-62"><a href="drivers.html#cb118-62" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Williams Mercedes&quot;</span>,</span>
<span id="cb118-63"><a href="drivers.html#cb118-63" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Red Bull Racing TAG Heuer&quot;</span>,</span>
<span id="cb118-64"><a href="drivers.html#cb118-64" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;MRT Mercedes&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-107-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>The only non-Mercedes pole of 2016 was Daniel Ricciardo in Monaco.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="drivers.html#cb119-1" aria-hidden="true" tabindex="-1"></a>qualifying_allyears <span class="sc">%&gt;%</span></span>
<span id="cb119-2"><a href="drivers.html#cb119-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Q_secs),</span>
<span id="cb119-3"><a href="drivers.html#cb119-3" aria-hidden="true" tabindex="-1"></a>         Year <span class="sc">==</span> <span class="dv">2016</span>) <span class="sc">%&gt;%</span></span>
<span id="cb119-4"><a href="drivers.html#cb119-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Race) <span class="sc">%&gt;%</span></span>
<span id="cb119-5"><a href="drivers.html#cb119-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">track_mean =</span> <span class="fu">mean</span>(Q_secs, <span class="at">na.rm =</span> T),</span>
<span id="cb119-6"><a href="drivers.html#cb119-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Time_std_track =</span> Q_secs <span class="sc">-</span> track_mean) <span class="sc">%&gt;%</span> </span>
<span id="cb119-7"><a href="drivers.html#cb119-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb119-8"><a href="drivers.html#cb119-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Driver) <span class="sc">%&gt;%</span> </span>
<span id="cb119-9"><a href="drivers.html#cb119-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">driver_n =</span> <span class="fu">n</span>(),</span>
<span id="cb119-10"><a href="drivers.html#cb119-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean =</span> <span class="fu">mean</span>(Time_std_track, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb119-11"><a href="drivers.html#cb119-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb119-12"><a href="drivers.html#cb119-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(driver_n <span class="sc">&gt;</span> <span class="dv">15</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb119-13"><a href="drivers.html#cb119-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Time_std_track, <span class="at">y =</span> <span class="fu">fct_reorder</span>(Driver, <span class="fu">desc</span>(mean)))) <span class="sc">+</span></span>
<span id="cb119-14"><a href="drivers.html#cb119-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">w =</span> <span class="dv">0</span>, <span class="at">h =</span> <span class="fl">0.1</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb119-15"><a href="drivers.html#cb119-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">seq</span>(<span class="dv">37</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>), <span class="at">col =</span> <span class="st">&#39;grey&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb119-16"><a href="drivers.html#cb119-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb119-17"><a href="drivers.html#cb119-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Standardized Qualifying Time (secs)&#39;</span>,</span>
<span id="cb119-18"><a href="drivers.html#cb119-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Driver&#39;</span>,</span>
<span id="cb119-19"><a href="drivers.html#cb119-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Standardized Qualifying Time&#39;</span>,</span>
<span id="cb119-20"><a href="drivers.html#cb119-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;2016&#39;</span>,</span>
<span id="cb119-21"><a href="drivers.html#cb119-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;*Times are subtracted from the average time for each Grand Prix&#39;</span>) <span class="sc">+</span></span>
<span id="cb119-22"><a href="drivers.html#cb119-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb119-23"><a href="drivers.html#cb119-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb119-24"><a href="drivers.html#cb119-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb119-25"><a href="drivers.html#cb119-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb119-26"><a href="drivers.html#cb119-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-108-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="section-8" class="section level3 hasAnchor" number="5.2.9">
<h3><span class="header-section-number">5.2.9</span> 2015<a href="drivers.html#section-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Lewis Hamilton took 11 out of the first 12 poles of the 2015 season, while Rosberg won the final 6 poles.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="drivers.html#cb120-1" aria-hidden="true" tabindex="-1"></a>quali2015 <span class="ot">&lt;-</span> <span class="fu">qualifying_scraper</span>(<span class="dv">2015</span>)</span>
<span id="cb120-2"><a href="drivers.html#cb120-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3"><a href="drivers.html#cb120-3" aria-hidden="true" tabindex="-1"></a>quali2015 <span class="sc">%&gt;%</span></span>
<span id="cb120-4"><a href="drivers.html#cb120-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Car =</span> <span class="fu">str_replace</span>(Car, <span class="st">&quot;-&quot;</span>, <span class="st">&quot; &quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb120-5"><a href="drivers.html#cb120-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb120-6"><a href="drivers.html#cb120-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Race, Position, Car, Driver) <span class="sc">%&gt;%</span></span>
<span id="cb120-7"><a href="drivers.html#cb120-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Position =</span> <span class="fu">as.integer</span>(Position),</span>
<span id="cb120-8"><a href="drivers.html#cb120-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">Position =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Position), <span class="dv">21</span>, Position)) <span class="sc">%&gt;%</span> </span>
<span id="cb120-9"><a href="drivers.html#cb120-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Car, Race) <span class="sc">%&gt;%</span> </span>
<span id="cb120-10"><a href="drivers.html#cb120-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Driver) <span class="sc">%&gt;%</span> </span>
<span id="cb120-11"><a href="drivers.html#cb120-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">driver_num =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb120-12"><a href="drivers.html#cb120-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&#39;driver_num&#39;</span>, <span class="at">values_from =</span> <span class="fu">c</span>(<span class="st">&#39;Driver&#39;</span>, <span class="st">&#39;Position&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb120-13"><a href="drivers.html#cb120-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">best_qualifier =</span> <span class="fu">ifelse</span>(Position_1 <span class="sc">&lt;</span> Position_2, Driver_1, Driver_2)) <span class="sc">%&gt;%</span></span>
<span id="cb120-14"><a href="drivers.html#cb120-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb120-15"><a href="drivers.html#cb120-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Car) <span class="sc">%&gt;%</span></span>
<span id="cb120-16"><a href="drivers.html#cb120-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(best_qualifier) <span class="sc">%&gt;%</span></span>
<span id="cb120-17"><a href="drivers.html#cb120-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb120-18"><a href="drivers.html#cb120-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(best_qualifier)) <span class="sc">%&gt;%</span></span>
<span id="cb120-19"><a href="drivers.html#cb120-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fct_reorder</span>(best_qualifier, Car), <span class="at">x =</span> percentage, <span class="at">fill =</span> Car)) <span class="sc">+</span></span>
<span id="cb120-20"><a href="drivers.html#cb120-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span></span>
<span id="cb120-21"><a href="drivers.html#cb120-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb120-22"><a href="drivers.html#cb120-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>()) <span class="sc">+</span></span>
<span id="cb120-23"><a href="drivers.html#cb120-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">factor</span>(Car, </span>
<span id="cb120-24"><a href="drivers.html#cb120-24" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels =</span><span class="fu">c</span>(<span class="st">&quot;Ferrari&quot;</span>,</span>
<span id="cb120-25"><a href="drivers.html#cb120-25" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Mercedes&quot;</span>,</span>
<span id="cb120-26"><a href="drivers.html#cb120-26" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Lotus Mercedes&quot;</span>,</span>
<span id="cb120-27"><a href="drivers.html#cb120-27" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Marussia Ferrari&quot;</span>,</span>
<span id="cb120-28"><a href="drivers.html#cb120-28" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;STR Renault&quot;</span>,</span>
<span id="cb120-29"><a href="drivers.html#cb120-29" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Sauber Ferrari&quot;</span>, </span>
<span id="cb120-30"><a href="drivers.html#cb120-30" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Force India Mercedes&quot;</span>,</span>
<span id="cb120-31"><a href="drivers.html#cb120-31" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;McLaren Honda&quot;</span>,</span>
<span id="cb120-32"><a href="drivers.html#cb120-32" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Williams Mercedes&quot;</span>,</span>
<span id="cb120-33"><a href="drivers.html#cb120-33" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Red Bull Racing Renault&quot;</span>)),</span>
<span id="cb120-34"><a href="drivers.html#cb120-34" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">strip.position=</span><span class="st">&quot;top&quot;</span>, <span class="at">scales =</span> <span class="st">&#39;free_y&#39;</span>) <span class="sc">+</span></span>
<span id="cb120-35"><a href="drivers.html#cb120-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&#39;Driver&#39;</span>,</span>
<span id="cb120-36"><a href="drivers.html#cb120-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;Season-long Qualifying Win Proportion&#39;</span>,</span>
<span id="cb120-37"><a href="drivers.html#cb120-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Intra-team Qualifying Battles&#39;</span>,</span>
<span id="cb120-38"><a href="drivers.html#cb120-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;2015&#39;</span>) <span class="sc">+</span></span>
<span id="cb120-39"><a href="drivers.html#cb120-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb120-40"><a href="drivers.html#cb120-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb120-41"><a href="drivers.html#cb120-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb120-42"><a href="drivers.html#cb120-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, </span>
<span id="cb120-43"><a href="drivers.html#cb120-43" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;cyan3&quot;</span>,  </span>
<span id="cb120-44"><a href="drivers.html#cb120-44" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;black&quot;</span>, </span>
<span id="cb120-45"><a href="drivers.html#cb120-45" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;grey&quot;</span>,</span>
<span id="cb120-46"><a href="drivers.html#cb120-46" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;darkslateblue&quot;</span>, </span>
<span id="cb120-47"><a href="drivers.html#cb120-47" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;darkred&quot;</span>,  </span>
<span id="cb120-48"><a href="drivers.html#cb120-48" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;pink&quot;</span>, </span>
<span id="cb120-49"><a href="drivers.html#cb120-49" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;darkorange&quot;</span>, </span>
<span id="cb120-50"><a href="drivers.html#cb120-50" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;cornflowerblue&quot;</span>,</span>
<span id="cb120-51"><a href="drivers.html#cb120-51" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb120-52"><a href="drivers.html#cb120-52" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;navy&quot;</span>),</span>
<span id="cb120-53"><a href="drivers.html#cb120-53" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;Ferrari&quot;</span>,</span>
<span id="cb120-54"><a href="drivers.html#cb120-54" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Mercedes&quot;</span>,</span>
<span id="cb120-55"><a href="drivers.html#cb120-55" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Lotus Mercedes&quot;</span>,</span>
<span id="cb120-56"><a href="drivers.html#cb120-56" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Marussia Ferrari&quot;</span>,</span>
<span id="cb120-57"><a href="drivers.html#cb120-57" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;STR Renault&quot;</span>,</span>
<span id="cb120-58"><a href="drivers.html#cb120-58" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Sauber Ferrari&quot;</span>, </span>
<span id="cb120-59"><a href="drivers.html#cb120-59" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Force India Mercedes&quot;</span>,</span>
<span id="cb120-60"><a href="drivers.html#cb120-60" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;McLaren Honda&quot;</span>,</span>
<span id="cb120-61"><a href="drivers.html#cb120-61" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Williams Mercedes&quot;</span>,</span>
<span id="cb120-62"><a href="drivers.html#cb120-62" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Red Bull Racing Renault&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-109-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Mercedes was absolutely dominant in qualifying and missed out on only 1 pole to Sebastian Vettel in Singapore.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="drivers.html#cb121-1" aria-hidden="true" tabindex="-1"></a>qualifying_allyears <span class="sc">%&gt;%</span></span>
<span id="cb121-2"><a href="drivers.html#cb121-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Q_secs),</span>
<span id="cb121-3"><a href="drivers.html#cb121-3" aria-hidden="true" tabindex="-1"></a>         Year <span class="sc">==</span> <span class="dv">2015</span>) <span class="sc">%&gt;%</span></span>
<span id="cb121-4"><a href="drivers.html#cb121-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Race) <span class="sc">%&gt;%</span></span>
<span id="cb121-5"><a href="drivers.html#cb121-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">track_mean =</span> <span class="fu">mean</span>(Q_secs, <span class="at">na.rm =</span> T),</span>
<span id="cb121-6"><a href="drivers.html#cb121-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Time_std_track =</span> Q_secs <span class="sc">-</span> track_mean) <span class="sc">%&gt;%</span> </span>
<span id="cb121-7"><a href="drivers.html#cb121-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb121-8"><a href="drivers.html#cb121-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Driver) <span class="sc">%&gt;%</span> </span>
<span id="cb121-9"><a href="drivers.html#cb121-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">driver_n =</span> <span class="fu">n</span>(),</span>
<span id="cb121-10"><a href="drivers.html#cb121-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean =</span> <span class="fu">mean</span>(Time_std_track, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb121-11"><a href="drivers.html#cb121-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb121-12"><a href="drivers.html#cb121-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(driver_n <span class="sc">&gt;</span> <span class="dv">15</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb121-13"><a href="drivers.html#cb121-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Time_std_track, <span class="at">y =</span> <span class="fu">fct_reorder</span>(Driver, <span class="fu">desc</span>(mean)))) <span class="sc">+</span></span>
<span id="cb121-14"><a href="drivers.html#cb121-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">w =</span> <span class="dv">0</span>, <span class="at">h =</span> <span class="fl">0.1</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb121-15"><a href="drivers.html#cb121-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">seq</span>(<span class="dv">37</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>), <span class="at">col =</span> <span class="st">&#39;grey&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb121-16"><a href="drivers.html#cb121-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb121-17"><a href="drivers.html#cb121-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Standardized Qualifying Time (secs)&#39;</span>,</span>
<span id="cb121-18"><a href="drivers.html#cb121-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Driver&#39;</span>,</span>
<span id="cb121-19"><a href="drivers.html#cb121-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Standardized Qualifying Time&#39;</span>,</span>
<span id="cb121-20"><a href="drivers.html#cb121-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;2015&#39;</span>,</span>
<span id="cb121-21"><a href="drivers.html#cb121-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;*Times are subtracted from the average time for each Grand Prix&#39;</span>) <span class="sc">+</span></span>
<span id="cb121-22"><a href="drivers.html#cb121-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb121-23"><a href="drivers.html#cb121-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb121-24"><a href="drivers.html#cb121-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb121-25"><a href="drivers.html#cb121-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb121-26"><a href="drivers.html#cb121-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-110-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="section-9" class="section level3 hasAnchor" number="5.2.10">
<h3><span class="header-section-number">5.2.10</span> 2014<a href="drivers.html#section-9" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The very consistent Nico Rosberg averaged a 1.68 starting position, won 11 poles, and out-qualified Lewis Hamilton 12:7 in the 2014 season.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="drivers.html#cb122-1" aria-hidden="true" tabindex="-1"></a>quali2014 <span class="ot">&lt;-</span> <span class="fu">qualifying_scraper</span>(<span class="dv">2014</span>)</span>
<span id="cb122-2"><a href="drivers.html#cb122-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-3"><a href="drivers.html#cb122-3" aria-hidden="true" tabindex="-1"></a>quali2014 <span class="sc">%&gt;%</span></span>
<span id="cb122-4"><a href="drivers.html#cb122-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Car =</span> <span class="fu">str_replace</span>(Car, <span class="st">&quot;-&quot;</span>, <span class="st">&quot; &quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb122-5"><a href="drivers.html#cb122-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb122-6"><a href="drivers.html#cb122-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Race, Position, Car, Driver) <span class="sc">%&gt;%</span></span>
<span id="cb122-7"><a href="drivers.html#cb122-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Position =</span> <span class="fu">as.integer</span>(Position),</span>
<span id="cb122-8"><a href="drivers.html#cb122-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">Position =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Position), <span class="dv">21</span>, Position)) <span class="sc">%&gt;%</span> </span>
<span id="cb122-9"><a href="drivers.html#cb122-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Car, Race) <span class="sc">%&gt;%</span> </span>
<span id="cb122-10"><a href="drivers.html#cb122-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Driver) <span class="sc">%&gt;%</span> </span>
<span id="cb122-11"><a href="drivers.html#cb122-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">driver_num =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb122-12"><a href="drivers.html#cb122-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&#39;driver_num&#39;</span>, <span class="at">values_from =</span> <span class="fu">c</span>(<span class="st">&#39;Driver&#39;</span>, <span class="st">&#39;Position&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb122-13"><a href="drivers.html#cb122-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">best_qualifier =</span> <span class="fu">ifelse</span>(Position_1 <span class="sc">&lt;</span> Position_2, Driver_1, Driver_2)) <span class="sc">%&gt;%</span></span>
<span id="cb122-14"><a href="drivers.html#cb122-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb122-15"><a href="drivers.html#cb122-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Car) <span class="sc">%&gt;%</span></span>
<span id="cb122-16"><a href="drivers.html#cb122-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(best_qualifier) <span class="sc">%&gt;%</span></span>
<span id="cb122-17"><a href="drivers.html#cb122-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb122-18"><a href="drivers.html#cb122-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(best_qualifier)) <span class="sc">%&gt;%</span></span>
<span id="cb122-19"><a href="drivers.html#cb122-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fct_reorder</span>(best_qualifier, Car), <span class="at">x =</span> percentage, <span class="at">fill =</span> Car)) <span class="sc">+</span></span>
<span id="cb122-20"><a href="drivers.html#cb122-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span></span>
<span id="cb122-21"><a href="drivers.html#cb122-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb122-22"><a href="drivers.html#cb122-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>()) <span class="sc">+</span></span>
<span id="cb122-23"><a href="drivers.html#cb122-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> <span class="fu">factor</span>(Car, </span>
<span id="cb122-24"><a href="drivers.html#cb122-24" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels =</span><span class="fu">c</span>(<span class="st">&quot;Ferrari&quot;</span>,</span>
<span id="cb122-25"><a href="drivers.html#cb122-25" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Mercedes&quot;</span>,</span>
<span id="cb122-26"><a href="drivers.html#cb122-26" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Lotus Renault&quot;</span>,</span>
<span id="cb122-27"><a href="drivers.html#cb122-27" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Marussia Ferrari&quot;</span>,</span>
<span id="cb122-28"><a href="drivers.html#cb122-28" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;STR Renault&quot;</span>,</span>
<span id="cb122-29"><a href="drivers.html#cb122-29" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Sauber Ferrari&quot;</span>, </span>
<span id="cb122-30"><a href="drivers.html#cb122-30" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Force India Mercedes&quot;</span>,</span>
<span id="cb122-31"><a href="drivers.html#cb122-31" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;McLaren Mercedes&quot;</span>,</span>
<span id="cb122-32"><a href="drivers.html#cb122-32" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Williams Mercedes&quot;</span>,</span>
<span id="cb122-33"><a href="drivers.html#cb122-33" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Red Bull Racing Renault&quot;</span>,</span>
<span id="cb122-34"><a href="drivers.html#cb122-34" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;Caterham Renault&quot;</span>)),</span>
<span id="cb122-35"><a href="drivers.html#cb122-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">strip.position=</span><span class="st">&quot;top&quot;</span>, <span class="at">scales =</span> <span class="st">&#39;free_y&#39;</span>) <span class="sc">+</span></span>
<span id="cb122-36"><a href="drivers.html#cb122-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&#39;Driver&#39;</span>,</span>
<span id="cb122-37"><a href="drivers.html#cb122-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;Season-long Qualifying Win Proportion&#39;</span>,</span>
<span id="cb122-38"><a href="drivers.html#cb122-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Intra-team Qualifying Battles&#39;</span>,</span>
<span id="cb122-39"><a href="drivers.html#cb122-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;2015&#39;</span>) <span class="sc">+</span></span>
<span id="cb122-40"><a href="drivers.html#cb122-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb122-41"><a href="drivers.html#cb122-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb122-42"><a href="drivers.html#cb122-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb122-43"><a href="drivers.html#cb122-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, </span>
<span id="cb122-44"><a href="drivers.html#cb122-44" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;cyan3&quot;</span>,  </span>
<span id="cb122-45"><a href="drivers.html#cb122-45" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;black&quot;</span>, </span>
<span id="cb122-46"><a href="drivers.html#cb122-46" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;grey&quot;</span>,</span>
<span id="cb122-47"><a href="drivers.html#cb122-47" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;darkslateblue&quot;</span>, </span>
<span id="cb122-48"><a href="drivers.html#cb122-48" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;darkred&quot;</span>,  </span>
<span id="cb122-49"><a href="drivers.html#cb122-49" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;pink&quot;</span>, </span>
<span id="cb122-50"><a href="drivers.html#cb122-50" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;darkorange&quot;</span>, </span>
<span id="cb122-51"><a href="drivers.html#cb122-51" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;cornflowerblue&quot;</span>,</span>
<span id="cb122-52"><a href="drivers.html#cb122-52" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb122-53"><a href="drivers.html#cb122-53" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;navy&quot;</span>,</span>
<span id="cb122-54"><a href="drivers.html#cb122-54" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;seagreen&quot;</span>),</span>
<span id="cb122-55"><a href="drivers.html#cb122-55" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;Ferrari&quot;</span>,</span>
<span id="cb122-56"><a href="drivers.html#cb122-56" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Mercedes&quot;</span>,</span>
<span id="cb122-57"><a href="drivers.html#cb122-57" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Lotus Mercedes&quot;</span>,</span>
<span id="cb122-58"><a href="drivers.html#cb122-58" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Marussia Ferrari&quot;</span>,</span>
<span id="cb122-59"><a href="drivers.html#cb122-59" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;STR Renault&quot;</span>,</span>
<span id="cb122-60"><a href="drivers.html#cb122-60" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Sauber Ferrari&quot;</span>, </span>
<span id="cb122-61"><a href="drivers.html#cb122-61" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Force India Mercedes&quot;</span>,</span>
<span id="cb122-62"><a href="drivers.html#cb122-62" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;McLaren Honda&quot;</span>,</span>
<span id="cb122-63"><a href="drivers.html#cb122-63" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Williams Mercedes&quot;</span>,</span>
<span id="cb122-64"><a href="drivers.html#cb122-64" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Red Bull Racing Renault&quot;</span>,</span>
<span id="cb122-65"><a href="drivers.html#cb122-65" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;Caterham Renault&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-111-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Mercedes power units claimed every pole of this inaugural season for the turbo-hybrid era.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="drivers.html#cb123-1" aria-hidden="true" tabindex="-1"></a>qualifying_allyears <span class="sc">%&gt;%</span></span>
<span id="cb123-2"><a href="drivers.html#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Q_secs),</span>
<span id="cb123-3"><a href="drivers.html#cb123-3" aria-hidden="true" tabindex="-1"></a>         Year <span class="sc">==</span> <span class="dv">2014</span>) <span class="sc">%&gt;%</span></span>
<span id="cb123-4"><a href="drivers.html#cb123-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Race) <span class="sc">%&gt;%</span></span>
<span id="cb123-5"><a href="drivers.html#cb123-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">track_mean =</span> <span class="fu">mean</span>(Q_secs, <span class="at">na.rm =</span> T),</span>
<span id="cb123-6"><a href="drivers.html#cb123-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Time_std_track =</span> Q_secs <span class="sc">-</span> track_mean) <span class="sc">%&gt;%</span> </span>
<span id="cb123-7"><a href="drivers.html#cb123-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb123-8"><a href="drivers.html#cb123-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Driver) <span class="sc">%&gt;%</span> </span>
<span id="cb123-9"><a href="drivers.html#cb123-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">driver_n =</span> <span class="fu">n</span>(),</span>
<span id="cb123-10"><a href="drivers.html#cb123-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean =</span> <span class="fu">mean</span>(Time_std_track, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb123-11"><a href="drivers.html#cb123-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb123-12"><a href="drivers.html#cb123-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(driver_n <span class="sc">&gt;</span> <span class="dv">15</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb123-13"><a href="drivers.html#cb123-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Time_std_track, <span class="at">y =</span> <span class="fu">fct_reorder</span>(Driver, <span class="fu">desc</span>(mean)))) <span class="sc">+</span></span>
<span id="cb123-14"><a href="drivers.html#cb123-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">w =</span> <span class="dv">0</span>, <span class="at">h =</span> <span class="fl">0.1</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb123-15"><a href="drivers.html#cb123-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">seq</span>(<span class="dv">37</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>), <span class="at">col =</span> <span class="st">&#39;grey&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb123-16"><a href="drivers.html#cb123-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb123-17"><a href="drivers.html#cb123-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Standardized Qualifying Time (secs)&#39;</span>,</span>
<span id="cb123-18"><a href="drivers.html#cb123-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Driver&#39;</span>,</span>
<span id="cb123-19"><a href="drivers.html#cb123-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;Standardized Qualifying Time&#39;</span>,</span>
<span id="cb123-20"><a href="drivers.html#cb123-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;2014&#39;</span>,</span>
<span id="cb123-21"><a href="drivers.html#cb123-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&#39;*Times are subtracted from the average time for each Grand Prix&#39;</span>) <span class="sc">+</span></span>
<span id="cb123-22"><a href="drivers.html#cb123-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>) <span class="sc">+</span></span>
<span id="cb123-23"><a href="drivers.html#cb123-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb123-24"><a href="drivers.html#cb123-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb123-25"><a href="drivers.html#cb123-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb123-26"><a href="drivers.html#cb123-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-112-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="next-chapter-3" class="section level3 hasAnchor" number="5.2.11">
<h3><span class="header-section-number">5.2.11</span> Next Chapter<a href="drivers.html#next-chapter-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the next chapter, we will explore the relationship between qualifying position and race placing.</p>
<div style="page-break-after: always;"></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modeling-practice-and-qualifying-times.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modeling-race-results.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/04-drivers.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
